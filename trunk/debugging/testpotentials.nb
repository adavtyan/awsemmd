(* Content-type: application/mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 7.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       145,          7]
NotebookDataLength[    220722,       5863]
NotebookOptionsPosition[    218995,       5810]
NotebookOutlinePosition[    219331,       5825]
CellTagsIndexPosition[    219288,       5822]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[TextData[{
 StyleBox["This is a ",
  FontSize->18],
 StyleBox["Mathematica",
  FontSize->18,
  FontSlant->"Italic"],
 StyleBox[" notebook which can be used to help verify and debug potentials \
implemented in LAMMPS. It works by taking output from a LAMMPS simulation in \
the form of coordinates and forces (from forces.dat) at a particular \
timestep. The forces that are due to a particular potential term are obtained \
by subtracting the total forces before that term was calculated from the \
total forces after that term was calculated. The total potential energy due \
to that term is also available in forces.dat. To test a potential term, you \
must implement the form of the potential in the notebook below exactly as it \
is implemented in LAMMPS, including the same values of any parameters that \
were used in the LAMMPS simulation. The advantage of using ",
  FontSize->18],
 StyleBox["Mathematica",
  FontSize->18,
  FontSlant->"Italic"],
 StyleBox[" is that, unlike in LAMMPS where you have to manually calculate \
the derivative of the potential function and implement that separately to get \
the forces on each atom, ",
  FontSize->18],
 StyleBox["Mathematica",
  FontSize->18,
  FontSlant->"Italic"],
 StyleBox[" will calculate the derivative automatically and analytically and \
output what it thinks the forces should be. If there is disagreement between \
the energy of a particular potential term, then it is most likely an error in \
either the LAMMPS or ",
  FontSize->18],
 StyleBox["Mathematica",
  FontSize->18,
  FontSlant->"Italic"],
 StyleBox[" implementations and both must be checked. If there is agreement \
in the energies but disagreement in the forces then it is almost certainly a \
problem with the form of the forces being calculated in LAMMPS. If there is \
agreement to within machine precision in both the forces and the energies \
then, congratulations, you (most likely) have a working potential.\n\nCare \
must be taken that all the parameters used in the potentials are the same. \
Differences in the parameters can easily cause false negatives in the \
agreement between LAMMPS and ",
  FontSize->18],
 StyleBox["Mathematica",
  FontSize->18,
  FontSlant->"Italic"],
 StyleBox[". Because the derivatives are calculated analytically in ",
  FontSize->18],
 StyleBox["Mathematica",
  FontSize->18,
  FontSlant->"Italic"],
 StyleBox[", it can be quite slow, so a small protein should probably be \
used. In ",
  FontSize->18],
 StyleBox["Mathematica",
  FontSize->18,
  FontSlant->"Italic"],
 StyleBox[", each block that contains information that is going to be used \
later must be executed. Simply \[OpenCurlyDoubleQuote]being there\
\[CloseCurlyDoubleQuote] is not enough. For a typical tests, most of the \
blocks can be executed sequentially from top to bottom. Exceptions are noted \
in the comments at the top of the blocks.\n\nMost of the initial ",
  FontSize->18],
 StyleBox["Mathematica",
  FontSize->18,
  FontSlant->"Italic"],
 StyleBox[" code was written by Aram Davtyan (davtyan.aram@gmail.com) and \
most of the initial commenting was done by Nick Schafer (nschafer@ucsd.edu).",
  
  FontSize->18]
}], "Text",
 CellChangeTimes->{{3.512331963053382*^9, 3.512332007741375*^9}, {
  3.5123320617638483`*^9, 3.512332082951221*^9}, {3.512332422522584*^9, 
  3.512332771412112*^9}, {3.512332821642769*^9, 3.5123328996107903`*^9}, {
  3.5123329719186697`*^9, 3.512333128943853*^9}, {3.512333239722148*^9, 
  3.512333308884424*^9}, {3.512333367244809*^9, 3.512333367433116*^9}, {
  3.5123334203677073`*^9, 3.512333511994548*^9}}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"(*", " ", 
    RowBox[{"COPY", " ", "THE", " ", "COORDINATES", " ", "FROM", " ", 
     RowBox[{"forces", ".", "dat"}], " ", "GENERATED", " ", "BY", " ", 
     "LAMMPS", " ", "HERE"}], " ", "*)"}], "Text"], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"rca", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"43.19765571", ",", "5.45933250", ",", "36.83578705"}], "}"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"41.04009412", ",", "8.56023916", ",", "36.18154356"}], "}"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"37.67779732", ",", "7.97093242", ",", "34.39870879"}], "}"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"36.72749064", ",", "5.57040376", ",", "31.58131542"}], "}"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"33.37009720", ",", "7.05040478", ",", "30.81944104"}], "}"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"32.32056278", ",", "10.74602687", ",", "30.26193073"}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"29.85947976", ",", "13.08590440", ",", "32.06778878"}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"26.59494333", ",", "11.40902546", ",", "33.22754962"}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"23.10201543", ",", "12.69455137", ",", "32.20673014"}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"20.88878237", ",", "15.14284099", ",", "34.12505506"}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"17.88920126", ",", "12.76127015", ",", "33.89314788"}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"17.03930263", ",", "8.96676309", ",", "33.92948940"}], "}"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"15.19300402", ",", "6.37848240", ",", "31.79218061"}], "}"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"14.72218256", ",", "2.84548199", ",", "30.35942646"}], "}"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"14.49673497", ",", "0.43769040", ",", "27.46144637"}], "}"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"12.59245815", ",", 
         RowBox[{"-", "2.98335733"}], ",", "27.24123799"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"15.88040058", ",", 
         RowBox[{"-", "5.07537366"}], ",", "27.68600191"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"15.29268922", ",", 
         RowBox[{"-", "4.47827609"}], ",", "31.54326218"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"12.41623703", ",", 
         RowBox[{"-", "3.28604232"}], ",", "34.07362992"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"14.80237470", ",", 
         RowBox[{"-", "0.90872767"}], ",", "35.93792220"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"15.58414543", ",", "2.81058604", ",", "35.25600471"}], "}"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"19.13187247", ",", "4.22965386", ",", "34.62202949"}], "}"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"20.93391954", ",", "7.59001801", ",", "34.07721418"}], "}"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"20.43369315", ",", "8.71071797", ",", "30.39749310"}], "}"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"19.50829365", ",", "5.02043603", ",", "29.70195908"}], "}"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"23.36890827", ",", "4.36190078", ",", "29.72206786"}], 
        "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", "\n", 
   RowBox[{
    RowBox[{"rcb", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"44.66944545", ",", "5.30881506", ",", "36.25302486"}], "}"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"41.94873357", ",", "9.33110134", ",", "33.54687054"}], "}"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"36.63349779", ",", "9.07316088", ",", "34.45317092"}], "}"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"36.92057449", ",", "4.28895473", ",", "28.89150956"}], "}"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"32.21182865", ",", "6.30813585", ",", "31.51569889"}], "}"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"32.48723581", ",", "11.14614184", ",", "27.84090128"}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"31.00037446", ",", "13.25783241", ",", "30.75782688"}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"26.31647446", ",", "10.92031928", ",", "34.70625589"}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"24.23238758", ",", "12.30824557", ",", "29.07548365"}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"20.81779358", ",", "16.48318878", ",", "33.36632285"}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"19.12858228", ",", "12.13421113", ",", "32.05526773"}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"16.97853925", ",", "8.46195398", ",", "35.37637767"}], "}"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"16.12057663", ",", "6.23255608", ",", "29.09086933"}], "}"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"14.65209299", ",", "1.56046567", ",", "29.05359160"}], "}"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"15.88288702", ",", "0.39970829", ",", "26.71863120"}], "}"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"11.74857750", ",", 
         RowBox[{"-", "3.30962554"}], ",", "25.92502835"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"17.13496680", ",", 
         RowBox[{"-", "4.62574506"}], ",", "27.02135639"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"16.59590258", ",", 
         RowBox[{"-", "4.08329388"}], ",", "32.18465111"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"11.52323653", ",", 
         RowBox[{"-", "4.37134930"}], ",", "34.74493765"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"16.11132792", ",", 
         RowBox[{"-", "1.41157539"}], ",", "36.55820678"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"14.47538479", ",", "3.70464045", ",", "35.75743225"}], "}"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"19.85680611", ",", "3.20790801", ",", "33.67862894"}], "}"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"22.24245757", ",", "7.93319681", ",", "34.99295326"}], "}"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"21.71556291", ",", "9.54138940", ",", "29.92407382"}], "}"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"18.44315085", ",", "4.96717315", ",", "28.63198840"}], "}"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"24.22736950", ",", "5.66600793", ",", "29.81908730"}], 
        "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", "\n", 
   RowBox[{
    RowBox[{"ro", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"42.20360133", ",", "6.45097672", ",", "34.85573927"}], "}"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"39.11895429", ",", "7.21243148", ",", "36.62119072"}], "}"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"38.65217524", ",", "7.78052256", ",", "32.25074634"}], "}"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"35.32522035", ",", "5.51106719", ",", "29.65495297"}], "}"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"33.59252674", ",", "9.21607475", ",", "31.99101385"}], "}"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"30.65538112", ",", "10.42583660", ",", "31.88438113"}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"28.24838015", ",", "11.83608979", ",", "30.81572464"}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"25.62075755", ",", "13.54536701", ",", "32.64353154"}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"22.73184482", ",", "12.81396827", ",", "34.55065486"}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"18.84700345", ",", "14.95599030", ",", "35.41185905"}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"19.24434004", ",", "10.78305238", ",", "33.38863601"}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"14.85380398", ",", "8.89927884", ",", "32.81179390"}], "}"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"16.29427978", ",", "4.24602920", ",", "32.20343848"}], "}"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"13.79169261", ",", "3.16632115", ",", "28.11854266"}], "}"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"14.59082896", ",", 
         RowBox[{"-", "1.59597315"}], ",", "28.72926500"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"13.16173112", ",", 
         RowBox[{"-", "4.99749983"}], ",", "28.49028132"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"16.81929885", ",", 
         RowBox[{"-", "5.99820557"}], ",", "29.67656629"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"13.80333196", ",", 
         RowBox[{"-", "2.57641707"}], ",", "31.52148120"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"11.97155566", ",", 
         RowBox[{"-", "1.33524069"}], ",", "35.39645568"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"14.94752789", ",", "0.40916300", ",", "33.85456667"}], "}"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"17.55610952", ",", "2.96480620", ",", "36.68851960"}], "}"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"18.60864321", ",", "6.09429096", ",", "33.27305925"}], "}"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"21.78131690", ",", "6.70075419", ",", "32.07017382"}], "}"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"20.77713102", ",", "7.36711119", ",", "28.45066771"}], "}"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"20.95331711", ",", "3.50678234", ",", "28.43218079"}], "}"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"23.63239589", ",", "2.14855137", ",", "30.26310253"}], 
        "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", "\n", 
   RowBox[{
    RowBox[{"rn", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0.00000000", ",", "0.00000000", ",", "0.00000000"}], "}"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"41.86578402", ",", "7.45482406", ",", "36.74414276"}], "}"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"39.03373148", ",", "8.39664875", ",", "34.84643635"}], "}"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"36.82849743", ",", "6.31877701", ",", "32.81760227"}], "}"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"34.62806532", ",", "6.62188108", ",", "31.40402114"}], "}"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"32.59090260", ",", "9.24561250", ",", "30.20959875"}], "}"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"30.90014521", ",", "12.45051616", ",", "31.22967316"}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"27.86417518", ",", "12.13952402", ",", "33.11598458"}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"24.32061357", ",", "11.91539065", ",", "32.61854089"}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"21.61496432", ",", "14.39348743", ",", "33.11934256"}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"19.15984773", ",", "13.50335092", ",", "33.72267877"}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"17.03966671", ",", "10.46168019", ",", "34.01253517"}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"16.14785745", ",", "7.15975384", ",", "32.63485268"}], "}"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"14.65717924", ",", "4.29141940", ",", "30.70846048"}], "}"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"14.73676403", ",", "1.09312842", ",", "28.73895084"}], "}"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"13.14052688", ",", 
         RowBox[{"-", "1.58904474"}], ",", "27.07082561"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"14.79799690", ",", 
         RowBox[{"-", "4.07941431"}], ",", "27.32158497"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"15.29260442", ",", 
         RowBox[{"-", "4.48396733"}], ",", "30.02741090"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"13.54756378", ",", 
         RowBox[{"-", "3.99388153"}], ",", "33.32616196"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"14.17640254", ",", 
         RowBox[{"-", "1.97763922"}], ",", "35.13818180"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"15.32496102", ",", "1.46082221", ",", "35.84603833"}], "}"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"17.71141221", ",", "3.77950577", ",", "34.54387236"}], "}"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"20.49603220", ",", "6.24516736", ",", "34.48993280"}], "}"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"20.42464448", ",", "8.54327315", ",", "31.86367977"}], "}"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"19.71925786", ",", "6.36636062", ",", "30.27064221"}], "}"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"21.95353137", ",", "4.83902534", ",", "29.95227431"}], 
        "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", "\n", 
   RowBox[{
    RowBox[{"rcp", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"42.37153728", ",", "6.50636336", ",", "36.04644449"}], "}"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"39.63326849", ",", "7.98910581", ",", "35.90370413"}], "}"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"37.76725056", ",", "7.34568662", ",", "33.04712540"}], "}"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"35.48837442", ",", "5.89915696", ",", "30.78391259"}], "}"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"33.19485649", ",", "8.61405603", ",", "31.06450099"}], "}"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"31.20768496", ",", "11.19311702", ",", "31.20711395"}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"28.57515073", ",", "12.29064736", ",", "31.93841999"}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"25.46139164", ",", "12.39688969", ",", "32.80018724"}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"22.46308090", ",", "13.30823226", ",", "33.40993633"}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"19.52846978", ",", "14.52319277", ",", "34.48362095"}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"18.12447463", ",", "11.23455309", ",", "33.73973983"}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"15.90387739", ",", "8.33685468", ",", "33.06844158"}], "}"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"15.43587049", ",", "4.86370983", ",", "31.58749716"}], "}"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"14.37051510", ",", "2.38264034", ",", "28.95907744"}], "}"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"14.07943409", ",", 
         RowBox[{"-", "1.01906182"}], ",", "27.81666718"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"13.54786124", ",", 
         RowBox[{"-", "4.12152091"}], ",", "27.74670042"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"16.04367475", ",", 
         RowBox[{"-", "5.23128477"}], ",", "29.23142924"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"14.13863927", ",", 
         RowBox[{"-", "3.58760441"}], ",", "32.13090690"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"12.83423666", ",", 
         RowBox[{"-", "2.10116605"}], ",", "34.93636567"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"15.03268499", ",", "0.38835396", ",", "35.10891447"}], "}"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"17.05086176", ",", "3.19357165", ",", "35.56685781"}], "}"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"19.38739694", ",", "5.61788794", ",", "34.06097845"}], "}"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"21.08838089", ",", "7.56792881", ",", "32.56821977"}], "}"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"20.32646782", ",", "7.41220394", ",", "29.60911166"}], "}"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"20.87939062", ",", "4.37979741", ",", "29.29908581"}], "}"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"0.00000000", ",", "0.00000000", ",", "0.00000000"}], "}"}]}],
       "}"}]}], ";"}], "\[IndentingNewLine]", "\n", 
   RowBox[{
    RowBox[{"rh", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0.00000000", ",", "0.00000000", ",", "0.00000000"}], "}"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"42.00058912", ",", "7.50057529", ",", "37.70490268"}], "}"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"39.44767971", ",", "9.02327907", ",", "34.26677110"}], "}"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"36.11398006", ",", "5.96702116", ",", "33.45938095"}], "}"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"34.75860468", ",", "6.93559772", ",", "32.31491163"}], "}"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"32.26959967", ",", "8.76099355", ",", "29.46164989"}], "}"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"31.34505899", ",", "13.07055716", ",", "30.68368338"}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"28.12679584", ",", "12.50581543", ",", "34.02247029"}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"24.19081108", ",", "10.98892540", ",", "32.74462710"}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"21.39730354", ",", "14.79322200", ",", "32.19935355"}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"19.70882216", ",", "13.15324664", ",", "32.97344782"}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"16.13556992", ",", "10.82478719", ",", "34.29591256"}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"16.99471398", ",", "6.70496188", ",", "32.84126114"}], "}"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"13.96422404", ",", "4.78873368", ",", "30.21086788"}], "}"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"15.20383748", ",", "0.45982815", ",", "29.41633895"}], "}"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"12.72715078", ",", 
         RowBox[{"-", "1.12459618"}], ",", "26.33422141"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"15.11074438", ",", 
         RowBox[{"-", "3.37314732"}], ",", "26.72161437"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"14.66642301", ",", 
         RowBox[{"-", "3.86480691"}], ",", "29.66946107"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"13.81720564", ",", 
         RowBox[{"-", "4.80957585"}], ",", "33.81886781"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"14.87345409", ",", 
         RowBox[{"-", "2.59498874"}], ",", "34.76748882"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"15.39395351", ",", "1.44528772", ",", "36.85815284"}], "}"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"17.30484403", ",", "3.96461601", ",", "33.63839891"}], "}"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"21.12515078", ",", "5.86181542", ",", "35.12565358"}], "}"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"19.86522771", ",", "9.24352271", ",", "32.26439089"}], "}"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"19.35522800", ",", "6.40150357", ",", "31.20535106"}], "}"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"21.89517529", ",", "5.54338586", ",", "30.65193349"}], 
        "}"}]}], "}"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.511798320180912*^9, 3.5117983202450314`*^9}, {
   3.5123207502160463`*^9, 3.512320781172483*^9}, {3.512320852239596*^9, 
   3.512320852366061*^9}, {3.512334055642219*^9, 3.5123340571629333`*^9}, {
   3.5123444087209787`*^9, 3.512344437571576*^9}, 3.512354398396409*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "COPY", " ", "THE", " ", "FORCE", " ", "ARRAY", " ", "THAT", " ", "WAS", 
    " ", "CALCULATED", " ", "USING", " ", "ALL", " ", "THE", " ", 
    "POTENTIALS", " ", "UP", " ", "UNTIL", " ", "THE", " ", "ONE", " ", "YOU",
     " ", "ARE", " ", "TESTING", " ", "HERE"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"fca0", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1.79641382", ",", "0.25583380", ",", 
         RowBox[{"-", "0.63476708"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"10.83931141", ",", 
         RowBox[{"-", "0.93849376"}], ",", 
         RowBox[{"-", "25.55913807"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"2.28109289", ",", "0.44870442", ",", "2.83472516"}], "}"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"12.33376831", ",", 
         RowBox[{"-", "5.81916565"}], ",", 
         RowBox[{"-", "25.71414903"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1.86550765"}], ",", "6.02545378", ",", "4.70001727"}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"5.83869944", ",", "3.58417180", ",", 
         RowBox[{"-", "17.29441150"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"6.42391347", ",", 
         RowBox[{"-", "10.52819341"}], ",", 
         RowBox[{"-", "8.01663827"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"3.38947607", ",", "2.12208791", ",", 
         RowBox[{"-", "5.91850714"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"22.15864618", ",", "3.72044483", ",", 
         RowBox[{"-", "27.19019940"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"5.93746519", ",", 
         RowBox[{"-", "15.05194665"}], ",", 
         RowBox[{"-", "0.20392072"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"13.81886190", ",", 
         RowBox[{"-", "7.34596363"}], ",", 
         RowBox[{"-", "19.49756498"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "15.81512910"}], ",", "2.55667928", ",", 
         RowBox[{"-", "4.66415674"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"12.19192553", ",", 
         RowBox[{"-", "2.90872801"}], ",", 
         RowBox[{"-", "37.00677907"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"2.93182138", ",", "4.88639314", ",", 
         RowBox[{"-", "0.29938824"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"13.00727825", ",", 
         RowBox[{"-", "6.88282283"}], ",", 
         RowBox[{"-", "4.26162168"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"9.99893958", ",", 
         RowBox[{"-", "5.69817307"}], ",", "18.15504559"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "10.57145288"}], ",", "8.75681771", ",", "3.94111932"}],
         "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"5.34357055", ",", "17.19664234", ",", "2.21284417"}], "}"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"2.30508341", ",", "4.10128598", ",", 
         RowBox[{"-", "10.27724069"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "5.66296043"}], ",", 
         RowBox[{"-", "2.62540718"}], ",", 
         RowBox[{"-", "8.09022341"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "4.25879618"}], ",", 
         RowBox[{"-", "2.67898797"}], ",", "4.71409055"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "6.42603333"}], ",", 
         RowBox[{"-", "5.78945891"}], ",", "2.30746080"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"11.79037139", ",", 
         RowBox[{"-", "10.44178189"}], ",", "1.58779557"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"8.68019933", ",", 
         RowBox[{"-", "9.29345666"}], ",", "1.41694137"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"5.41486746", ",", "7.25651886", ",", 
         RowBox[{"-", "2.51922593"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "11.49105756"}], ",", "1.45831053", ",", 
         RowBox[{"-", "3.14324502"}]}], "}"}]}], "}"}]}], ";"}], "\n", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"fcb0", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "4.20918343"}], ",", "1.80508229", ",", "0.07224034"}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "8.49438060"}], ",", 
         RowBox[{"-", "7.20637508"}], ",", "24.63013835"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"2.11528506", ",", 
         RowBox[{"-", "0.21113096"}], ",", "0.59499698"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1.86986009"}], ",", "12.40979160", ",", 
         "26.04858191"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "0.09816471"}], ",", "1.38173949", ",", 
         RowBox[{"-", "0.26805230"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1.24625572"}], ",", 
         RowBox[{"-", "2.99175916"}], ",", "18.10263942"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "2.68780064"}], ",", 
         RowBox[{"-", "0.40504019"}], ",", "3.08610116"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"1.26728669", ",", "2.87555098", ",", 
         RowBox[{"-", "4.18211199"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "12.21901475"}], ",", "4.17586035", ",", 
         "33.84792086"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "4.76623518"}], ",", "4.91540536", ",", "2.51037136"}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "8.21740796"}], ",", "4.15755906", ",", "12.18560776"}],
         "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "9.92026782"}], ",", "0.68370508", ",", "2.42507037"}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "8.56170069"}], ",", "1.34693225", ",", "24.93370151"}],
         "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0.22433445", ",", "4.11292904", ",", "4.17956258"}], "}"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "0.99613091"}], ",", 
         RowBox[{"-", "1.20130730"}], ",", 
         RowBox[{"-", "0.17605145"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"6.17544944", ",", 
         RowBox[{"-", "0.99245741"}], ",", "6.43851454"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"1.83263912", ",", 
         RowBox[{"-", "0.34881931"}], ",", "0.44774939"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1.34613124"}], ",", 
         RowBox[{"-", "0.40274323"}], ",", 
         RowBox[{"-", "2.88412123"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"4.01469693", ",", "4.71254454", ",", 
         RowBox[{"-", "0.76499241"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "0.87232753"}], ",", "1.11320933", ",", 
         RowBox[{"-", "1.11953922"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"3.68040724", ",", "1.51073552", ",", 
         RowBox[{"-", "0.24974560"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"2.60806088", ",", 
         RowBox[{"-", "1.19743536"}], ",", 
         RowBox[{"-", "0.88475777"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "5.59683146"}], ",", 
         RowBox[{"-", "2.10087980"}], ",", 
         RowBox[{"-", "8.51242025"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "8.64143445"}], ",", 
         RowBox[{"-", "14.87876547"}], ",", 
         RowBox[{"-", "5.69825194"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"3.78697987", ",", "0.22864265", ",", "1.68821118"}], "}"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"1.03800539", ",", "0.06923726", ",", 
         RowBox[{"-", "0.10658150"}]}], "}"}]}], "}"}]}], ";"}], "\n", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"fo0", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1.02223149"}], ",", "3.16426164", ",", "2.74572498"}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "3.04349932"}], ",", "2.22949018", ",", 
         RowBox[{"-", "4.90705198"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "9.53723075"}], ",", 
         RowBox[{"-", "4.74797891"}], ",", 
         RowBox[{"-", "4.61241858"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "3.52455037"}], ",", "2.84055062", ",", "3.56381776"}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"7.33236297", ",", 
         RowBox[{"-", "9.00287261"}], ",", 
         RowBox[{"-", "0.69111751"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"4.68116928", ",", 
         RowBox[{"-", "3.59657104"}], ",", "6.17692301"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "21.49243153"}], ",", "7.31630556", ",", "1.47022874"}],
         "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "5.29033544"}], ",", 
         RowBox[{"-", "0.64926936"}], ",", "6.46306747"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "6.27374749"}], ",", "8.89989652", ",", 
         RowBox[{"-", "1.34140971"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0.70679650", ",", 
         RowBox[{"-", "3.88374232"}], ",", 
         RowBox[{"-", "4.75644190"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "6.58257113"}], ",", 
         RowBox[{"-", "0.70265844"}], ",", "5.03728708"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"1.51794805", ",", 
         RowBox[{"-", "1.21482417"}], ",", "10.55611728"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "11.71594906"}], ",", 
         RowBox[{"-", "2.43713649"}], ",", 
         RowBox[{"-", "3.81043105"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"1.48061180", ",", 
         RowBox[{"-", "5.25264235"}], ",", "2.97930716"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "17.77794049"}], ",", "13.18098684", ",", 
         RowBox[{"-", "6.46048154"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"5.64901337", ",", "8.58154528", ",", 
         RowBox[{"-", "15.02884923"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "11.78589110"}], ",", 
         RowBox[{"-", "2.51653943"}], ",", 
         RowBox[{"-", "0.99697773"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "7.38717705"}], ",", 
         RowBox[{"-", "14.15737382"}], ",", "19.62404645"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"9.37067615", ",", 
         RowBox[{"-", "7.15235590"}], ",", 
         RowBox[{"-", "0.09636960"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"6.58399433", ",", "1.48629203", ",", "4.69889155"}], "}"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"0.92192003", ",", "2.75860760", ",", 
         RowBox[{"-", "7.75722807"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"16.81756959", ",", "7.95193817", ",", "1.64898915"}], "}"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"1.91419842", ",", "8.70545078", ",", 
         RowBox[{"-", "3.56442652"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "3.42955504"}], ",", 
         RowBox[{"-", "4.74496687"}], ",", "7.33566670"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"4.22886549", ",", "5.25914741", ",", "3.25083783"}], "}"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"0.26719798", ",", 
         RowBox[{"-", "2.24451724"}], ",", "0.54865338"}], "}"}]}], "}"}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.5117983675998487`*^9, 3.511798376364098*^9}, {
   3.512320809937397*^9, 3.512320872585106*^9}, {3.512344502544957*^9, 
   3.512344504918571*^9}, 3.512354345077203*^9, {3.512354421910468*^9, 
   3.512354434568941*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "COPY", " ", "THE", " ", "FORCE", " ", "ARRAY", " ", "THAT", " ", "WAS", 
    " ", "CALCULATED", " ", "INCLUDING", " ", "THE", " ", "POTENTIAL", " ", 
    "THAT", " ", "YOU", " ", "ARE", " ", "TRYING", " ", "TO", " ", "TEST", 
    " ", "HERE"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"fca1", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1.79641382", ",", "0.25583380", ",", 
         RowBox[{"-", "0.63476708"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"10.83931141", ",", 
         RowBox[{"-", "0.93849376"}], ",", 
         RowBox[{"-", "25.55913807"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"2.28109289", ",", "0.44870442", ",", "2.83472516"}], "}"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"12.33376831", ",", 
         RowBox[{"-", "5.81916565"}], ",", 
         RowBox[{"-", "25.71414903"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1.86550765"}], ",", "6.02545378", ",", "4.70001727"}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"5.83869944", ",", "3.58417180", ",", 
         RowBox[{"-", "17.29441150"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"6.42391347", ",", 
         RowBox[{"-", "10.52819341"}], ",", 
         RowBox[{"-", "8.01663827"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"3.38947607", ",", "2.12208791", ",", 
         RowBox[{"-", "5.91850714"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"22.15864618", ",", "3.72044483", ",", 
         RowBox[{"-", "27.19019940"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"5.93746519", ",", 
         RowBox[{"-", "15.05194665"}], ",", 
         RowBox[{"-", "0.20392072"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"13.81886190", ",", 
         RowBox[{"-", "7.34596363"}], ",", 
         RowBox[{"-", "19.49756498"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "15.81512910"}], ",", "2.55667928", ",", 
         RowBox[{"-", "4.66415674"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"12.19192553", ",", 
         RowBox[{"-", "2.90872801"}], ",", 
         RowBox[{"-", "37.00677907"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"2.93182138", ",", "4.88639314", ",", 
         RowBox[{"-", "0.29938824"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"13.00727825", ",", 
         RowBox[{"-", "6.88282283"}], ",", 
         RowBox[{"-", "4.26162168"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"9.99893958", ",", 
         RowBox[{"-", "5.69817307"}], ",", "18.15504559"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "10.57145288"}], ",", "8.75681771", ",", "3.94111932"}],
         "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"5.34357055", ",", "17.19664234", ",", "2.21284417"}], "}"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"2.30508341", ",", "4.10128598", ",", 
         RowBox[{"-", "10.27724069"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "5.66296043"}], ",", 
         RowBox[{"-", "2.62540718"}], ",", 
         RowBox[{"-", "8.09022341"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "4.25879618"}], ",", 
         RowBox[{"-", "2.67898797"}], ",", "4.71409055"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "6.42603333"}], ",", 
         RowBox[{"-", "5.78945891"}], ",", "2.30746080"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"11.79037139", ",", 
         RowBox[{"-", "10.44178189"}], ",", "1.58779557"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"8.68019933", ",", 
         RowBox[{"-", "9.29345666"}], ",", "1.41694137"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"5.41486746", ",", "7.25651886", ",", 
         RowBox[{"-", "2.51922593"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "11.49105756"}], ",", "1.45831053", ",", 
         RowBox[{"-", "3.14324502"}]}], "}"}]}], "}"}]}], ";"}], "\n", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"fcb1", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "4.20918343"}], ",", "1.80508229", ",", "0.07224034"}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "8.49438060"}], ",", 
         RowBox[{"-", "7.20637508"}], ",", "24.63013835"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"2.11528506", ",", 
         RowBox[{"-", "0.21113096"}], ",", "0.59499698"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1.86986009"}], ",", "12.40979160", ",", 
         "26.04858191"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "0.09816471"}], ",", "1.38173949", ",", 
         RowBox[{"-", "0.26805230"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1.24625572"}], ",", 
         RowBox[{"-", "2.99175916"}], ",", "18.10263942"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "2.68780064"}], ",", 
         RowBox[{"-", "0.40504019"}], ",", "3.08610116"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"1.26728669", ",", "2.87555098", ",", 
         RowBox[{"-", "4.18211199"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "12.21901475"}], ",", "4.17586035", ",", 
         "33.84792086"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "4.76623518"}], ",", "4.91540536", ",", "2.51037136"}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "8.21740796"}], ",", "4.15755906", ",", "12.18560776"}],
         "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "9.92026782"}], ",", "0.68370508", ",", "2.42507037"}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "8.56170069"}], ",", "1.34693225", ",", "24.93370151"}],
         "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0.22433445", ",", "4.11292904", ",", "4.17956258"}], "}"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "0.99613091"}], ",", 
         RowBox[{"-", "1.20130730"}], ",", 
         RowBox[{"-", "0.17605145"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"6.17544944", ",", 
         RowBox[{"-", "0.99245741"}], ",", "6.43851454"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"1.83263912", ",", 
         RowBox[{"-", "0.34881931"}], ",", "0.44774939"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1.34613124"}], ",", 
         RowBox[{"-", "0.40274323"}], ",", 
         RowBox[{"-", "2.88412123"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"4.01469693", ",", "4.71254454", ",", 
         RowBox[{"-", "0.76499241"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "0.87232753"}], ",", "1.11320933", ",", 
         RowBox[{"-", "1.11953922"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"3.68040724", ",", "1.51073552", ",", 
         RowBox[{"-", "0.24974560"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"2.60806088", ",", 
         RowBox[{"-", "1.19743536"}], ",", 
         RowBox[{"-", "0.88475777"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "5.59683146"}], ",", 
         RowBox[{"-", "2.10087980"}], ",", 
         RowBox[{"-", "8.51242025"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "8.64143445"}], ",", 
         RowBox[{"-", "14.87876547"}], ",", 
         RowBox[{"-", "5.69825194"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"3.78697987", ",", "0.22864265", ",", "1.68821118"}], "}"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"1.03800539", ",", "0.06923726", ",", 
         RowBox[{"-", "0.10658150"}]}], "}"}]}], "}"}]}], ";"}], "\n", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"fo1", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1.02223149"}], ",", "3.16426164", ",", "2.74572498"}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "3.04349932"}], ",", "2.22949018", ",", 
         RowBox[{"-", "4.90705198"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "9.53723075"}], ",", 
         RowBox[{"-", "4.74797891"}], ",", 
         RowBox[{"-", "4.61241858"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "3.52455037"}], ",", "2.84055062", ",", "3.56381776"}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"7.33236297", ",", 
         RowBox[{"-", "9.00287261"}], ",", 
         RowBox[{"-", "0.69111751"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"4.68116928", ",", 
         RowBox[{"-", "3.59657104"}], ",", "6.17692301"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "21.49243153"}], ",", "7.31630556", ",", "1.47022874"}],
         "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "5.29033544"}], ",", 
         RowBox[{"-", "0.64926936"}], ",", "6.46306747"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "6.27374749"}], ",", "8.89989652", ",", 
         RowBox[{"-", "1.34140971"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0.70679650", ",", 
         RowBox[{"-", "3.88374232"}], ",", 
         RowBox[{"-", "4.75644190"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "6.58257113"}], ",", 
         RowBox[{"-", "0.70265844"}], ",", "5.03728708"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"1.51794805", ",", 
         RowBox[{"-", "1.21482417"}], ",", "10.55611728"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "11.71594906"}], ",", 
         RowBox[{"-", "2.43713649"}], ",", 
         RowBox[{"-", "3.81043105"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"1.48061180", ",", 
         RowBox[{"-", "5.25264235"}], ",", "2.97930716"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "17.77794049"}], ",", "13.18098684", ",", 
         RowBox[{"-", "6.46048154"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"5.64901337", ",", "8.58154528", ",", 
         RowBox[{"-", "15.02884923"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "11.78589110"}], ",", 
         RowBox[{"-", "2.51653943"}], ",", 
         RowBox[{"-", "0.99697773"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "7.38717705"}], ",", 
         RowBox[{"-", "14.15737382"}], ",", "19.62404645"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"9.37067615", ",", 
         RowBox[{"-", "7.15235590"}], ",", 
         RowBox[{"-", "0.09636960"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"6.58399433", ",", "1.48629203", ",", "4.69889155"}], "}"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"0.92192003", ",", "2.75860760", ",", 
         RowBox[{"-", "7.75722807"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"16.81756959", ",", "7.95193817", ",", "1.64898915"}], "}"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"1.91419842", ",", "8.70545078", ",", 
         RowBox[{"-", "3.56442652"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "3.42955504"}], ",", 
         RowBox[{"-", "4.74496687"}], ",", "7.33566670"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"4.22886549", ",", "5.25914741", ",", "3.25083783"}], "}"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"0.26719798", ",", 
         RowBox[{"-", "2.24451724"}], ",", "0.54865338"}], "}"}]}], "}"}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.511798392167981*^9, 3.511798396976932*^9}, {
  3.512321201022827*^9, 3.512321233665188*^9}, {3.512344581438944*^9, 
  3.512344600547886*^9}, {3.5123544790394363`*^9, 3.51235448468552*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "THIS", " ", "DIRECTORY", " ", "SHOULD", " ", "CONTAIN", " ", "THE", " ", 
    "PARAMETER", " ", "FILES", " ", "THAT", " ", "WERE", " ", "USED", " ", 
    "IN", " ", "THE", " ", "LAMMPS", " ", "SIMULATION"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"SetDirectory", "[", "\"\</home/nschafer/Downloads/h4/\>\"", "]"}],
    ";"}]}]], "Input",
 CellChangeTimes->{{3.5117197480160503`*^9, 3.5117197494880667`*^9}, {
  3.512309479799055*^9, 3.5123095136667624`*^9}, {3.51232123983422*^9, 
  3.5123212632084303`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"I", "'"}], "M", " ", "NOT", " ", "SURE", " ", "WHAT", " ", 
     "THIS", " ", "IS", " ", "FOR"}], ",", " ", 
    RowBox[{
    "BUT", " ", "IT", " ", "SHOULD", " ", "NOT", " ", "BE", " ", "EXECUTED", 
     " ", "ON", " ", "A", " ", "TYPICAL", " ", "TEST"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"MyClear", "[", "A_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"B", "=", 
        RowBox[{"{", "}"}]}], "}"}], ",", 
      RowBox[{
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "1"}], ",", 
         RowBox[{"i", "\[LessEqual]", 
          RowBox[{"Length", "[", "A", "]"}]}], ",", 
         RowBox[{
          RowBox[{"B", "=", 
           RowBox[{"Append", "[", 
            RowBox[{"B", ",", 
             RowBox[{"A", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", 
                RowBox[{
                 RowBox[{"-", "3"}], ";;"}]}], "]"}], "]"}]}], " ", "]"}]}], 
          ";", 
          RowBox[{"i", "++"}]}]}], "]"}], ";", 
       RowBox[{"Return", "[", "B", "]"}]}]}], "]"}]}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{"rca", " ", "=", 
     RowBox[{"MyClear", "[", "rca", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"rcb", " ", "=", 
     RowBox[{"MyClear", "[", "rcb", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ro", " ", "=", 
     RowBox[{"MyClear", "[", "ro", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"fca", "=", 
     RowBox[{"MyClear", "[", 
      RowBox[{"fca1", "-", "fca0"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"fcb", "=", 
     RowBox[{"MyClear", "[", 
      RowBox[{"fcb1", "-", "fcb0"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"fo", "=", 
     RowBox[{"MyClear", "[", 
      RowBox[{"fo1", "-", "fo0"}], "]"}]}], ";"}]}]}]], "Input",
 CellOpen->False,
 CellChangeTimes->{{3.4689395345104523`*^9, 3.468939772553584*^9}, {
  3.468939885126484*^9, 3.468939950867543*^9}, {3.512321272798214*^9, 
  3.5123212954290247`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "THIS", " ", "BLOCK", " ", "ISOLATES", " ", "THE", " ", "FORCES", " ", 
    "THAT", " ", "ARE", " ", "DUE", " ", "TO", " ", "THE", " ", "PARTICULAR", 
    " ", "POTENTIAL", " ", "THAT", " ", "YOU", " ", "ARE", " ", "TESTING"}], 
   " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"fca", "=", 
    RowBox[{"fca1", "-", "fca0"}]}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{
    "fca1", " ", "IS", " ", "THE", " ", "TOTAL", " ", "CUMMULATIVE", " ", 
     "FORCE", " ", "FOR", " ", "ALL", " ", "POTENTIALS", " ", "UP", " ", "TO",
      " ", "AND", " ", "INCLUDING", " ", "THE", " ", "ONE", " ", "YOU", " ", 
     "ARE", " ", "TRYING", " ", "TO", " ", "TEST"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"fcb", "=", 
    RowBox[{"fcb1", "-", "fcb0"}]}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{
    "fca0", " ", "IS", " ", "THE", " ", "TOTAL", " ", "CUMMULATIVE", " ", 
     "FORCE", " ", "FOR", " ", "ALL", " ", "POTENTIALS", " ", "UP", " ", "TO",
      " ", "BUT", " ", "NOT", " ", "INCLUDING", " ", "THE", " ", "ONE", " ", 
     "YOU", " ", "ARE", " ", "TRYING", " ", "TO", " ", "TEST"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"fo", "=", 
    RowBox[{"fo1", "-", "fo0", " ", 
     RowBox[{"(*", " ", 
      RowBox[{
      "THEREFORE", " ", "fca", " ", "IS", " ", "THE", " ", "TOTAL", " ", 
       "FORCE", " ", "DUE", " ", "TO", " ", "THE", " ", "POTENTIAL", " ", 
       "THAT", " ", "YOU", " ", "ARE", " ", "TRYING", " ", "TO", " ", "TEST", 
       " ", "AND", " ", "LIKEWISE", " ", "FOR", " ", "THE", " ", "OTHER", " ",
        "ATOMS"}], " ", "*)"}]}]}]}]}]], "Input",
 CellChangeTimes->{{3.468954040626171*^9, 3.468954069185055*^9}, {
  3.4716984564339027`*^9, 3.471698467245936*^9}, {3.512316206321393*^9, 
  3.5123163497499866`*^9}, {3.512320148247431*^9, 3.512320154373982*^9}, {
  3.512321321857375*^9, 3.512321330960184*^9}, {3.5123536916185923`*^9, 
  3.512353694149489*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0.1452180299999999`", ",", 
     RowBox[{"-", "0.15074325`"}], ",", "0.0075662899999999755`"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.15885862999999922`"}], ",", 
     RowBox[{"-", "3.33168732`"}], ",", "1.5295895900000005`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1.74891522`", ",", "2.01528671`", ",", 
     RowBox[{"-", "0.32884391999999973`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3.9156579800000006`", ",", 
     RowBox[{"-", "2.7372688600000004`"}], ",", 
     RowBox[{"-", "2.094675030000001`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.5128150099999997`", ",", 
     RowBox[{"-", "1.1936272899999993`"}], ",", "3.04335389`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4.32577088`", ",", "1.2513574799999998`", ",", 
     RowBox[{"-", "3.2518149299999983`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.22729085000000016`"}], ",", 
     RowBox[{"-", "0.29002333000000036`"}], ",", 
     RowBox[{"-", "4.04835622`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.06124733999999998`"}], ",", "0.7744348199999997`", ",", 
     RowBox[{"-", "0.3523352099999997`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1.4780920300000027`", ",", 
     RowBox[{"-", "1.79452913`"}], ",", 
     RowBox[{"-", "4.7464406`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.11845345000000052`", ",", 
     RowBox[{"-", "0.05878899000000004`"}], ",", 
     RowBox[{"-", "0.28966886000000003`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4.56485524`", ",", 
     RowBox[{"-", "0.5424232`"}], ",", 
     RowBox[{"-", "6.79326238`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "4.57625494`"}], ",", "0.9418686999999999`", ",", 
     "3.75289655`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4.531123270000001`", ",", "3.6798242100000005`", ",", 
     RowBox[{"-", "7.423566470000001`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "1.4237176599999999`"}], ",", "0.7182017399999996`", ",", 
     RowBox[{"-", "0.46530901`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"12.88374467`", ",", 
     RowBox[{"-", "6.4180263900000005`"}], ",", 
     RowBox[{"-", "12.415467970000002`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1.0682057100000009`", ",", 
     RowBox[{"-", "0.10999100999999989`"}], ",", "11.49286526`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2.7380957299999995`", ",", 
     RowBox[{"-", "0.7068445899999993`"}], ",", 
     RowBox[{"-", "7.265217289999999`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"8.65578001`", ",", "11.93435412`", ",", 
     RowBox[{"-", "0.06997907000000003`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "6.39982206`"}], ",", 
     RowBox[{"-", "0.4357548099999997`"}], ",", 
     RowBox[{"-", "0.17194308000000014`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.28803292999999996`", ",", "0.3230615300000004`", ",", 
     RowBox[{"-", "2.9688891699999997`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "4.36567763`"}], ",", "3.95285382`", ",", "8.25365081`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.5046077000000002`", ",", 
     RowBox[{"-", "3.9686781099999995`"}], ",", 
     RowBox[{"-", "6.07210362`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "5.492931859999999`"}], ",", "2.73421261`", ",", 
     "6.98040839`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.12039636999999992`", ",", 
     RowBox[{"-", "0.16916304000000082`"}], ",", 
     RowBox[{"-", "0.6171847499999998`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "1.0858939100000002`"}], ",", 
     RowBox[{"-", "0.5206765999999998`"}], ",", "0.7921717999999998`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.08116854999999923`"}], ",", 
     RowBox[{"-", "0.7745841600000001`"}], ",", "0.36921548999999976`"}], 
    "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.512353696218438*^9, 3.5123544908266087`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0.008913589999999694`", ",", 
     RowBox[{"-", "0.07057835999999984`"}], ",", "0.09587853`"}], "}"}], ",", 
   
   RowBox[{"{", 
    RowBox[{"0.1769453900000002`", ",", 
     RowBox[{"-", "0.059823909999999536`"}], ",", "0.010225399999999496`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.29768887`"}], ",", "0.19179516`", ",", 
     "0.010625870000000037`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.07990201000000008`", ",", "0.08644527000000046`", ",", 
     RowBox[{"-", "0.13866913000000025`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.35783508999999997`"}], ",", 
     RowBox[{"-", "0.1784586800000001`"}], ",", "0.10030711999999997`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.08904614999999994`"}], ",", 
     RowBox[{"-", "0.07725663999999988`"}], ",", "0.21696655999999948`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.06479261000000003`"}], ",", 
     RowBox[{"-", "0.0018683400000000239`"}], ",", "0.08788412999999995`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.0003713999999999107`", ",", "0.05406030999999967`", ",", 
     RowBox[{"-", "0.07067163000000054`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.11114058999999976`"}], ",", "0.07902131999999984`", ",", 
     "0.31650223000000466`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.13840918000000002`"}], ",", "1.0062056600000004`", ",", 
     RowBox[{"-", "0.13155877999999976`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.07769124000000005`"}], ",", "0.11625265999999979`", ",", 
     "0.14626460999999935`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.14921498`", ",", "0.08094784999999993`", ",", "0.1380468699999997`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.056156160000000455`"}], ",", "0.03628946000000011`", ",",
      "0.11954451999999804`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.004999079999999989`", ",", "0.11340831000000007`", ",", 
     "0.09360023999999978`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.38916185999999997`", ",", "0.21141239`", ",", 
     RowBox[{"-", "0.17283679`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.5858995200000008`", ",", "0.36046740999999993`", ",", 
     "0.6226015199999999`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.31542382000000013`", ",", "0.03807347`", ",", 
     RowBox[{"-", "0.19019354999999993`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.52344134`", ",", "0.045830079999999995`", ",", 
     "0.29871751000000035`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.05657625000000044`", ",", 
     RowBox[{"-", "0.1126762500000007`"}], ",", 
     RowBox[{"-", "0.07067329999999994`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.46410678000000005`", ",", "0.14659694000000012`", ",", 
     "0.2661591299999999`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.005865669999999934`", ",", 
     RowBox[{"-", "0.06991208999999987`"}], ",", "0.03041096999999998`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.2352961200000001`"}], ",", "0.25833843999999995`", ",", 
     "0.15571167000000008`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.05318174999999936`"}], ",", "0.09174862000000017`", ",", 
     
     RowBox[{"-", "0.1255657199999991`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.7372369899999995`", ",", "1.1301726500000004`", ",", 
     "0.27362262000000026`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.40146596999999984`"}], ",", 
     RowBox[{"-", "0.006828830000000008`"}], ",", 
     RowBox[{"-", "0.21618188000000016`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.37134645999999993`", ",", "0.32250678`", ",", 
     "0.005802189999999999`"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.512353696218438*^9, 3.51235449085067*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.04251871000000007`"}], ",", "0.030938099999999746`", ",", 
     RowBox[{"-", "0.10915882000000021`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.2303873099999998`"}], ",", "1.40796263`", ",", 
     RowBox[{"-", "0.9532367400000004`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "3.423405370000001`"}], ",", "3.0112890400000003`", ",", 
     RowBox[{"-", "1.5305364099999998`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.5203080199999999`"}], ",", "0.5199310700000002`", ",", 
     "1.0088168199999998`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "5.66119486`"}], ",", 
     RowBox[{"-", "0.6909626300000014`"}], ",", "2.1645255399999996`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.12209700000000012`", ",", 
     RowBox[{"-", "0.21659527`"}], ",", "0.1882814100000001`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.8068055199999975`", ",", 
     RowBox[{"-", "0.9670814700000001`"}], ",", "1.82345449`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "1.4952596099999997`"}], ",", "1.21988771`", ",", 
     "6.666467900000001`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.8068128100000003`"}], ",", "0.15672143000000105`", ",", 
     RowBox[{"-", "0.11969095000000007`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.28865328000000007`", ",", 
     RowBox[{"-", "0.3515758600000001`"}], ",", "0.5488190900000003`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "1.78286092`"}], ",", "0.3624109900000001`", ",", 
     "2.1345930499999994`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "3.2709290199999996`"}], ",", 
     RowBox[{"-", "4.37806846`"}], ",", "8.07831045`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.37305727000000033`"}], ",", 
     RowBox[{"-", "0.35501786999999974`"}], ",", 
     RowBox[{"-", "0.21961598999999987`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "1.22529754`"}], ",", 
     RowBox[{"-", "0.9004790800000002`"}], ",", "0.72172575`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "16.83897085`"}], ",", "8.11260133`", ",", "15.4985222`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2.8316165399999997`", ",", 
     RowBox[{"-", "0.7509639799999999`"}], ",", 
     RowBox[{"-", "7.613617980000001`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "7.0038295900000005`"}], ",", 
     RowBox[{"-", "7.17469898`"}], ",", 
     RowBox[{"-", "0.2318736`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "1.1550345000000002`"}], ",", 
     RowBox[{"-", "2.5711125900000003`"}], ",", "0.17486299000000116`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1.5288827699999992`", ",", 
     RowBox[{"-", "2.31041953`"}], ",", "1.46682646`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"5.8517528400000005`", ",", 
     RowBox[{"-", "1.7071053900000002`"}], ",", 
     RowBox[{"-", "0.0722646100000004`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.86945719`"}], ",", "0.6106547199999999`", ",", 
     RowBox[{"-", "2.33241125`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4.949637000000001`", ",", 
     RowBox[{"-", "2.7396009400000008`"}], ",", 
     RowBox[{"-", "5.25519382`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2.28439209`", ",", "0.86476446`", ",", 
     RowBox[{"-", "0.033732490000000226`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.08107846000000007`", ",", 
     RowBox[{"-", "0.6712462199999996`"}], ",", "0.27386659999999985`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.23654961999999946`", ",", "0.5965235699999996`", ",", 
     RowBox[{"-", "0.9956091000000002`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.004256340000000025`", ",", 
     RowBox[{"-", "0.023572140000000186`"}], ",", 
     RowBox[{"-", "0.0013123999999999914`"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.512353696218438*^9, 3.512354490856485*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "THIS", " ", "MAPS", " ", "EACH", " ", "LETTER", " ", "OF", " ", "THE", 
    " ", "ALPHABET", " ", "TO", " ", "THE", " ", "ONE", " ", "LETTER", " ", 
    "AMINO", " ", "ACID", " ", "CODE"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"resmap", "=", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "4", ",", "3", ",", "6", ",", "13", ",", "7", ",", 
       "8", ",", "9", ",", "0", ",", "11", ",", "10", ",", "12", ",", "2", 
       ",", "0", ",", "14", ",", "5", ",", "1", ",", "15", ",", "16", ",", 
       "0", ",", "19", ",", "17", ",", "0", ",", "18", ",", "0"}], "}"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "THIS", " ", "IS", " ", "THE", " ", "ONE", " ", "LETTER", " ", "SEQUENCE",
      " ", "OF", " ", "THE", " ", "PROTEIN", " ", "THAT", " ", "YOU", " ", 
     "ARE", " ", "USING", " ", "TO", " ", "TEST"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"seq", "=", "\"\<SGRGKGGKGLGKGGAKRARKVLRDNQ\>\""}], ";"}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{
    "THIS", " ", "PARTICULAR", " ", "SEQUENCE", " ", "IS", " ", "THAT", " ", 
     "OF", " ", "H4", " ", "HISTONE", " ", "TAIL", " ", "PROTEIN"}], " ", 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "THESE", " ", "LINES", " ", "CREATE", " ", "AN", " ", "ARRAY", " ", "se", 
     " ", "THAT", " ", "CONVERTS", " ", "THE", " ", "INPUT", " ", "SEQUENCE", 
     " ", "ABOVE", " ", "USING", " ", "THE", " ", "resmap", " ", "ARRAY", " ",
      "FROM", " ", "A", " ", "ONE", " ", "LETTER", " ", "CODE", " ", "TO", 
     " ", "A", " ", "NUMBER", " ", "CODE"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"chseq", "=", 
     RowBox[{"Characters", "[", "seq", "]"}]}], ";"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{"M", "=", 
     RowBox[{"Length", "[", "chseq", "]"}]}], ";", " ", 
    RowBox[{"(*", " ", 
     RowBox[{
     "CALCULATES", " ", "THE", " ", "LENGTH", " ", "OF", " ", "THE", " ", 
      "INPUT", " ", "SEQUENCE", " ", "DEFINED", " ", "ABOVE"}], " ", "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{"se", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"index", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"ToCharacterCode", "[", "seq", "]"}], "[", 
           RowBox[{"[", "i", "]"}], "]"}], "-", 
          RowBox[{
           RowBox[{"ToCharacterCode", "[", "\"\<A\>\"", "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}], "+", "1"}]}], ";", 
        RowBox[{
         RowBox[{"resmap", "[", 
          RowBox[{"[", "index", "]"}], "]"}], "+", "1"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "M"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "THESE", " ", "ARE", " ", "TWO", " ", "POSSIBLE", " ", "CHOICES", " ", 
     "OF", " ", "COEFFICIENTS", " ", "FOR", " ", "CALCULATING", " ", "THE", 
     " ", "POSITIONS", " ", "OF", " ", "THE", " ", "MISSING", " ", "ATOMS"}], 
    " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"an", "=", "0.4831806"}], ";", 
    RowBox[{"bn", "=", "0.7032820"}], ";", 
    RowBox[{"cn", "=", 
     RowBox[{"-", "0.1864262"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"ap", "=", "0.4436538"}], ";", 
    RowBox[{"bp", "=", "0.2352006"}], ";", 
    RowBox[{"cp", "=", "0.3211455"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"ah", "=", "0.8409657"}], ";", 
    RowBox[{"bh", "=", "0.8929599"}], ";", 
    RowBox[{"ch", "=", 
     RowBox[{"-", "0.7338894"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "SINCE", " ", "THESE", " ", "ARE", " ", "EXECUTED", " ", "LAST"}], ",", 
     " ", 
     RowBox[{
     "THESE", " ", "ARE", " ", "THE", " ", "VALUES", " ", "THAT", " ", "ARE", 
      " ", "USED", " ", "AND", " ", "SHOULD", " ", "MATCH", " ", "THOSE", " ",
       "IN", " ", "LAMMPS"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"an", "=", "0.483"}], ";", " ", 
    RowBox[{"bn", "=", " ", "0.703"}], ";", " ", 
    RowBox[{"cn", "=", " ", 
     RowBox[{"-", "0.186"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"ap", "=", "0.444"}], ";", " ", 
    RowBox[{"bp", "=", " ", "0.235"}], ";", " ", 
    RowBox[{"cp", "=", " ", "0.321"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"ah", "=", "0.841"}], ";", " ", 
    RowBox[{"bh", "=", " ", "0.893"}], ";", " ", 
    RowBox[{"ch", "=", 
     RowBox[{"-", "0.734"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "THESE", " ", "LINES", " ", "DEFINE", " ", "PARAMETERS", " ", "EITHER", 
     " ", "DIRECTLY", " ", "OR", " ", "BY", " ", "READING", " ", "FILES", " ",
      "THAT", " ", "ARE", " ", "IN", " ", "THE", " ", "DIRECTORY", " ", 
     "SPECIFIED", " ", "ABOVE"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"rNOzero", "=", "2.98"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"rHOzero", "=", "2.06"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Sigma]NO", "=", "0.68"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Sigma]HO", "=", "0.76"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"dnu", "=", "12.0"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"pref", "=", "0.5"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"cutoff", " ", "=", " ", "7.0"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"hbscl", "=", 
      RowBox[{"{", 
       RowBox[{
       "1.0", ",", " ", "1.0", ",", " ", "1.0", ",", " ", "1.0", ",", " ", 
        "4.0", ",", " ", "1.0", ",", " ", "1.0", ",", " ", "1.0", ",", " ", 
        "4.0", ",", " ", "4.0", ",", " ", "1.0", ",", " ", "1.0", ",", " ", 
        "1.0", ",", " ", "1.0", ",", " ", "1.0", ",", " ", "1.0", ",", " ", 
        "1.0"}], "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"hbscl", "=", 
      RowBox[{"{", 
       RowBox[{
       "0.0", ",", " ", "0.0", ",", " ", "1.0", ",", " ", "0.0", ",", " ", 
        "4.0", ",", " ", "0.0", ",", " ", "1.0", ",", " ", "0.0", ",", " ", 
        "4.0", ",", " ", "4.0", ",", " ", "1.0", ",", " ", "1.0", ",", " ", 
        "1.0", ",", " ", "1.0", ",", " ", "1.0", ",", " ", "1.0", ",", " ", 
        "1.0"}], "}"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"hbscl", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0.0", ",", " ", "0.0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
        "1.37", ",", " ", "0.0", ",", " ", "3.89", ",", " ", "1.30", ",", " ",
          "1.32", ",", " ", "1.22", ",", " ", "0.0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
        "1.36", ",", " ", "0.0", ",", " ", "3.50", ",", " ", "1.30", ",", " ",
          "1.32", ",", " ", "1.22", ",", " ", "3.47", ",", " ", "0.33", ",", 
         " ", "1.01"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
        "1.17", ",", " ", "0.0", ",", " ", "3.52", ",", " ", "1.30", ",", " ",
          "1.32", ",", " ", "1.22", ",", " ", "3.62", ",", " ", "0.33", ",", 
         " ", "1.01"}], "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "THE", " ", "FILES", " ", "READ", " ", "HERE", " ", "SHOULD", " ", "BE", 
     " ", "IDENTICAL", " ", "TO", " ", "THOSE", " ", "USED", " ", "IN", " ", 
     "THE", " ", "LAMMPS", " ", "SIMULATIONS"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"antiHB", "=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"A", ",", "A1", ",", "A2"}], "}"}], ",", 
       RowBox[{
        RowBox[{"A", "=", 
         RowBox[{"StringSplit", "[", 
          RowBox[{"ReadList", "[", 
           RowBox[{"\"\<anti_HB\>\"", ",", "String"}], "]"}], "]"}]}], ";", 
        RowBox[{"A1", "=", 
         RowBox[{"A", "[", 
          RowBox[{"[", 
           RowBox[{";;", "20"}], "]"}], "]"}]}], ";", 
        RowBox[{"A2", "=", 
         RowBox[{"A", "[", 
          RowBox[{"[", 
           RowBox[{"22", ";;"}], "]"}], "]"}]}], ";", 
        RowBox[{"ToExpression", "[", 
         RowBox[{"{", 
          RowBox[{"A1", ",", "A2"}], "}"}], "]"}]}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"antiNHB", "=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"A", ",", "A1", ",", "A2"}], "}"}], ",", 
       RowBox[{
        RowBox[{"A", "=", 
         RowBox[{"StringSplit", "[", 
          RowBox[{"ReadList", "[", 
           RowBox[{"\"\<anti_NHB\>\"", ",", "String"}], "]"}], "]"}]}], ";", 
        RowBox[{"A1", "=", 
         RowBox[{"A", "[", 
          RowBox[{"[", 
           RowBox[{";;", "20"}], "]"}], "]"}]}], ";", 
        RowBox[{"A2", "=", 
         RowBox[{"A", "[", 
          RowBox[{"[", 
           RowBox[{"22", ";;"}], "]"}], "]"}]}], ";", 
        RowBox[{"ToExpression", "[", 
         RowBox[{"{", 
          RowBox[{"A1", ",", "A2"}], "}"}], "]"}]}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"paraHB", "=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"A", ",", "A1", ",", "A2"}], "}"}], ",", 
       RowBox[{
        RowBox[{"A", "=", 
         RowBox[{"StringSplit", "[", 
          RowBox[{"ReadList", "[", 
           RowBox[{"\"\<para_HB\>\"", ",", "String"}], "]"}], "]"}]}], ";", 
        RowBox[{"A1", "=", 
         RowBox[{"A", "[", 
          RowBox[{"[", 
           RowBox[{";;", "20"}], "]"}], "]"}]}], ";", 
        RowBox[{"A2", "=", 
         RowBox[{"A", "[", 
          RowBox[{"[", 
           RowBox[{"22", ";;"}], "]"}], "]"}]}], ";", 
        RowBox[{"ToExpression", "[", 
         RowBox[{"{", 
          RowBox[{"A1", ",", "A2"}], "}"}], "]"}]}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"paraOne", "=", 
     RowBox[{"ReadList", "[", 
      RowBox[{"\"\<para_one\>\"", ",", "Real"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"antiOne", "=", 
     RowBox[{"ReadList", "[", 
      RowBox[{"\"\<anti_one\>\"", ",", "Real"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "WHEN", " ", "TESTING", " ", "THE", " ", "SECONDARY", " ", "STRUCTURE", 
      " ", "BIAS"}], ",", " ", 
     RowBox[{
     "IT", " ", "IS", " ", "NECESSARY", " ", "TO", " ", "INPUT", " ", "THE", 
      " ", "ssweight", " ", "FILE", " ", "HERE"}]}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ssweight5", "=", 
     RowBox[{"Table", "[", 
      RowBox[{"0.0", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "M"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ssweight6", "=", 
     RowBox[{"Table", "[", 
      RowBox[{"0.0", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "M"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ssweight5", "=", 
     RowBox[{"{", 
      RowBox[{
      "0.0", ",", "0.0", ",", "0.0", ",", "0.0", ",", "0.0", ",", "0.0", ",", 
       "0.0", ",", "1.0", ",", "1.0", ",", "1.0", ",", "0.0", ",", "0.0", ",",
        "0.0", ",", "0.0", ",", "1.0", ",", "1.0", ",", "1.0", ",", "1.0", 
       ",", "1.0", ",", "1.0", ",", "1.0", ",", "0.0", ",", "0.0", ",", "0.0",
        ",", "0.0", ",", "0.0"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ssweight6", "=", 
     RowBox[{"{", 
      RowBox[{
      "0.0", ",", "0.0", ",", "1.0", ",", "0.0", ",", "0.0", ",", "1.0", ",", 
       "0.0", ",", "0.0", ",", "1.0", ",", "0.0", ",", "0.0", ",", "1.0", ",",
        "0.0", ",", "0.0", ",", "1.0", ",", "0.0", ",", "0.0", ",", "1.0", 
       ",", "0.0", ",", "0.0", ",", "1.0", ",", "0.0", ",", "0.0", ",", "1.0",
        ",", "0.0", ",", "0.0"}], "}"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.468855041674871*^9, 3.468855079950027*^9}, {
   3.468855666605926*^9, 3.468855673900051*^9}, 3.468855709289034*^9, {
   3.468855745638946*^9, 3.468855829557212*^9}, {3.468855888638706*^9, 
   3.468855943278901*^9}, {3.4688576810114937`*^9, 3.468857684633127*^9}, {
   3.46885855303533*^9, 3.468858580761301*^9}, {3.468859141012412*^9, 
   3.468859145274663*^9}, {3.468859214252527*^9, 3.4688592331711807`*^9}, {
   3.468859979725029*^9, 3.46885999866171*^9}, {3.468860818095912*^9, 
   3.4688608360157146`*^9}, {3.468860933646689*^9, 3.468860942091736*^9}, {
   3.468861504985867*^9, 3.468861524727579*^9}, {3.468861960119812*^9, 
   3.468861960417213*^9}, {3.468935785699058*^9, 3.4689357869081783`*^9}, {
   3.4689361497449617`*^9, 3.468936212542829*^9}, {3.468936354506432*^9, 
   3.468936355251848*^9}, {3.46894268019945*^9, 3.4689426846410217`*^9}, 
   3.4704215988137207`*^9, {3.470422467249007*^9, 3.470422497914154*^9}, {
   3.470422776821528*^9, 3.470422801419194*^9}, {3.47042441676908*^9, 
   3.470424484888514*^9}, {3.470503754616066*^9, 3.470503755284004*^9}, {
   3.470507820837861*^9, 3.470507854574795*^9}, {3.4706652122045116`*^9, 
   3.470665213975938*^9}, {3.470704290766*^9, 3.470704300461*^9}, {
   3.471097821352539*^9, 3.471097834694333*^9}, {3.4729055995300703`*^9, 
   3.472905673556264*^9}, {3.472921774872183*^9, 3.472921775391543*^9}, {
   3.511719292462266*^9, 3.511719361249833*^9}, {3.5117277678340693`*^9, 
   3.511727800103484*^9}, 3.511727869234653*^9, {3.511727923766663*^9, 
   3.51172792509929*^9}, {3.5117280512682447`*^9, 3.511728053650504*^9}, {
   3.51173014931666*^9, 3.5117301502023907`*^9}, {3.511730197731691*^9, 
   3.511730199507243*^9}, {3.5123201646345787`*^9, 3.512320285482141*^9}, {
   3.512320320954728*^9, 3.5123204634327106`*^9}, {3.512320515247918*^9, 
   3.512320536041355*^9}, {3.512320581393486*^9, 3.5123207300306892`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"THIS", " ", "BLOCK", " ", "\"\<SETS THE RULES\>\""}], ",", " ", 
    RowBox[{
    "WHICH", " ", "MEANS", " ", "IT", " ", "TELLS", " ", "MATHEMATICA", " ", 
     "HOW", " ", "TO", " ", "EVALUATE", " ", "ALL", " ", "THE", " ", 
     "POTENTIALS", " ", "GIVEN", " ", "THE", " ", "INPUT", " ", "SPECIFIED", 
     " ", "ABOVE"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    SubscriptBox["r", 
     RowBox[{"u_", ",", "i_"}]], ":=", 
    RowBox[{"{", 
     RowBox[{
      SubscriptBox["x", 
       RowBox[{"u", ",", "i"}]], ",", 
      SubscriptBox["y", 
       RowBox[{"u", ",", "i"}]], ",", 
      SubscriptBox["z", 
       RowBox[{"u", ",", "i"}]]}], "}"}]}], "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["r", 
     RowBox[{"N", ",", "i_"}]], ":=", 
    RowBox[{
     RowBox[{"an", " ", 
      SubscriptBox["r", 
       RowBox[{"Ca", ",", 
        RowBox[{"i", "-", "1"}]}]]}], "+", 
     RowBox[{"bn", " ", 
      SubscriptBox["r", 
       RowBox[{"Ca", ",", "i"}]]}], "+", 
     RowBox[{"cn", " ", 
      SubscriptBox["r", 
       RowBox[{"O", ",", 
        RowBox[{"i", "-", "1"}]}]]}]}]}], "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["r", 
     RowBox[{"H", ",", "i_"}]], ":=", 
    RowBox[{
     RowBox[{"ah", " ", 
      SubscriptBox["r", 
       RowBox[{"Ca", ",", 
        RowBox[{"i", "-", "1"}]}]]}], "+", 
     RowBox[{"bh", " ", 
      SubscriptBox["r", 
       RowBox[{"Ca", ",", "i"}]]}], "+", 
     RowBox[{"ch", " ", 
      SubscriptBox["r", 
       RowBox[{"O", ",", 
        RowBox[{"i", "-", "1"}]}]]}]}]}], "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["r", 
     RowBox[{"Cp", ",", "i_"}]], ":=", 
    RowBox[{
     RowBox[{"ap", " ", 
      SubscriptBox["r", 
       RowBox[{"Ca", ",", "i"}]]}], "+", 
     RowBox[{"bp", " ", 
      SubscriptBox["r", 
       RowBox[{"Ca", ",", 
        RowBox[{"i", "+", "1"}]}]]}], "+", 
     RowBox[{"cp", " ", 
      SubscriptBox["r", 
       RowBox[{"O", ",", "i"}]]}]}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MyNorm", "[", "a_", "]"}], ":=", 
    SqrtBox[
     RowBox[{"Total", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        SuperscriptBox["ai", "2"], ",", 
        RowBox[{"{", 
         RowBox[{"ai", ",", "a"}], "}"}]}], "]"}], "]"}]]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"rule", "=", 
     RowBox[{"Flatten", "[", 
      RowBox[{"Append", "[", 
       RowBox[{
        RowBox[{"Append", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               SubscriptBox["r", 
                RowBox[{"Ca", ",", "i"}]], "[", 
               RowBox[{"[", "j", "]"}], "]"}], "\[Rule]", 
              RowBox[{"rca", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "j"}], "]"}], "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", "M"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", "1", ",", "3"}], "}"}]}], "]"}], ",", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               SubscriptBox["r", 
                RowBox[{"Cb", ",", "i"}]], "[", 
               RowBox[{"[", "j", "]"}], "]"}], "\[Rule]", 
              RowBox[{"rcb", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "j"}], "]"}], "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", "M"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", "1", ",", "3"}], "}"}]}], "]"}]}], "]"}], ",", 
        
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             SubscriptBox["r", 
              RowBox[{"O", ",", "i"}]], "[", 
             RowBox[{"[", "j", "]"}], "]"}], "\[Rule]", 
            RowBox[{"ro", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "j"}], "]"}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "M"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "1", ",", "3"}], "}"}]}], "]"}]}], "]"}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"rule", "=", 
     RowBox[{"Flatten", "[", 
      RowBox[{"Append", "[", 
       RowBox[{
        RowBox[{"Append", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               SubscriptBox["r", 
                RowBox[{"Ca", ",", "i"}]], "[", 
               RowBox[{"[", "j", "]"}], "]"}], "\[Rule]", 
              RowBox[{"rca", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "j"}], "]"}], "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", "M"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", "1", ",", "3"}], "}"}]}], "]"}], ",", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               SubscriptBox["r", 
                RowBox[{"Cb", ",", "i"}]], "[", 
               RowBox[{"[", "j", "]"}], "]"}], "\[Rule]", 
              RowBox[{"rcb", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "j"}], "]"}], "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", "M"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", "1", ",", "3"}], "}"}]}], "]"}]}], "]"}], ",", 
        
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             SubscriptBox["r", 
              RowBox[{"O", ",", "i"}]], "[", 
             RowBox[{"[", "j", "]"}], "]"}], "\[Rule]", 
            RowBox[{"ro", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "j"}], "]"}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "M"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "1", ",", "3"}], "}"}]}], "]"}]}], "]"}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"rulee", "[", 
     RowBox[{"a_", ",", "i_"}], "]"}], ":=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"rule", "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{"3", "M", 
          RowBox[{"(", 
           RowBox[{"a", "-", "1"}], ")"}]}], "+", 
         RowBox[{"3", 
          RowBox[{"(", 
           RowBox[{"i", "-", "1"}], ")"}]}], "+", "1"}], "]"}], "]"}], ",", 
      RowBox[{"rule", "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{"3", "M", 
          RowBox[{"(", 
           RowBox[{"a", "-", "1"}], ")"}]}], "+", 
         RowBox[{"3", 
          RowBox[{"(", 
           RowBox[{"i", "-", "1"}], ")"}]}], "+", "2"}], "]"}], "]"}], ",", 
      RowBox[{"rule", "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{"3", "M", 
          RowBox[{"(", 
           RowBox[{"a", "-", "1"}], ")"}]}], "+", 
         RowBox[{"3", 
          RowBox[{"(", 
           RowBox[{"i", "-", "1"}], ")"}]}], "+", "3"}], "]"}], "]"}]}], 
     "}"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"rules", "[", 
     RowBox[{"a_", ",", "i_"}], "]"}], ":=", 
    RowBox[{"Delete", "[", 
     RowBox[{"rule", ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"3", "M", 
           RowBox[{"(", 
            RowBox[{"a", "-", "1"}], ")"}]}], "+", 
          RowBox[{"3", 
           RowBox[{"(", 
            RowBox[{"i", "-", "1"}], ")"}]}], "+", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"3", "M", 
           RowBox[{"(", 
            RowBox[{"a", "-", "1"}], ")"}]}], "+", 
          RowBox[{"3", 
           RowBox[{"(", 
            RowBox[{"i", "-", "1"}], ")"}]}], "+", "2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"3", "M", 
           RowBox[{"(", 
            RowBox[{"a", "-", "1"}], ")"}]}], "+", 
          RowBox[{"3", 
           RowBox[{"(", 
            RowBox[{"i", "-", "1"}], ")"}]}], "+", "3"}], "}"}]}], "}"}]}], 
     "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Ruless", "[", "a_", "]"}], ":=", 
     RowBox[{"Flatten", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"a", "\[Equal]", "1"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             SubscriptBox["r", 
              RowBox[{"Ca", ",", "i"}]], "[", 
             RowBox[{"[", "j", "]"}], "]"}], "\[Rule]", 
            RowBox[{"rca", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "j"}], "]"}], "]"}]}], "}"}], ",", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"a", "\[Equal]", "2"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               SubscriptBox["r", 
                RowBox[{"Cb", ",", "i"}]], "[", 
               RowBox[{"[", "j", "]"}], "]"}], "\[Rule]", 
              RowBox[{"rcb", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "j"}], "]"}], "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               SubscriptBox["r", 
                RowBox[{"O", ",", "i"}]], "[", 
               RowBox[{"[", "j", "]"}], "]"}], "\[Rule]", 
              RowBox[{"ro", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "j"}], "]"}], "]"}]}], "}"}]}], "]"}]}], 
         "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "M"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", "3"}], "}"}]}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Rulee", "[", 
     RowBox[{"a_", ",", "i_"}], "]"}], ":=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"Ruless", "[", "a", "]"}], "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{"3", 
          RowBox[{"(", 
           RowBox[{"i", "-", "1"}], ")"}]}], "+", "1"}], "]"}], "]"}], ",", 
      RowBox[{
       RowBox[{"Ruless", "[", "a", "]"}], "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{"3", 
          RowBox[{"(", 
           RowBox[{"i", "-", "1"}], ")"}]}], "+", "2"}], "]"}], "]"}], ",", 
      RowBox[{
       RowBox[{"Ruless", "[", "a", "]"}], "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{"3", 
          RowBox[{"(", 
           RowBox[{"i", "-", "1"}], ")"}]}], "+", "3"}], "]"}], "]"}]}], 
     "}"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Rules", "[", 
     RowBox[{"a_", ",", "i_"}], "]"}], ":=", 
    RowBox[{"Delete", "[", 
     RowBox[{
      RowBox[{"Ruless", "[", "a", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"3", 
           RowBox[{"(", 
            RowBox[{"i", "-", "1"}], ")"}]}], "+", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"3", 
           RowBox[{"(", 
            RowBox[{"i", "-", "1"}], ")"}]}], "+", "2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"3", 
           RowBox[{"(", 
            RowBox[{"i", "-", "1"}], ")"}]}], "+", "3"}], "}"}]}], "}"}]}], 
     "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.468854673666232*^9, 3.468854684512622*^9}, {
  3.468854902951829*^9, 3.468854932950259*^9}, {3.46885839650323*^9, 
  3.468858396977489*^9}, {3.468860186729788*^9, 3.4688601872483377`*^9}, {
  3.472411610493401*^9, 3.472411621584505*^9}, {3.512321382434227*^9, 
  3.5123214118001003`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "THIS", " ", "BLOCK", " ", "DEFINES", " ", "THE", " ", "DSSP", " ", 
    "POTENTIAL"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"iRepulsive", "[", 
     RowBox[{"i_", ",", "j_"}], "]"}], ":=", 
    RowBox[{"If", " ", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"j", "\[Equal]", "M"}], "  ", "||", " ", 
       RowBox[{
        RowBox[{"se", "[", 
         RowBox[{"[", 
          RowBox[{"j", "+", "1"}], "]"}], "]"}], "\[Equal]", "15"}]}], ",", 
      " ", "False", ",", " ", "True"}], "]"}]}], "\n", 
   RowBox[{
    RowBox[{"iAP", "[", 
     RowBox[{"i_", ",", "j_"}], "]"}], ":=", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"i", "\[Equal]", "1"}], " ", "||", " ", 
       RowBox[{"j", "\[Equal]", "M"}], " ", "||", " ", 
       RowBox[{
        RowBox[{"se", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "\[Equal]", "15"}]}], ",", "False", 
      ",", " ", "True"}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"iP", "[", 
     RowBox[{"i_", ",", "j_"}], "]"}], ":=", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"i", "\[Equal]", 
        RowBox[{"M", "-", "1"}]}], " ", "||", " ", 
       RowBox[{"j", "\[Equal]", "M"}], " ", "||", " ", 
       RowBox[{
        RowBox[{"se", "[", 
         RowBox[{"[", 
          RowBox[{"i", "+", "2"}], "]"}], "]"}], "\[Equal]", "15"}]}], ",", 
      "False", ",", " ", "True"}], "]"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"thetaSeqAntiHB", "[", 
     RowBox[{"i_", ",", "j_", ",", "k_"}], "]"}], ":=", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"iAP", "[", 
        RowBox[{"i", ",", "j"}], "]"}], "\[Equal]", "True"}], ",", 
      RowBox[{"0.5", "*", 
       RowBox[{"antiHB", "[", 
        RowBox[{"[", 
         RowBox[{"k", ",", 
          RowBox[{"se", "[", 
           RowBox[{"[", "i", "]"}], "]"}], ",", 
          RowBox[{"se", "[", 
           RowBox[{"[", "j", "]"}], "]"}]}], "]"}], "]"}]}], ",", "0.0"}], 
     "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"thetaSeqAntiNHB", "[", 
     RowBox[{"i_", ",", "j_", ",", "k_"}], "]"}], ":=", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"iAP", "[", 
        RowBox[{"i", ",", "j"}], "]"}], "\[Equal]", "True"}], ",", 
      RowBox[{"0.25", "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"antiNHB", "[", 
          RowBox[{"[", 
           RowBox[{"k", ",", 
            RowBox[{"se", "[", 
             RowBox[{"[", 
              RowBox[{"i", "+", "1"}], "]"}], "]"}], ",", 
            RowBox[{"se", "[", 
             RowBox[{"[", 
              RowBox[{"j", "-", "1"}], "]"}], "]"}]}], "]"}], "]"}], "+", 
         "\[IndentingNewLine]", 
         RowBox[{"antiNHB", "[", 
          RowBox[{"[", 
           RowBox[{"k", ",", 
            RowBox[{"se", "[", 
             RowBox[{"[", 
              RowBox[{"i", "-", "1"}], "]"}], "]"}], ",", 
            RowBox[{"se", "[", 
             RowBox[{"[", 
              RowBox[{"j", "+", "1"}], "]"}], "]"}]}], "]"}], "]"}]}], 
        ")"}]}], ",", "0.0"}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"thetaSeqParaHB", "[", 
     RowBox[{"i_", ",", "j_", ",", "k_"}], "]"}], ":=", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"iP", "[", 
       RowBox[{"i", ",", "j"}], "]"}], ",", 
      RowBox[{"paraHB", "[", 
       RowBox[{"[", 
        RowBox[{"k", ",", 
         RowBox[{"se", "[", 
          RowBox[{"[", 
           RowBox[{"i", "+", "1"}], "]"}], "]"}], ",", 
         RowBox[{"se", "[", 
          RowBox[{"[", "j", "]"}], "]"}]}], "]"}], "]"}], ",", "0.0"}], 
     "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"\[Lambda]1", "[", 
      RowBox[{"i_", ",", "j_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Abs", "[", 
           RowBox[{"j", "-", "i"}], "]"}], "<", "5"}], ",", 
         RowBox[{"-", 
          RowBox[{"hbscl", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ",", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Abs", "[", 
             RowBox[{"j", "-", "i"}], "]"}], "<", "20"}], ",", 
           RowBox[{"-", 
            RowBox[{"hbscl", "[", 
             RowBox[{"[", "3", "]"}], "]"}]}], ",", 
           RowBox[{"-", 
            RowBox[{"hbscl", "[", 
             RowBox[{"[", "7", "]"}], "]"}]}]}], "]"}]}], "]"}], 
       "\[IndentingNewLine]", 
       RowBox[{"\[Lambda]2", "[", 
        RowBox[{"i_", ",", "j_"}], "]"}]}], ":=", 
      RowBox[{
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Abs", "[", 
            RowBox[{"j", "-", "i"}], "]"}], "<", "5"}], ",", 
          RowBox[{"-", 
           RowBox[{"hbscl", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], ",", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Abs", "[", 
              RowBox[{"j", "-", "i"}], "]"}], "<", "20"}], ",", 
            RowBox[{"-", 
             RowBox[{"hbscl", "[", 
              RowBox[{"[", "4", "]"}], "]"}]}], ",", 
            RowBox[{"-", 
             RowBox[{"hbscl", "[", 
              RowBox[{"[", "8", "]"}], "]"}]}]}], "]"}]}], "]"}], 
        "\[IndentingNewLine]", 
        RowBox[{"\[Lambda]3", "[", 
         RowBox[{"i_", ",", "j_"}], "]"}]}], ":=", 
       RowBox[{
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Abs", "[", 
             RowBox[{"j", "-", "i"}], "]"}], "<", "5"}], ",", "0.0", ",", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Abs", "[", 
               RowBox[{"j", "-", "i"}], "]"}], "<", "20"}], ",", 
             RowBox[{
              RowBox[{"-", 
               RowBox[{"hbscl", "[", 
                RowBox[{"[", "5", "]"}], "]"}]}], "-", 
              RowBox[{
               RowBox[{"hbscl", "[", 
                RowBox[{"[", "11", "]"}], "]"}], 
               RowBox[{"thetaSeqAntiHB", "[", 
                RowBox[{"i", ",", "j", ",", "1"}], "]"}]}], "-", 
              RowBox[{
               RowBox[{"hbscl", "[", 
                RowBox[{"[", "12", "]"}], "]"}], 
               RowBox[{"thetaSeqAntiNHB", "[", 
                RowBox[{"i", ",", "j", ",", "1"}], "]"}]}], "-", 
              RowBox[{
               RowBox[{"hbscl", "[", 
                RowBox[{"[", "16", "]"}], "]"}], 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"antiOne", "[", 
                  RowBox[{"[", 
                   RowBox[{"se", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], "+", 
                 RowBox[{"antiOne", "[", 
                  RowBox[{"[", 
                   RowBox[{"se", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "]"}], "]"}]}], ")"}]}]}],
              ",", 
             RowBox[{
              RowBox[{"-", 
               RowBox[{"hbscl", "[", 
                RowBox[{"[", "9", "]"}], "]"}]}], "-", 
              RowBox[{
               RowBox[{"hbscl", "[", 
                RowBox[{"[", "13", "]"}], "]"}], 
               RowBox[{"thetaSeqAntiHB", "[", 
                RowBox[{"i", ",", "j", ",", "2"}], "]"}]}], "-", 
              RowBox[{
               RowBox[{"hbscl", "[", 
                RowBox[{"[", "14", "]"}], "]"}], 
               RowBox[{"thetaSeqAntiNHB", "[", 
                RowBox[{"i", ",", "j", ",", "2"}], "]"}]}], "-", 
              RowBox[{
               RowBox[{"hbscl", "[", 
                RowBox[{"[", "16", "]"}], "]"}], 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"antiOne", "[", 
                  RowBox[{"[", 
                   RowBox[{"se", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], "+", 
                 RowBox[{"antiOne", "[", 
                  RowBox[{"[", 
                   RowBox[{"se", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "]"}], "]"}]}], 
                ")"}]}]}]}], "]"}]}], "]"}], "\[IndentingNewLine]", 
         RowBox[{"\[Lambda]4", "[", 
          RowBox[{"i_", ",", "j_"}], "]"}]}], ":=", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Abs", "[", 
            RowBox[{"j", "-", "i"}], "]"}], "<", "5"}], ",", "0.0", ",", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Abs", "[", 
              RowBox[{"j", "-", "i"}], "]"}], "<", "20"}], ",", 
            RowBox[{"-", 
             RowBox[{"hbscl", "[", 
              RowBox[{"[", "6", "]"}], "]"}]}], ",", 
            RowBox[{
             RowBox[{"-", 
              RowBox[{"hbscl", "[", 
               RowBox[{"[", "10", "]"}], "]"}]}], "-", 
             RowBox[{
              RowBox[{"hbscl", "[", 
               RowBox[{"[", "15", "]"}], "]"}], 
              RowBox[{"thetaSeqParaHB", "[", 
               RowBox[{"i", ",", "j", ",", "2"}], "]"}]}], "-", 
             RowBox[{
              RowBox[{"hbscl", "[", 
               RowBox[{"[", "17", "]"}], "]"}], 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"paraOne", "[", 
                 RowBox[{"[", 
                  RowBox[{"se", "[", 
                   RowBox[{"[", 
                    RowBox[{"i", "+", "1"}], "]"}], "]"}], "]"}], "]"}], "+", 
                
                RowBox[{"paraOne", "[", 
                 RowBox[{"[", 
                  RowBox[{"se", "[", 
                   RowBox[{"[", "j", "]"}], "]"}], "]"}], "]"}]}], 
               ")"}]}]}]}], "]"}]}], "]"}]}]}]}]}], "*)"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Lambda]1", "[", 
     RowBox[{"i_", ",", "j_"}], "]"}], ":=", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Abs", "[", 
        RowBox[{"j", "-", "i"}], "]"}], "<", "4"}], ",", 
      RowBox[{"-", 
       RowBox[{"hbscl", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ",", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Abs", "[", 
          RowBox[{"j", "-", "i"}], "]"}], "<", "18"}], ",", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"ssweight6", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "\[Equal]", "1.0"}], " ", "&&", 
           " ", 
           RowBox[{
            RowBox[{"ssweight6", "[", 
             RowBox[{"[", "j", "]"}], "]"}], "\[Equal]", "1.0"}]}], ",", 
          RowBox[{"-", 
           RowBox[{"hbscl", "[", 
            RowBox[{"[", 
             RowBox[{"2", ",", "1"}], "]"}], "]"}]}], ",", "0.0"}], "]"}], 
        ",", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Abs", "[", 
            RowBox[{"j", "-", "i"}], "]"}], "<", "45"}], ",", 
          RowBox[{"-", 
           RowBox[{"hbscl", "[", 
            RowBox[{"[", 
             RowBox[{"3", ",", "1"}], "]"}], "]"}]}], ",", 
          RowBox[{"-", 
           RowBox[{"hbscl", "[", 
            RowBox[{"[", 
             RowBox[{"4", ",", "1"}], "]"}], "]"}]}]}], "]"}]}], "]"}]}], 
     "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Lambda]2", "[", 
     RowBox[{"i_", ",", "j_"}], "]"}], ":=", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Abs", "[", 
        RowBox[{"j", "-", "i"}], "]"}], "<", "4"}], ",", 
      RowBox[{"-", 
       RowBox[{"hbscl", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "2"}], "]"}], "]"}]}], ",", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Abs", "[", 
          RowBox[{"j", "-", "i"}], "]"}], "<", "18"}], ",", 
        RowBox[{"-", 
         RowBox[{"hbscl", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "2"}], "]"}], "]"}]}], ",", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Abs", "[", 
            RowBox[{"j", "-", "i"}], "]"}], "<", "45"}], ",", 
          RowBox[{"-", 
           RowBox[{"hbscl", "[", 
            RowBox[{"[", 
             RowBox[{"3", ",", "2"}], "]"}], "]"}]}], ",", 
          RowBox[{"-", 
           RowBox[{"hbscl", "[", 
            RowBox[{"[", 
             RowBox[{"4", ",", "2"}], "]"}], "]"}]}]}], "]"}]}], "]"}]}], 
     "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Lambda]3", "[", 
     RowBox[{"i_", ",", "j_"}], "]"}], ":=", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Abs", "[", 
        RowBox[{"j", "-", "i"}], "]"}], "<", "4"}], ",", "0.0", ",", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Abs", "[", 
          RowBox[{"j", "-", "i"}], "]"}], "<", "18"}], ",", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"ssweight6", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "\[Equal]", "1.0"}], " ", "&&", 
           " ", 
           RowBox[{
            RowBox[{"ssweight6", "[", 
             RowBox[{"[", "j", "]"}], "]"}], "\[Equal]", "1.0"}]}], ",", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"hbscl", "[", 
             RowBox[{"[", 
              RowBox[{"2", ",", "3"}], "]"}], "]"}]}], "-", 
           RowBox[{
            RowBox[{"hbscl", "[", 
             RowBox[{"[", 
              RowBox[{"2", ",", "4"}], "]"}], "]"}], 
            RowBox[{"thetaSeqAntiHB", "[", 
             RowBox[{"i", ",", "j", ",", "1"}], "]"}]}], "-", 
           RowBox[{
            RowBox[{"hbscl", "[", 
             RowBox[{"[", 
              RowBox[{"2", ",", "5"}], "]"}], "]"}], 
            RowBox[{"thetaSeqAntiNHB", "[", 
             RowBox[{"i", ",", "j", ",", "1"}], "]"}]}], "-", 
           RowBox[{
            RowBox[{"hbscl", "[", 
             RowBox[{"[", 
              RowBox[{"2", ",", "6"}], "]"}], "]"}], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"antiOne", "[", 
               RowBox[{"[", 
                RowBox[{"se", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], "+", 
              RowBox[{"antiOne", "[", 
               RowBox[{"[", 
                RowBox[{"se", "[", 
                 RowBox[{"[", "j", "]"}], "]"}], "]"}], "]"}]}], ")"}]}]}], 
          ",", "0.0"}], "]"}], ",", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Abs", "[", 
            RowBox[{"j", "-", "i"}], "]"}], "<", "45"}], ",", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"hbscl", "[", 
             RowBox[{"[", 
              RowBox[{"3", ",", "3"}], "]"}], "]"}]}], "-", 
           RowBox[{
            RowBox[{"hbscl", "[", 
             RowBox[{"[", 
              RowBox[{"3", ",", "4"}], "]"}], "]"}], 
            RowBox[{"thetaSeqAntiHB", "[", 
             RowBox[{"i", ",", "j", ",", "2"}], "]"}]}], "-", 
           RowBox[{
            RowBox[{"hbscl", "[", 
             RowBox[{"[", 
              RowBox[{"3", ",", "5"}], "]"}], "]"}], 
            RowBox[{"thetaSeqAntiNHB", "[", 
             RowBox[{"i", ",", "j", ",", "2"}], "]"}]}], "-", 
           RowBox[{
            RowBox[{"hbscl", "[", 
             RowBox[{"[", 
              RowBox[{"3", ",", "6"}], "]"}], "]"}], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"antiOne", "[", 
               RowBox[{"[", 
                RowBox[{"se", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], "+", 
              RowBox[{"antiOne", "[", 
               RowBox[{"[", 
                RowBox[{"se", "[", 
                 RowBox[{"[", "j", "]"}], "]"}], "]"}], "]"}]}], ")"}]}]}], 
          ",", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"hbscl", "[", 
             RowBox[{"[", 
              RowBox[{"4", ",", "3"}], "]"}], "]"}]}], "-", 
           RowBox[{
            RowBox[{"hbscl", "[", 
             RowBox[{"[", 
              RowBox[{"4", ",", "4"}], "]"}], "]"}], 
            RowBox[{"thetaSeqAntiHB", "[", 
             RowBox[{"i", ",", "j", ",", "2"}], "]"}]}], "-", 
           RowBox[{
            RowBox[{"hbscl", "[", 
             RowBox[{"[", 
              RowBox[{"4", ",", "5"}], "]"}], "]"}], 
            RowBox[{"thetaSeqAntiNHB", "[", 
             RowBox[{"i", ",", "j", ",", "2"}], "]"}]}], "-", 
           RowBox[{
            RowBox[{"hbscl", "[", 
             RowBox[{"[", 
              RowBox[{"4", ",", "6"}], "]"}], "]"}], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"antiOne", "[", 
               RowBox[{"[", 
                RowBox[{"se", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], "+", 
              RowBox[{"antiOne", "[", 
               RowBox[{"[", 
                RowBox[{"se", "[", 
                 RowBox[{"[", "j", "]"}], "]"}], "]"}], "]"}]}], ")"}]}]}]}], 
         "]"}]}], "]"}]}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Lambda]4", "[", 
     RowBox[{"i_", ",", "j_"}], "]"}], ":=", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Abs", "[", 
        RowBox[{"j", "-", "i"}], "]"}], "<", "4"}], ",", "0.0", ",", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Abs", "[", 
          RowBox[{"j", "-", "i"}], "]"}], "<", "18"}], ",", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"ssweight6", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "\[Equal]", "1.0"}], " ", "&&", 
           " ", 
           RowBox[{
            RowBox[{"ssweight6", "[", 
             RowBox[{"[", "j", "]"}], "]"}], "\[Equal]", "1.0"}]}], ",", 
          RowBox[{"-", 
           RowBox[{"hbscl", "[", 
            RowBox[{"[", 
             RowBox[{"2", ",", "7"}], "]"}], "]"}]}], ",", "0.0"}], "]"}], 
        ",", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Abs", "[", 
            RowBox[{"j", "-", "i"}], "]"}], "<", "45"}], ",", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"hbscl", "[", 
             RowBox[{"[", 
              RowBox[{"3", ",", "7"}], "]"}], "]"}]}], "-", 
           RowBox[{
            RowBox[{"hbscl", "[", 
             RowBox[{"[", 
              RowBox[{"3", ",", "8"}], "]"}], "]"}], 
            RowBox[{"thetaSeqParaHB", "[", 
             RowBox[{"i", ",", "j", ",", "2"}], "]"}]}], "-", 
           RowBox[{
            RowBox[{"hbscl", "[", 
             RowBox[{"[", 
              RowBox[{"3", ",", "9"}], "]"}], "]"}], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"paraOne", "[", 
               RowBox[{"[", 
                RowBox[{"se", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", "+", "1"}], "]"}], "]"}], "]"}], "]"}], "+", 
              RowBox[{"paraOne", "[", 
               RowBox[{"[", 
                RowBox[{"se", "[", 
                 RowBox[{"[", "j", "]"}], "]"}], "]"}], "]"}]}], ")"}]}]}], 
          ",", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"hbscl", "[", 
             RowBox[{"[", 
              RowBox[{"4", ",", "7"}], "]"}], "]"}]}], "-", 
           RowBox[{
            RowBox[{"hbscl", "[", 
             RowBox[{"[", 
              RowBox[{"4", ",", "8"}], "]"}], "]"}], 
            RowBox[{"thetaSeqParaHB", "[", 
             RowBox[{"i", ",", "j", ",", "2"}], "]"}]}], "-", 
           RowBox[{
            RowBox[{"hbscl", "[", 
             RowBox[{"[", 
              RowBox[{"4", ",", "9"}], "]"}], "]"}], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"paraOne", "[", 
               RowBox[{"[", 
                RowBox[{"se", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", "+", "1"}], "]"}], "]"}], "]"}], "]"}], "+", 
              RowBox[{"paraOne", "[", 
               RowBox[{"[", 
                RowBox[{"se", "[", 
                 RowBox[{"[", "j", "]"}], "]"}], "]"}], "]"}]}], ")"}]}]}]}], 
         "]"}]}], "]"}]}], "]"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"rNO", "[", 
     RowBox[{"k_", ",", "i_", ",", "j_"}], "]"}], ":=", 
    RowBox[{"Switch", "[", 
     RowBox[{"k", ",", "1", ",", 
      RowBox[{"MyNorm", "[", 
       RowBox[{
        SubscriptBox["r", 
         RowBox[{"O", ",", "i"}]], "-", 
        SubscriptBox["r", 
         RowBox[{"N", ",", "j"}]]}], "]"}], ",", "2", ",", 
      RowBox[{"MyNorm", "[", 
       RowBox[{
        SubscriptBox["r", 
         RowBox[{"O", ",", "i"}]], "-", 
        SubscriptBox["r", 
         RowBox[{"N", ",", 
          RowBox[{"j", "+", "1"}]}]]}], "]"}], ",", "3", ",", 
      RowBox[{"MyNorm", "[", 
       RowBox[{
        SubscriptBox["r", 
         RowBox[{"O", ",", "j"}]], "-", 
        SubscriptBox["r", 
         RowBox[{"N", ",", "i"}]]}], "]"}], ",", "4", ",", 
      RowBox[{"MyNorm", "[", 
       RowBox[{
        SubscriptBox["r", 
         RowBox[{"O", ",", "j"}]], "-", 
        SubscriptBox["r", 
         RowBox[{"N", ",", 
          RowBox[{"i", "+", "2"}]}]]}], "]"}]}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"rHO", "[", 
     RowBox[{"k_", ",", "i_", ",", "j_"}], "]"}], ":=", 
    RowBox[{"Switch", "[", 
     RowBox[{"k", ",", "1", ",", 
      RowBox[{"MyNorm", "[", 
       RowBox[{
        SubscriptBox["r", 
         RowBox[{"O", ",", "i"}]], "-", 
        SubscriptBox["r", 
         RowBox[{"H", ",", "j"}]]}], "]"}], ",", "2", ",", 
      RowBox[{"MyNorm", "[", 
       RowBox[{
        SubscriptBox["r", 
         RowBox[{"O", ",", "i"}]], "-", 
        SubscriptBox["r", 
         RowBox[{"H", ",", 
          RowBox[{"j", "+", "1"}]}]]}], "]"}], ",", "3", ",", 
      RowBox[{"MyNorm", "[", 
       RowBox[{
        SubscriptBox["r", 
         RowBox[{"O", ",", "j"}]], "-", 
        SubscriptBox["r", 
         RowBox[{"H", ",", "i"}]]}], "]"}], ",", "4", ",", 
      RowBox[{"MyNorm", "[", 
       RowBox[{
        SubscriptBox["r", 
         RowBox[{"O", ",", "j"}]], "-", 
        SubscriptBox["r", 
         RowBox[{"H", ",", 
          RowBox[{"i", "+", "2"}]}]]}], "]"}]}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Delta]", "[", 
     RowBox[{"k_", ",", "i_", ",", "j_"}], "]"}], ":=", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"k", "\[Equal]", "2"}], " ", "&&", "  ", 
       RowBox[{
        RowBox[{"iRepulsive", "[", 
         RowBox[{"i", ",", "j"}], "]"}], "\[Equal]", "False"}]}], ",", "0", 
      ",", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"k", "\[Equal]", "3"}], " ", "&&", " ", 
         RowBox[{
          RowBox[{"iAP", "[", 
           RowBox[{"i", ",", "j"}], "]"}], "\[Equal]", "False"}]}], ",", "0", 
        ",", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"k", "\[Equal]", "4"}], " ", "&&", " ", 
           RowBox[{
            RowBox[{"iP", "[", 
             RowBox[{"i", ",", "j"}], "]"}], "\[Equal]", "False"}]}], ",", 
          "0", ",", "1"}], "]"}]}], "]"}]}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Theta]", "[", 
     RowBox[{"k_", ",", "i_", ",", "j_"}], "]"}], ":=", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Delta]", "[", 
        RowBox[{"k", ",", "i", ",", "j"}], "]"}], " ", "\[Equal]", "1"}], ",", 
      RowBox[{"Exp", "[", 
       RowBox[{
        RowBox[{"-", 
         FractionBox[
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{"rNO", "[", 
              RowBox[{"k", ",", "i", ",", "j"}], "]"}], "-", "rNOzero"}], 
            ")"}], "2"], 
          RowBox[{"2.0", " ", 
           SuperscriptBox["\[Sigma]NO", "2"]}]]}], "-", 
        FractionBox[
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"rHO", "[", 
             RowBox[{"k", ",", "i", ",", "j"}], "]"}], "-", "rHOzero"}], 
           ")"}], "2"], 
         RowBox[{"2.0", " ", 
          SuperscriptBox["\[Sigma]HO", "2"]}]]}], "]"}], ",", "0.0"}], 
     "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Nu]1", "[", "i_", "]"}], ":=", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"i", "-", "2"}], ">", "1"}], " ", "&&", " ", 
       RowBox[{
        RowBox[{"i", "+", "2"}], "\[LessEqual]", "M"}]}], " ", ",", 
      RowBox[{"0.5", 
       RowBox[{"(", 
        RowBox[{"1.0", "+", 
         RowBox[{"Tanh", "[", 
          RowBox[{
           RowBox[{"MyNorm", "[", 
            RowBox[{
             SubscriptBox["r", 
              RowBox[{"Ca", ",", 
               RowBox[{"i", "-", "2"}]}]], "-", 
             SubscriptBox["r", 
              RowBox[{"Ca", ",", 
               RowBox[{"i", "+", "2"}]}]]}], "]"}], "-", "dnu"}], "]"}]}], 
        ")"}]}], ",", "1.0"}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Nu]2", "[", "i_", "]"}], ":=", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"i", "-", "2"}], ">", "1"}], " ", "&&", " ", 
       RowBox[{
        RowBox[{"i", "+", "2"}], "\[LessEqual]", "M"}]}], " ", ",", 
      RowBox[{"0.5", 
       RowBox[{"(", 
        RowBox[{"1.0", "+", 
         RowBox[{"Tanh", "[", 
          RowBox[{"pref", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"MyNorm", "[", 
              RowBox[{
               SubscriptBox["r", 
                RowBox[{"Ca", ",", 
                 RowBox[{"i", "-", "2"}]}]], "-", 
               SubscriptBox["r", 
                RowBox[{"Ca", ",", 
                 RowBox[{"i", "+", "2"}]}]]}], "]"}], "-", "dnu"}], ")"}]}], 
          "]"}]}], ")"}]}], ",", "1.0"}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "THIS", " ", "CALCULATES", " ", "THE", " ", "TOTAL", " ", "POTENTIAL", 
     " ", "ENERGY"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"Vdssp", ":=", 
    RowBox[{
     UnderoverscriptBox["\[Sum]", 
      RowBox[{"i", "=", "1"}], 
      RowBox[{"M", "-", "1"}]], 
     RowBox[{
      UnderoverscriptBox["\[Sum]", 
       RowBox[{"j", "=", "2"}], "M"], 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Abs", "[", 
            RowBox[{"j", "-", "i"}], "]"}], "\[LessEqual]", "2"}], " ", "||", 
          " ", 
          RowBox[{
           RowBox[{"se", "[", 
            RowBox[{"[", "j", "]"}], "]"}], "\[Equal]", "15"}], " ", "||", 
          " ", 
          RowBox[{
           RowBox[{"MyNorm", "[", 
            RowBox[{
             SubscriptBox["r", 
              RowBox[{"O", ",", "i"}]], "-", 
             SubscriptBox["r", 
              RowBox[{"N", ",", "j"}]]}], "]"}], ">", "cutoff"}]}], ",", "0", 
         ",", "1"}], "]"}], " ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Abs", "[", 
            RowBox[{"j", "-", "i"}], "]"}], "<", "18"}], " ", "&&", " ", 
          RowBox[{
           RowBox[{"Abs", "[", 
            RowBox[{"j", "-", "i"}], "]"}], "\[GreaterEqual]", "4"}]}], ",", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"\[Lambda]1", "[", 
             RowBox[{"i", ",", "j"}], "]"}], 
            RowBox[{"\[Theta]", "[", 
             RowBox[{"1", ",", "i", ",", "j"}], "]"}]}], "+", 
           RowBox[{
            RowBox[{"\[Lambda]2", "[", 
             RowBox[{"i", ",", "j"}], "]"}], 
            RowBox[{"\[Theta]", "[", 
             RowBox[{"1", ",", "i", ",", "j"}], "]"}], 
            RowBox[{"\[Theta]", "[", 
             RowBox[{"2", ",", "i", ",", "j"}], "]"}]}], "+", 
           RowBox[{
            RowBox[{"\[Lambda]3", "[", 
             RowBox[{"i", ",", "j"}], "]"}], 
            RowBox[{"\[Theta]", "[", 
             RowBox[{"1", ",", "i", ",", "j"}], "]"}], 
            RowBox[{"\[Theta]", "[", 
             RowBox[{"3", ",", "i", ",", "j"}], "]"}]}], "+", 
           RowBox[{
            RowBox[{"\[Lambda]4", "[", 
             RowBox[{"i", ",", "j"}], "]"}], 
            RowBox[{"\[Theta]", "[", 
             RowBox[{"1", ",", "i", ",", "j"}], "]"}], 
            RowBox[{"\[Theta]", "[", 
             RowBox[{"4", ",", "i", ",", "j"}], "]"}]}]}], ")"}], ",", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"\[Lambda]1", "[", 
             RowBox[{"i", ",", "j"}], "]"}], 
            RowBox[{"\[Theta]", "[", 
             RowBox[{"1", ",", "i", ",", "j"}], "]"}], 
            RowBox[{"\[Nu]1", "[", "i", "]"}], 
            RowBox[{"\[Nu]2", "[", "j", "]"}]}], "+", 
           RowBox[{
            RowBox[{"\[Lambda]2", "[", 
             RowBox[{"i", ",", "j"}], "]"}], 
            RowBox[{"\[Theta]", "[", 
             RowBox[{"1", ",", "i", ",", "j"}], "]"}], 
            RowBox[{"\[Theta]", "[", 
             RowBox[{"2", ",", "i", ",", "j"}], "]"}], 
            RowBox[{"\[Nu]1", "[", "i", "]"}], 
            RowBox[{"\[Nu]2", "[", "j", "]"}]}], "+", 
           RowBox[{
            RowBox[{"\[Lambda]3", "[", 
             RowBox[{"i", ",", "j"}], "]"}], 
            RowBox[{"\[Theta]", "[", 
             RowBox[{"1", ",", "i", ",", "j"}], "]"}], 
            RowBox[{"\[Theta]", "[", 
             RowBox[{"3", ",", "i", ",", "j"}], "]"}], 
            RowBox[{"\[Nu]1", "[", "i", "]"}], 
            RowBox[{"\[Nu]2", "[", "j", "]"}]}], "+", 
           RowBox[{
            RowBox[{"\[Lambda]4", "[", 
             RowBox[{"i", ",", "j"}], "]"}], 
            RowBox[{"\[Theta]", "[", 
             RowBox[{"1", ",", "i", ",", "j"}], "]"}], 
            RowBox[{"\[Theta]", "[", 
             RowBox[{"4", ",", "i", ",", "j"}], "]"}], 
            RowBox[{"\[Nu]1", "[", "i", "]"}], 
            RowBox[{"\[Nu]2", "[", "j", "]"}]}]}], ")"}]}], "]"}]}]}]}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "THIS", " ", "CALCULATES", " ", "THE", " ", "POTENTIAL", " ", "ENERGY", 
      " ", "FOR", " ", "A", " ", "PARTICULAR", " ", "PAIR", " ", "OR", " ", 
      "RESIDUES", " ", "I"}], ",", "J"}], " ", "*)"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{"VDSSP", "[", 
     RowBox[{"i_", ",", "j_"}], "]"}], ":=", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"i", "\[Equal]", "M"}], " ", "||", " ", 
       RowBox[{"j", "\[Equal]", "1"}], " ", "||", " ", 
       RowBox[{
        RowBox[{"Abs", "[", 
         RowBox[{"j", "-", "i"}], "]"}], "\[LessEqual]", "2"}], " ", "||", 
       " ", 
       RowBox[{
        RowBox[{"se", "[", 
         RowBox[{"[", "j", "]"}], "]"}], "\[Equal]", "15"}], " ", "||", " ", 
       RowBox[{
        RowBox[{"MyNorm", "[", 
         RowBox[{
          SubscriptBox["r", 
           RowBox[{"O", ",", "i"}]], "-", 
          SubscriptBox["r", 
           RowBox[{"N", ",", "j"}]]}], "]"}], ">", "cutoff"}]}], ",", "0.0", 
      ",", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Abs", "[", 
           RowBox[{"j", "-", "i"}], "]"}], "<", "18"}], " ", "&&", " ", 
         RowBox[{
          RowBox[{"Abs", "[", 
           RowBox[{"j", "-", "i"}], "]"}], "\[GreaterEqual]", "4"}]}], ",", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"\[Lambda]1", "[", 
            RowBox[{"i", ",", "j"}], "]"}], 
           RowBox[{"\[Theta]", "[", 
            RowBox[{"1", ",", "i", ",", "j"}], "]"}]}], "+", 
          RowBox[{
           RowBox[{"\[Lambda]2", "[", 
            RowBox[{"i", ",", "j"}], "]"}], 
           RowBox[{"\[Theta]", "[", 
            RowBox[{"1", ",", "i", ",", "j"}], "]"}], 
           RowBox[{"\[Theta]", "[", 
            RowBox[{"2", ",", "i", ",", "j"}], "]"}]}], "+", 
          RowBox[{
           RowBox[{"\[Lambda]3", "[", 
            RowBox[{"i", ",", "j"}], "]"}], 
           RowBox[{"\[Theta]", "[", 
            RowBox[{"1", ",", "i", ",", "j"}], "]"}], 
           RowBox[{"\[Theta]", "[", 
            RowBox[{"3", ",", "i", ",", "j"}], "]"}]}], "+", 
          RowBox[{
           RowBox[{"\[Lambda]4", "[", 
            RowBox[{"i", ",", "j"}], "]"}], 
           RowBox[{"\[Theta]", "[", 
            RowBox[{"1", ",", "i", ",", "j"}], "]"}], 
           RowBox[{"\[Theta]", "[", 
            RowBox[{"4", ",", "i", ",", "j"}], "]"}]}]}], ")"}], ",", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"\[Lambda]1", "[", 
            RowBox[{"i", ",", "j"}], "]"}], 
           RowBox[{"\[Theta]", "[", 
            RowBox[{"1", ",", "i", ",", "j"}], "]"}], 
           RowBox[{"\[Nu]1", "[", "i", "]"}], 
           RowBox[{"\[Nu]2", "[", "j", "]"}]}], "+", 
          RowBox[{
           RowBox[{"\[Lambda]2", "[", 
            RowBox[{"i", ",", "j"}], "]"}], 
           RowBox[{"\[Theta]", "[", 
            RowBox[{"1", ",", "i", ",", "j"}], "]"}], 
           RowBox[{"\[Theta]", "[", 
            RowBox[{"2", ",", "i", ",", "j"}], "]"}], 
           RowBox[{"\[Nu]1", "[", "i", "]"}], 
           RowBox[{"\[Nu]2", "[", "j", "]"}]}], "+", 
          RowBox[{
           RowBox[{"\[Lambda]3", "[", 
            RowBox[{"i", ",", "j"}], "]"}], 
           RowBox[{"\[Theta]", "[", 
            RowBox[{"1", ",", "i", ",", "j"}], "]"}], 
           RowBox[{"\[Theta]", "[", 
            RowBox[{"3", ",", "i", ",", "j"}], "]"}], 
           RowBox[{"\[Nu]1", "[", "i", "]"}], 
           RowBox[{"\[Nu]2", "[", "j", "]"}]}], "+", 
          RowBox[{
           RowBox[{"\[Lambda]4", "[", 
            RowBox[{"i", ",", "j"}], "]"}], 
           RowBox[{"\[Theta]", "[", 
            RowBox[{"1", ",", "i", ",", "j"}], "]"}], 
           RowBox[{"\[Theta]", "[", 
            RowBox[{"4", ",", "i", ",", "j"}], "]"}], 
           RowBox[{"\[Nu]1", "[", "i", "]"}], 
           RowBox[{"\[Nu]2", "[", "j", "]"}]}]}], ")"}]}], "]"}]}], 
     "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.4688545231987553`*^9, 3.468854591733592*^9}, {
   3.46885469809086*^9, 3.468854712306538*^9}, {3.468854752252572*^9, 
   3.468854888823358*^9}, {3.468854934100111*^9, 3.468854938119452*^9}, {
   3.4688551412646914`*^9, 3.468855392880972*^9}, {3.468855559233973*^9, 
   3.468855559887401*^9}, {3.468855607223339*^9, 3.4688556132112923`*^9}, {
   3.468856005341827*^9, 3.468856019661236*^9}, {3.468856186726363*^9, 
   3.4688561934160547`*^9}, {3.468856275029667*^9, 3.468856325584127*^9}, {
   3.4688563834264107`*^9, 3.4688564010607567`*^9}, {3.468856472039454*^9, 
   3.468856560114645*^9}, {3.468856649460094*^9, 3.468856714871167*^9}, {
   3.468856878141852*^9, 3.46885694397437*^9}, 3.468857067921371*^9, {
   3.468858009915308*^9, 3.468858011729107*^9}, {3.468858041804687*^9, 
   3.468858106570197*^9}, {3.468858164091794*^9, 3.468858164390669*^9}, {
   3.468858195379747*^9, 3.46885832355942*^9}, {3.46885842587939*^9, 
   3.468858544400716*^9}, {3.468858608278529*^9, 3.468858650600499*^9}, {
   3.468858729321307*^9, 3.4688588790179234`*^9}, {3.468858985244705*^9, 
   3.4688590146875277`*^9}, {3.468859079936151*^9, 3.468859085113804*^9}, {
   3.468859116799193*^9, 3.468859136314533*^9}, {3.468859267094181*^9, 
   3.468859335903599*^9}, {3.468859407223928*^9, 3.468859416937151*^9}, {
   3.468859451039817*^9, 3.468859525464444*^9}, {3.468859624182054*^9, 
   3.4688596529330273`*^9}, {3.468859690038817*^9, 3.468859727512344*^9}, {
   3.468859775627851*^9, 3.4688599201589823`*^9}, {3.468860687353223*^9, 
   3.468860698488188*^9}, {3.468860744299596*^9, 3.468860757782031*^9}, {
   3.468861902865514*^9, 3.468861925163712*^9}, {3.468940498807138*^9, 
   3.468940514255422*^9}, {3.468940594671103*^9, 3.468940649034878*^9}, {
   3.468942698120571*^9, 3.4689427091209393`*^9}, {3.4689427681289473`*^9, 
   3.468942791303822*^9}, {3.468942920426601*^9, 3.4689429236360083`*^9}, {
   3.4689432558686743`*^9, 3.468943257263085*^9}, {3.4689447061034307`*^9, 
   3.468944706570022*^9}, {3.470422398922974*^9, 3.4704224291365757`*^9}, {
   3.4704225305752077`*^9, 3.470422532281509*^9}, {3.470668638299728*^9, 
   3.470668639305203*^9}, {3.472904008302815*^9, 3.47290403310181*^9}, {
   3.472904132257702*^9, 3.472904185418413*^9}, {3.472904232331568*^9, 
   3.472904246516877*^9}, {3.472904296173376*^9, 3.472904384387455*^9}, {
   3.4729044458323603`*^9, 3.4729044921841803`*^9}, {3.472904606823674*^9, 
   3.472904635566135*^9}, {3.472904685794245*^9, 3.47290471335958*^9}, {
   3.472904746313723*^9, 3.472904786318532*^9}, {3.472904829328277*^9, 
   3.4729050579230022`*^9}, {3.472905232696363*^9, 3.47290524054075*^9}, {
   3.472905339089567*^9, 3.472905341199419*^9}, {3.472905404353219*^9, 
   3.4729054629688883`*^9}, {3.4729101666063223`*^9, 3.472910189211753*^9}, {
   3.4729103191411953`*^9, 3.4729103680395327`*^9}, {3.472910405257567*^9, 
   3.4729105003996267`*^9}, {3.512321503856079*^9, 3.5123215159614964`*^9}, {
   3.5123215755892477`*^9, 3.512321619082347*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"THIS", " ", "BLOCK", " ", "DEFINES", " ", "THE", " ", "P_AP", " ", 
    RowBox[{"(", 
     RowBox[{"LIQUID", " ", "CRYSTAL"}], ")"}], " ", "POTENTIAL"}], " ", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"iMin", "=", "5"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"iMax", "=", "8"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"iDiff", "=", "4"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"papPref", "=", "7.0"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"papCut", "=", "8.0"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"W", "=", 
     RowBox[{"{", 
      RowBox[{"0.6", ",", "0.6", ",", "0.6"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Nu]", "[", 
     RowBox[{"i_", ",", "j_"}], "]"}], ":=", 
    RowBox[{"0.5", " ", 
     RowBox[{"(", 
      RowBox[{"1", "+", 
       RowBox[{"Tanh", "[", 
        RowBox[{"papPref", 
         RowBox[{"(", 
          RowBox[{"papCut", "-", 
           RowBox[{"MyNorm", "[", 
            RowBox[{
             SubscriptBox["r", 
              RowBox[{"Ca", ",", "j"}]], "-", 
             SubscriptBox["r", 
              RowBox[{"Ca", ",", "i"}]]}], "]"}]}], ")"}]}], "]"}]}], 
      ")"}]}]}], "\[IndentingNewLine]", 
   RowBox[{"VPAP", ":=", 
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       RowBox[{"W", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], 
      RowBox[{
       UnderoverscriptBox["\[Sum]", 
        RowBox[{"i", "=", "1"}], 
        RowBox[{"M", "-", 
         RowBox[{"(", 
          RowBox[{"iMin", "+", 
           RowBox[{"2", "iDiff"}]}], ")"}]}]], 
       RowBox[{
        UnderoverscriptBox["\[Sum]", 
         RowBox[{"j", "=", 
          RowBox[{"i", "+", 
           RowBox[{"(", 
            RowBox[{"iMin", "+", 
             RowBox[{"2", "iDiff"}]}], ")"}]}]}], 
         RowBox[{"Min", "[", 
          RowBox[{
           RowBox[{"i", "+", 
            RowBox[{"(", 
             RowBox[{"iMax", "+", 
              RowBox[{"2", "iDiff"}]}], ")"}]}], ",", "M"}], "]"}]], 
        RowBox[{
         RowBox[{"\[Nu]", "[", 
          RowBox[{"i", ",", "j"}], "]"}], 
         RowBox[{"\[Nu]", "[", 
          RowBox[{
           RowBox[{"i", "+", "iDiff"}], ",", 
           RowBox[{"j", "-", "iDiff"}]}], "]"}]}]}]}]}], "-", 
     RowBox[{
      RowBox[{"W", "[", 
       RowBox[{"[", "2", "]"}], "]"}], 
      RowBox[{
       UnderoverscriptBox["\[Sum]", 
        RowBox[{"i", "=", "1"}], 
        RowBox[{"M", "-", 
         RowBox[{"(", 
          RowBox[{"iMax", "+", 
           RowBox[{"2", "iDiff"}], "+", "1"}], ")"}]}]], 
       RowBox[{
        UnderoverscriptBox["\[Sum]", 
         RowBox[{"j", "=", 
          RowBox[{"i", "+", 
           RowBox[{"(", 
            RowBox[{"iMax", "+", 
             RowBox[{"2", "iDiff"}], "+", "1"}], ")"}]}]}], "M"], 
        RowBox[{
         RowBox[{"\[Nu]", "[", 
          RowBox[{"i", ",", "j"}], "]"}], 
         RowBox[{"\[Nu]", "[", 
          RowBox[{
           RowBox[{"i", "+", "iDiff"}], ",", 
           RowBox[{"j", "-", "iDiff"}]}], "]"}]}]}]}]}], "-", 
     RowBox[{
      RowBox[{"W", "[", 
       RowBox[{"[", "3", "]"}], "]"}], 
      RowBox[{
       UnderoverscriptBox["\[Sum]", 
        RowBox[{"i", "=", "1"}], 
        RowBox[{"M", "-", 
         RowBox[{"(", 
          RowBox[{"iMax", "+", "iDiff", "+", "1"}], ")"}]}]], 
       RowBox[{
        UnderoverscriptBox["\[Sum]", 
         RowBox[{"j", "=", 
          RowBox[{"i", "+", 
           RowBox[{"(", 
            RowBox[{"iMax", "+", "1"}], ")"}]}]}], 
         RowBox[{"M", "-", "iDiff"}]], 
        RowBox[{
         RowBox[{"\[Nu]", "[", 
          RowBox[{"i", ",", "j"}], "]"}], 
         RowBox[{"\[Nu]", "[", 
          RowBox[{
           RowBox[{"i", "+", "iDiff"}], ",", 
           RowBox[{"j", "+", "iDiff"}]}], "]"}]}]}]}]}]}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"VPAPij", "[", 
     RowBox[{"i_", ",", "j_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       RowBox[{"W", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"i", "<=", 
          RowBox[{"M", "-", 
           RowBox[{"(", 
            RowBox[{"iMin", "+", 
             RowBox[{"2", "iDiff"}]}], ")"}]}]}], " ", "&&", " ", 
         RowBox[{"j", ">=", 
          RowBox[{"i", "+", 
           RowBox[{"(", 
            RowBox[{"iMin", "+", 
             RowBox[{"2", "iDiff"}]}], ")"}]}]}], " ", "&&", " ", 
         RowBox[{"j", "<=", 
          RowBox[{"Min", "[", 
           RowBox[{
            RowBox[{"i", "+", 
             RowBox[{"(", 
              RowBox[{"iMax", "+", 
               RowBox[{"2", "iDiff"}]}], ")"}]}], ",", "M"}], "]"}]}]}], ",", 
        
        RowBox[{
         RowBox[{"\[Nu]", "[", 
          RowBox[{"i", ",", "j"}], "]"}], 
         RowBox[{"\[Nu]", "[", 
          RowBox[{
           RowBox[{"i", "+", "iDiff"}], ",", 
           RowBox[{"j", "-", "iDiff"}]}], "]"}]}], ",", "0.0"}], "]"}]}], "-", 
     RowBox[{
      RowBox[{"W", "[", 
       RowBox[{"[", "2", "]"}], "]"}], 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"i", "<=", 
          RowBox[{"M", "-", 
           RowBox[{"(", 
            RowBox[{"iMax", "+", 
             RowBox[{"2", "iDiff"}], "+", "1"}], ")"}]}]}], " ", "&&", " ", 
         RowBox[{"j", ">=", 
          RowBox[{"i", "+", 
           RowBox[{"(", 
            RowBox[{"iMax", "+", 
             RowBox[{"2", "iDiff"}], "+", "1"}], ")"}]}]}], " ", "&&", " ", 
         RowBox[{"j", "\[LessEqual]", "M"}]}], ",", 
        RowBox[{
         RowBox[{"\[Nu]", "[", 
          RowBox[{"i", ",", "j"}], "]"}], 
         RowBox[{"\[Nu]", "[", 
          RowBox[{
           RowBox[{"i", "+", "iDiff"}], ",", 
           RowBox[{"j", "-", "iDiff"}]}], "]"}]}], ",", "0.0"}], "]"}]}], "-", 
     RowBox[{
      RowBox[{"W", "[", 
       RowBox[{"[", "3", "]"}], "]"}], 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"i", "<=", 
          RowBox[{"M", "-", 
           RowBox[{"(", 
            RowBox[{"iMax", "+", "iDiff", "+", "1"}], ")"}]}]}], " ", "&&", 
         " ", 
         RowBox[{"j", ">=", 
          RowBox[{"i", "+", 
           RowBox[{"(", 
            RowBox[{"iMax", "+", "1"}], ")"}]}]}], " ", "&&", " ", 
         RowBox[{"j", "<=", 
          RowBox[{"M", "-", "iDiff"}]}]}], ",", 
        RowBox[{
         RowBox[{"\[Nu]", "[", 
          RowBox[{"i", ",", "j"}], "]"}], 
         RowBox[{"\[Nu]", "[", 
          RowBox[{
           RowBox[{"i", "+", "iDiff"}], ",", 
           RowBox[{"j", "+", "iDiff"}]}], "]"}]}], ",", "0.0"}], 
       "]"}]}]}]}]}]}]], "Input",
 CellChangeTimes->{{3.470511078395874*^9, 3.4705111331393127`*^9}, {
   3.470511254251968*^9, 3.470511286660549*^9}, {3.4705113226215897`*^9, 
   3.470511410840014*^9}, {3.470511464094315*^9, 3.470511503628962*^9}, {
   3.4705116225397778`*^9, 3.470511681362752*^9}, {3.4705866895731163`*^9, 
   3.470586707438596*^9}, {3.470586762704256*^9, 3.470586884984288*^9}, {
   3.470586976761204*^9, 3.4705870756336803`*^9}, {3.470587187843832*^9, 
   3.4705872004254293`*^9}, {3.470665533641921*^9, 3.470665827695216*^9}, {
   3.4724012084561872`*^9, 3.472401209674053*^9}, {3.472410371338832*^9, 
   3.472410421748806*^9}, {3.512321631091229*^9, 3.512321646485825*^9}, {
   3.5123335807047367`*^9, 3.512333584338703*^9}, 3.5123492960506153`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "THIS", " ", "BLOCK", " ", "DEFINES", " ", "THE", " ", "RAMACHANDRAN", " ",
     "POTNETIAL"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"\[Lambda]Rama", "=", "2.0"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"phiw", "=", 
     RowBox[{"{", 
      RowBox[{
      "0.15", ",", "0.25", ",", "0.65", ",", "1.0", ",", "1.0", ",", "1.0"}], 
      "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"psiw", "=", 
     RowBox[{"{", 
      RowBox[{
      "0.65", ",", "0.45", ",", "0.25", ",", "1.0", ",", "1.0", ",", "1.0"}], 
      "}"}]}], ";"}], "\[IndentingNewLine]", " ", 
   RowBox[{
    RowBox[{"w", "=", 
     RowBox[{"{", 
      RowBox[{
      "1.3149", ",", "1.32016", ",", "1.0264", ",", "0.0", ",", "2.0", ",", 
       "2.0"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Sigma", "=", 
     RowBox[{"{", 
      RowBox[{
      "15.398", ",", "49.0521", ",", "49.0954", ",", "0.0", ",", "419.0", ",",
        "15.398"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"phi0", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1.74"}], ",", 
       RowBox[{"-", "1.265"}], ",", "1.041", ",", "0.0", ",", 
       RowBox[{"-", "0.895"}], ",", 
       RowBox[{"-", "2.25"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"psi0", "=", 
     RowBox[{"{", 
      RowBox[{"2.138", ",", 
       RowBox[{"-", "0.318"}], ",", "0.78", ",", "0.0", ",", 
       RowBox[{"-", "0.820"}], ",", "2.16"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"psiwPr", "=", 
     RowBox[{"{", 
      RowBox[{
      "1.0", ",", "0.15", ",", "0.15", ",", "1.0", ",", "2.0", ",", "2.0"}], 
      "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"phiwPr", "=", 
     RowBox[{"{", 
      RowBox[{
      "1.0", ",", "1.0", ",", "1.0", ",", "1.0", ",", "1.0", ",", "1.0"}], 
      "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"wPr", "=", 
     RowBox[{"{", 
      RowBox[{
      "0.0", ",", "2.17", ",", "2.15", ",", "0.0", ",", "0.0", ",", "0.0"}], 
      "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SigmaPr", "=", 
     RowBox[{"{", 
      RowBox[{
      "0.0", ",", "105.52", ",", "109.09", ",", "0.0", ",", "0.0", ",", 
       "0.0"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"phi0Pr", "=", 
     RowBox[{"{", 
      RowBox[{"0.0", ",", 
       RowBox[{"-", "1.153"}], ",", 
       RowBox[{"-", "0.95"}], ",", "0.0", ",", "0.0", ",", "0.0"}], "}"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"psi0Pr", "=", 
     RowBox[{"{", 
      RowBox[{"0.0", ",", "2.4", ",", 
       RowBox[{"-", "0.218"}], ",", "0.0", ",", "0.0", ",", "0.0"}], "}"}]}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"aps", "[", 
     RowBox[{"i_", ",", "j_"}], "]"}], ":=", 
    RowBox[{"Switch", "[", 
     RowBox[{
     "j", ",", "1", ",", "1.0", ",", "2", ",", "1.0", ",", "3", ",", "1.0", 
      ",", "4", ",", "0.0", ",", "5", ",", 
      RowBox[{"ssweight5", "[", 
       RowBox[{"[", "i", "]"}], "]"}], ",", "6", ",", 
      RowBox[{"ssweight6", "[", 
       RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ArcTan2", "[", 
     RowBox[{"y_", ",", "x_"}], "]"}], ":=", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"x", "\[Equal]", "0"}], ",", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"y", ">", "0"}], ",", 
        FractionBox["\[Pi]", "2"], ",", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"y", "<", "0"}], ",", 
          RowBox[{"-", 
           FractionBox["\[Pi]", "2"]}], ",", "\"\<undefine\>\""}], "]"}]}], 
       "]"}], ",", 
      RowBox[{
       RowBox[{"ArcTan", "[", 
        RowBox[{"y", "/", "x"}], "]"}], "+", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"x", "<", "0"}], ",", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"y", "\[GreaterEqual]", "0"}], ",", "\[Pi]", ",", 
           RowBox[{"-", "\[Pi]"}]}], "]"}], ",", "0"}], "]"}]}]}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"angle", "[", 
     RowBox[{"r1_", ",", "r2_", ",", "r3_", ",", "r4_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"c", "=", 
         RowBox[{"r2", "-", "r1"}]}], ",", " ", 
        RowBox[{"b", "=", 
         RowBox[{"r3", "-", "r2"}]}], ",", 
        RowBox[{"a", "=", 
         RowBox[{"r4", "-", "r3"}]}]}], "}"}], ",", 
      RowBox[{"Return", "[", 
       RowBox[{"ArcTan2", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"MyNorm", "[", "b", "]"}], " ", 
          RowBox[{"c", ".", 
           RowBox[{"Cross", "[", 
            RowBox[{"b", ",", "a"}], "]"}]}]}], ",", 
         RowBox[{
          RowBox[{"Cross", "[", 
           RowBox[{"c", ",", "b"}], "]"}], ".", 
          RowBox[{"Cross", "[", 
           RowBox[{"b", ",", "a"}], "]"}]}]}], "]"}], "]"}]}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Phi]", "[", "i_", "]"}], ":=", 
    RowBox[{"angle", "[", 
     RowBox[{
      SubscriptBox["r", 
       RowBox[{"Cp", ",", 
        RowBox[{"i", "-", "1"}]}]], ",", 
      SubscriptBox["r", 
       RowBox[{"N", ",", "i"}]], ",", 
      SubscriptBox["r", 
       RowBox[{"Ca", ",", "i"}]], ",", 
      SubscriptBox["r", 
       RowBox[{"Cp", ",", "i"}]]}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Psi]", "[", "i_", "]"}], ":=", 
    RowBox[{"angle", "[", 
     RowBox[{
      SubscriptBox["r", 
       RowBox[{"N", ",", "i"}]], ",", 
      SubscriptBox["r", 
       RowBox[{"Ca", ",", "i"}]], ",", 
      SubscriptBox["r", 
       RowBox[{"Cp", ",", "i"}]], ",", 
      SubscriptBox["r", 
       RowBox[{"N", ",", 
        RowBox[{"i", "+", "1"}]}]]}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"VRamaI", "[", "i_", "]"}], ":=", 
    RowBox[{
     UnderoverscriptBox["\[Sum]", 
      RowBox[{"j", "=", "1"}], "6"], 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"w", "[", 
          RowBox[{"[", "j", "]"}], "]"}], "\[NotEqual]", "0.0"}], " ", "&&", 
        " ", 
        RowBox[{
         RowBox[{"aps", "[", 
          RowBox[{"i", ",", "j"}], "]"}], "\[NotEqual]", "0.0"}]}], ",", 
       RowBox[{
        RowBox[{"w", "[", 
         RowBox[{"[", "j", "]"}], "]"}], 
        RowBox[{"Exp", "[", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"Sigma", "[", 
            RowBox[{"[", "j", "]"}], "]"}]}], 
          RowBox[{"(", " ", 
           RowBox[{
            RowBox[{
             RowBox[{"phiw", "[", 
              RowBox[{"[", "j", "]"}], "]"}], " ", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Cos", "[", 
                 RowBox[{
                  RowBox[{"\[Phi]", "[", "i", "]"}], "-", 
                  RowBox[{"phi0", "[", 
                   RowBox[{"[", "j", "]"}], "]"}]}], "]"}], "-", "1.0"}], 
               ")"}], "2"]}], "+", 
            RowBox[{
             RowBox[{"psiw", "[", 
              RowBox[{"[", "j", "]"}], "]"}], " ", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Cos", "[", 
                 RowBox[{
                  RowBox[{"\[Psi]", "[", "i", "]"}], "-", 
                  RowBox[{"psi0", "[", 
                   RowBox[{"[", "j", "]"}], "]"}]}], "]"}], "-", "1.0"}], 
               ")"}], "2"]}]}], ")"}]}], "]"}]}], ",", "0.0"}], "]"}]}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"VRamaIPr", "[", "i_", "]"}], ":=", 
    RowBox[{
     UnderoverscriptBox["\[Sum]", 
      RowBox[{"j", "=", "1"}], "6"], 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"wPr", "[", 
          RowBox[{"[", "j", "]"}], "]"}], "\[NotEqual]", "0.0"}], " ", "&&", 
        " ", 
        RowBox[{
         RowBox[{"aps", "[", 
          RowBox[{"i", ",", "j"}], "]"}], "\[NotEqual]", "0.0"}]}], ",", 
       RowBox[{
        RowBox[{"wPr", "[", 
         RowBox[{"[", "j", "]"}], "]"}], 
        RowBox[{"Exp", "[", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"SigmaPr", "[", 
            RowBox[{"[", "j", "]"}], "]"}]}], 
          RowBox[{"(", " ", 
           RowBox[{
            RowBox[{
             RowBox[{"phiwPr", "[", 
              RowBox[{"[", "j", "]"}], "]"}], " ", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Cos", "[", 
                 RowBox[{
                  RowBox[{"\[Phi]", "[", "i", "]"}], "-", 
                  RowBox[{"phi0Pr", "[", 
                   RowBox[{"[", "j", "]"}], "]"}]}], "]"}], "-", "1.0"}], 
               ")"}], "2"]}], "+", 
            RowBox[{
             RowBox[{"psiwPr", "[", 
              RowBox[{"[", "j", "]"}], "]"}], " ", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Cos", "[", 
                 RowBox[{
                  RowBox[{"\[Psi]", "[", "i", "]"}], "-", 
                  RowBox[{"psi0Pr", "[", 
                   RowBox[{"[", "j", "]"}], "]"}]}], "]"}], "-", "1.0"}], 
               ")"}], "2"]}]}], ")"}]}], "]"}]}], ",", "0.0"}], "]"}]}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Vramaij", "[", 
     RowBox[{"i_", ",", "j_"}], "]"}], " ", ":=", " ", 
    RowBox[{
     RowBox[{"-", "\[Lambda]Rama"}], " ", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"se", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "\[Equal]", "8"}], " ", "||", " ", 
        RowBox[{"i", "\[Equal]", "1"}], " ", "||", " ", 
        RowBox[{"i", "\[Equal]", "M"}], " ", "||", " ", 
        RowBox[{
         RowBox[{"aps", "[", 
          RowBox[{"i", ",", "j"}], "]"}], "\[Equal]", "0.0"}]}], ",", "0.0", 
       ",", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"se", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "\[Equal]", "15"}], " ", ",", 
         RowBox[{
          RowBox[{"wPr", "[", 
           RowBox[{"[", "j", "]"}], "]"}], 
          RowBox[{"Exp", "[", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"SigmaPr", "[", 
              RowBox[{"[", "j", "]"}], "]"}]}], 
            RowBox[{"(", " ", 
             RowBox[{
              RowBox[{
               RowBox[{"phiwPr", "[", 
                RowBox[{"[", "j", "]"}], "]"}], " ", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"Cos", "[", 
                   RowBox[{
                    RowBox[{"\[Phi]", "[", "i", "]"}], "-", 
                    RowBox[{"phi0Pr", "[", 
                    RowBox[{"[", "j", "]"}], "]"}]}], "]"}], "-", "1.0"}], 
                 ")"}], "2"]}], "+", 
              RowBox[{
               RowBox[{"psiwPr", "[", 
                RowBox[{"[", "j", "]"}], "]"}], " ", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"Cos", "[", 
                   RowBox[{
                    RowBox[{"\[Psi]", "[", "i", "]"}], "-", 
                    RowBox[{"psi0Pr", "[", 
                    RowBox[{"[", "j", "]"}], "]"}]}], "]"}], "-", "1.0"}], 
                 ")"}], "2"]}]}], ")"}]}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"w", "[", 
           RowBox[{"[", "j", "]"}], "]"}], 
          RowBox[{"Exp", "[", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"Sigma", "[", 
              RowBox[{"[", "j", "]"}], "]"}]}], 
            RowBox[{"(", " ", 
             RowBox[{
              RowBox[{
               RowBox[{"phiw", "[", 
                RowBox[{"[", "j", "]"}], "]"}], " ", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"Cos", "[", 
                   RowBox[{
                    RowBox[{"\[Phi]", "[", "i", "]"}], "-", 
                    RowBox[{"phi0", "[", 
                    RowBox[{"[", "j", "]"}], "]"}]}], "]"}], "-", "1.0"}], 
                 ")"}], "2"]}], "+", 
              RowBox[{
               RowBox[{"psiw", "[", 
                RowBox[{"[", "j", "]"}], "]"}], " ", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"Cos", "[", 
                   RowBox[{
                    RowBox[{"\[Psi]", "[", "i", "]"}], "-", 
                    RowBox[{"psi0", "[", 
                    RowBox[{"[", "j", "]"}], "]"}]}], "]"}], "-", "1.0"}], 
                 ")"}], "2"]}]}], ")"}]}], "]"}]}]}], "]"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"Vrama", " ", ":=", " ", 
    RowBox[{
     RowBox[{"-", "\[Lambda]Rama"}], 
     RowBox[{
      UnderoverscriptBox["\[Sum]", 
       RowBox[{"i", "=", "2"}], 
       RowBox[{"M", "-", "1"}]], 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"se", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "\[Equal]", "15"}], ",", 
        RowBox[{"VRamaIPr", "[", "i", "]"}], ",", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"se", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "\[Equal]", "8"}], ",", "0.0", 
          ",", 
          RowBox[{"VRamaI", "[", "i", "]"}]}], "]"}]}], 
       "]"}]}]}]}]}]}]], "Input",
 CellChangeTimes->CompressedData["
1:eJwdzH8s1AEABfA7dSwdOl3uzNJSW5u27lAtI3Z114y5rtudEDHO5deia3GN
cRRt3W1ohZ1zrLP1y49WpC50rlYznZDIVBzSrk6UNGGn7/v+8fbZ297e7pQc
cZoThUIJIQJVIWY7c9LG047baDsIv9yP9oFDUQxfOHfgvR90L/E5BA9GvAiG
z3Ln+ZDPZUfBn70cEaySZkmhOSAgCdLfxqVB4VpsBpxyKrkAi+hqUln84iXy
v6zlCiztNt6GzYwPTdBbd/IxVKXHkA5SszvJvcGjD75KoAzAdVUK6Urx9Efo
5towAc8LKmZhR637V6jhVTC9CPvlEd7wNz1uH7y6i+oPAzWvOaT/grhwmzlc
AI3bNyKgvihSCEVLJgksHz2eCK3ZCwUwOXq9kvyN96mCPUG5tyCntqgW1tX/
0UFD/mIbbHzz2Qipq/o+mN11xwLtLn9JWdTLw3CS9W4E+slqxuETZyupIpem
ZRHml1Xr4A0l1QAjPURNsCDP0QqdmzsfwuGYtnY4Uc02QaE0cRA6TmhHYJdI
ukDuriuWoNma6YDsM/00NqFL8vIe6LUg8YfdMyYuVB77RNpetxJGduF8NDwq
k0ghV1qcAFuNKjl0DIVmwp5ALwV8+WtLHuRMBpZA+hJfDY3pokpoaS0kNbG+
VUPFNKMGCvQdOhg219sIJaXlazBB7bkBk6OWY70JV9208XBdpi+HA46d1yDL
95QGzqbKK2DOWPdTaGjgP4fOacytGYRi/l46DH8g1tgIGalB9VCilStdp2w8
9VlpIXT3a7vpSWgeGiW9e69lE5MwVqykwblHmyUw1JIlhRmS4CT4Q3VYBiNX
BFZ48ZzFDk/bRcNH9n/n2WZSx+B/GeHo8Q==
  "]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "THIS", " ", "BLOCK", " ", "DEFINES", " ", "THE", " ", "WATER", " ", 
     "POTENTIAL"}], ",", " ", 
    RowBox[{
    "HELIX", " ", "POTENTIAL", " ", "AND", " ", "BURIAL", " ", 
     "POTENTIAL"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"WATER", " ", "POTENTIAL"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"waterkappa", " ", "=", "5.0"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"waterkappasigma", " ", "=", " ", "7.0"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"\[Rho]0", " ", "=", " ", "2.6"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"contactcutoff", " ", "=", " ", "13"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"rmin", "=", 
     RowBox[{"{", 
      RowBox[{"4.5", ",", "6.5"}], "}"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"rmax", "=", 
     RowBox[{"{", 
      RowBox[{"6.5", ",", "9.5"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"A", "=", 
     RowBox[{"ToExpression", "[", 
      RowBox[{"StringSplit", "[", 
       RowBox[{"ReadList", "[", 
        RowBox[{"\"\<gamma.dat\>\"", ",", "String"}], "]"}], "]"}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"gamma", " ", "=", " ", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"A", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"210", "k"}], "+", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"j", "\[GreaterEqual]", "i"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"i", "-", "1"}], ")"}], 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"2", " ", "20"}], " ", "-", "i"}], ")"}], "/", 
               "2"}]}], " ", "+", "j"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"j", "-", "1"}], ")"}], 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"2", " ", "20"}], " ", "-", "j"}], ")"}], "/", 
               "2"}]}], " ", "+", "i"}]}], "]"}]}], "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "0", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "20"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", "20"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"rw", "[", 
     RowBox[{"i_", ",", "j_"}], "]"}], ":=", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"se", "[", 
        RowBox[{"[", "i", "]"}], "]"}], "\[Equal]", "8"}], ",", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"se", "[", 
          RowBox[{"[", "j", "]"}], "]"}], "\[Equal]", "8"}], ",", 
        RowBox[{"MyNorm", "[", 
         RowBox[{
          SubscriptBox["r", 
           RowBox[{"Ca", ",", "i"}]], "-", 
          SubscriptBox["r", 
           RowBox[{"Ca", ",", "j"}]]}], "]"}], ",", 
        RowBox[{"MyNorm", "[", 
         RowBox[{
          SubscriptBox["r", 
           RowBox[{"Ca", ",", "i"}]], "-", 
          SubscriptBox["r", 
           RowBox[{"Cb", ",", "j"}]]}], "]"}]}], "]"}], ",", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"se", "[", 
          RowBox[{"[", "j", "]"}], "]"}], "\[Equal]", "8"}], ",", 
        RowBox[{"MyNorm", "[", 
         RowBox[{
          SubscriptBox["r", 
           RowBox[{"Cb", ",", "i"}]], "-", 
          SubscriptBox["r", 
           RowBox[{"Ca", ",", "j"}]]}], "]"}], ",", 
        RowBox[{"MyNorm", "[", 
         RowBox[{
          SubscriptBox["r", 
           RowBox[{"Cb", ",", "i"}]], "-", 
          SubscriptBox["r", 
           RowBox[{"Cb", ",", "j"}]]}], "]"}]}], "]"}]}], "]"}]}], " ", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"theta", "[", 
     RowBox[{"i_", ",", "j_", ",", "iwell_"}], "]"}], ":=", 
    RowBox[{"0.25", " ", 
     RowBox[{"(", 
      RowBox[{"1", "+", 
       RowBox[{"Tanh", "[", 
        RowBox[{"waterkappa", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"rw", "[", 
            RowBox[{"i", ",", "j"}], "]"}], "-", 
           RowBox[{"rmin", "[", 
            RowBox[{"[", "iwell", "]"}], "]"}]}], ")"}]}], "]"}]}], ")"}], 
     RowBox[{"(", 
      RowBox[{"1", "+", 
       RowBox[{"Tanh", "[", 
        RowBox[{"waterkappa", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"rmax", "[", 
            RowBox[{"[", "iwell", "]"}], "]"}], "-", 
           RowBox[{"rw", "[", 
            RowBox[{"i", ",", "j"}], "]"}]}], ")"}]}], "]"}]}], ")"}]}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Rho]", "[", "i_", "]"}], ":=", 
    RowBox[{
     UnderoverscriptBox["\[Sum]", 
      RowBox[{"j", "=", "1"}], "M"], 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Abs", "[", 
         RowBox[{"i", "-", "j"}], "]"}], ">", "1"}], ",", 
       RowBox[{"theta", "[", 
        RowBox[{"i", ",", "j", ",", "1"}], "]"}], ",", "0"}], "]"}]}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"sigma", "[", 
     RowBox[{"i_", ",", "j_"}], "]"}], ":=", 
    RowBox[{"0.25", " ", 
     RowBox[{"(", 
      RowBox[{"1", "-", 
       RowBox[{"Tanh", "[", 
        RowBox[{"waterkappasigma", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"\[Rho]", "[", "i", "]"}], "-", "\[Rho]0"}], ")"}]}], 
        "]"}]}], ")"}], 
     RowBox[{"(", 
      RowBox[{"1", "-", 
       RowBox[{"Tanh", "[", 
        RowBox[{"waterkappasigma", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"\[Rho]", "[", "j", "]"}], "-", "\[Rho]0"}], ")"}]}], 
        "]"}]}], ")"}]}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Vwater", ":=", 
     RowBox[{"-", 
      RowBox[{
       UnderoverscriptBox["\[Sum]", 
        RowBox[{"i", "=", "1"}], 
        RowBox[{"M", "-", "contactcutoff"}]], 
       RowBox[{
        UnderoverscriptBox["\[Sum]", 
         RowBox[{"j", "=", 
          RowBox[{"i", "+", "contactcutoff"}]}], "M"], 
        RowBox[{
         RowBox[{"theta", "[", 
          RowBox[{"i", ",", "j", ",", "2"}], "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"gamma", "[", 
             RowBox[{"[", 
              RowBox[{"2", ",", 
               RowBox[{"se", "[", 
                RowBox[{"[", "i", "]"}], "]"}], ",", 
               RowBox[{"se", "[", 
                RowBox[{"[", "j", "]"}], "]"}], ",", "1"}], "]"}], "]"}], " ", 
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{"sigma", "[", 
               RowBox[{"i", ",", "j"}], "]"}]}], ")"}]}], "+", 
           RowBox[{
            RowBox[{"gamma", "[", 
             RowBox[{"[", 
              RowBox[{"2", ",", 
               RowBox[{"se", "[", 
                RowBox[{"[", "i", "]"}], "]"}], ",", 
               RowBox[{"se", "[", 
                RowBox[{"[", "j", "]"}], "]"}], ",", "2"}], "]"}], "]"}], " ", 
            RowBox[{"sigma", "[", 
             RowBox[{"i", ",", "j"}], "]"}]}]}], ")"}]}]}]}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Vwaterij", "[", 
      RowBox[{"i_", ",", "j_"}], "]"}], ":=", 
     RowBox[{"-", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Abs", "[", 
          RowBox[{"i", "-", "j"}], "]"}], "\[GreaterEqual]", 
         "contactcutoff"}], ",", 
        RowBox[{
         RowBox[{"theta", "[", 
          RowBox[{"i", ",", "j", ",", "2"}], "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"gamma", "[", 
             RowBox[{"[", 
              RowBox[{"2", ",", 
               RowBox[{"se", "[", 
                RowBox[{"[", "i", "]"}], "]"}], ",", 
               RowBox[{"se", "[", 
                RowBox[{"[", "j", "]"}], "]"}], ",", "1"}], "]"}], "]"}], " ", 
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{"sigma", "[", 
               RowBox[{"i", ",", "j"}], "]"}]}], ")"}]}], "+", 
           RowBox[{
            RowBox[{"gamma", "[", 
             RowBox[{"[", 
              RowBox[{"2", ",", 
               RowBox[{"se", "[", 
                RowBox[{"[", "i", "]"}], "]"}], ",", 
               RowBox[{"se", "[", 
                RowBox[{"[", "j", "]"}], "]"}], ",", "2"}], "]"}], "]"}], " ", 
            RowBox[{"sigma", "[", 
             RowBox[{"i", ",", "j"}], "]"}]}]}], ")"}]}], ",", "0"}], 
       "]"}]}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"BURIAL", " ", "POTENTIAL"}], " ", "*)"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{"burialkappa", "=", "4.0"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"romin", " ", "=", 
     RowBox[{"{", 
      RowBox[{"0.0", ",", "3.0", ",", "6.0"}], "}"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"romax", " ", "=", 
     RowBox[{"{", 
      RowBox[{"3.0", ",", "6.0", ",", "9.0"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"A", "=", 
     RowBox[{"ReadList", "[", 
      RowBox[{"\"\<burial_gamma.dat\>\"", ",", "Real"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"burialgamma", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"A", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"3", 
           RowBox[{"(", 
            RowBox[{"i", "-", "1"}], ")"}]}], "+", "j"}], "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "20"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", "3"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"S", "[", 
     RowBox[{"i_", ",", "\[Mu]_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"Tanh", "[", 
      RowBox[{"burialkappa", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\[Rho]", "[", "i", "]"}], "-", 
         RowBox[{"romin", "[", 
          RowBox[{"[", "\[Mu]", "]"}], "]"}]}], ")"}]}], "]"}], "+", 
     RowBox[{"Tanh", "[", 
      RowBox[{"burialkappa", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"romax", "[", 
          RowBox[{"[", "\[Mu]", "]"}], "]"}], "-", 
         RowBox[{"\[Rho]", "[", "i", "]"}]}], ")"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"Vburial", ":=", 
    RowBox[{
     RowBox[{"-", "0.5"}], 
     RowBox[{
      UnderoverscriptBox["\[Sum]", 
       RowBox[{"i", "=", "1"}], "M"], 
      RowBox[{
       UnderoverscriptBox["\[Sum]", 
        RowBox[{"\[Mu]", "=", "1"}], "3"], " ", 
       RowBox[{
        RowBox[{"burialgamma", "[", 
         RowBox[{"[", 
          RowBox[{
           RowBox[{"se", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", "\[Mu]"}], "]"}], "]"}], 
        RowBox[{"S", "[", 
         RowBox[{"i", ",", "\[Mu]"}], "]"}]}]}]}]}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"HELIX", " ", "POTENTIAL"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Lambda]Helix", "=", "1.5"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"helixgammap", "=", "2.0"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"helixgammaw", "=", 
     RowBox[{"-", "1.0"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"helixkappa", "=", "7.0"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"helixkappasigma", "=", "7.0"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"helixtreshold", "=", "3.0"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"helixidiff", "=", "4"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"helixcutoff", "=", "15.0"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"h4prob", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "0.77"}], ",", 
       RowBox[{"-", "0.68"}], ",", 
       RowBox[{"-", "0.07"}], ",", 
       RowBox[{"-", "0.15"}], ",", 
       RowBox[{"-", "0.23"}], ",", 
       RowBox[{"-", "0.33"}], ",", 
       RowBox[{"-", "0.27"}], ",", " ", "0.0", ",", 
       RowBox[{"-", "0.06"}], ",", 
       RowBox[{"-", "0.23"}], ",", 
       RowBox[{"-", "0.62"}], ",", 
       RowBox[{"-", "0.65"}], ",", 
       RowBox[{"-", "0.50"}], ",", 
       RowBox[{"-", "0.41"}], ",", " ", "3.0", ",", 
       RowBox[{"-", "0.35"}], ",", 
       RowBox[{"-", "0.11"}], ",", 
       RowBox[{"-", "0.45"}], ",", 
       RowBox[{"-", "0.17"}], ",", 
       RowBox[{"-", "0.14"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Theta]pair", "[", 
     RowBox[{"i_", ",", "j_"}], "]"}], ":=", 
    RowBox[{"Exp", "[", 
     RowBox[{
      RowBox[{"-", 
       FractionBox[
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"MyNorm", "[", 
            RowBox[{
             SubscriptBox["r", 
              RowBox[{"O", ",", "i"}]], "-", 
             SubscriptBox["r", 
              RowBox[{"N", ",", "j"}]]}], "]"}], "-", "rNOzero"}], ")"}], 
         "2"], 
        RowBox[{"2.0", " ", 
         SuperscriptBox["\[Sigma]NO", "2"]}]]}], "-", 
      FractionBox[
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"MyNorm", "[", 
           RowBox[{
            SubscriptBox["r", 
             RowBox[{"O", ",", "i"}]], "-", 
            SubscriptBox["r", 
             RowBox[{"H", ",", "j"}]]}], "]"}], "-", "rHOzero"}], ")"}], "2"], 
       RowBox[{"2.0", " ", 
        SuperscriptBox["\[Sigma]HO", "2"]}]]}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"thetaHelix", "[", 
     RowBox[{"i_", ",", "j_", ",", "iwell_"}], "]"}], ":=", 
    RowBox[{"0.25", " ", 
     RowBox[{"(", 
      RowBox[{"1", "+", 
       RowBox[{"Tanh", "[", 
        RowBox[{"helixkappa", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"rw", "[", 
            RowBox[{"i", ",", "j"}], "]"}], "-", 
           RowBox[{"rmin", "[", 
            RowBox[{"[", "iwell", "]"}], "]"}]}], ")"}]}], "]"}]}], ")"}], 
     RowBox[{"(", 
      RowBox[{"1", "+", 
       RowBox[{"Tanh", "[", 
        RowBox[{"helixkappa", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"rmax", "[", 
            RowBox[{"[", "iwell", "]"}], "]"}], "-", 
           RowBox[{"rw", "[", 
            RowBox[{"i", ",", "j"}], "]"}]}], ")"}]}], "]"}]}], ")"}]}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Rho]Helix", "[", "i_", "]"}], ":=", 
    RowBox[{
     UnderoverscriptBox["\[Sum]", 
      RowBox[{"j", "=", "1"}], "M"], 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Abs", "[", 
         RowBox[{"i", "-", "j"}], "]"}], ">", "1"}], ",", 
       RowBox[{"thetaHelix", "[", 
        RowBox[{"i", ",", "j", ",", "1"}], "]"}], ",", "0"}], "]"}]}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"sigmaHelix", "[", 
     RowBox[{"i_", ",", "j_"}], "]"}], ":=", 
    RowBox[{"0.25", " ", 
     RowBox[{"(", 
      RowBox[{"1", "-", 
       RowBox[{"Tanh", "[", 
        RowBox[{"helixkappasigma", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"\[Rho]Helix", "[", "i", "]"}], "-", "helixtreshold"}], 
          ")"}]}], "]"}]}], ")"}], 
     RowBox[{"(", 
      RowBox[{"1", "-", 
       RowBox[{"Tanh", "[", 
        RowBox[{"helixkappasigma", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"\[Rho]Helix", "[", "j", "]"}], "-", "helixtreshold"}], 
          ")"}]}], "]"}]}], ")"}]}]}], "\[IndentingNewLine]", 
   RowBox[{"VHelix", ":=", 
    RowBox[{"-", 
     RowBox[{
      UnderoverscriptBox["\[Sum]", 
       RowBox[{"i", "=", "1"}], 
       RowBox[{"M", "-", "helixidiff", "-", "1"}]], 
      RowBox[{"\[Lambda]Helix", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"helixgammap", " ", 
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"sigmaHelix", "[", 
             RowBox[{"i", ",", 
              RowBox[{"i", "+", "4"}]}], "]"}]}], ")"}]}], "+", " ", 
         RowBox[{"helixgammaw", " ", 
          RowBox[{"sigmaHelix", "[", 
           RowBox[{"i", ",", 
            RowBox[{"i", "+", "4"}]}], "]"}]}]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"h4prob", "[", 
          RowBox[{"[", 
           RowBox[{"se", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], "+", 
         RowBox[{"h4prob", "[", 
          RowBox[{"[", 
           RowBox[{"se", "[", 
            RowBox[{"[", 
             RowBox[{"i", "+", "4"}], "]"}], "]"}], "]"}], "]"}]}], ")"}], 
       " ", 
       RowBox[{"\[Theta]pair", "[", 
        RowBox[{"i", ",", 
         RowBox[{"i", "+", "4"}]}], "]"}]}]}]}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"VHelixi", "[", "i_", "]"}], ":=", 
    RowBox[{"-", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"i", ">", 
        RowBox[{"M", "-", "helixidiff"}]}], ",", "0.0", ",", 
       RowBox[{"\[Lambda]Helix", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"helixgammap", " ", 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"sigmaHelix", "[", 
              RowBox[{"i", ",", 
               RowBox[{"i", "+", "4"}]}], "]"}]}], ")"}]}], "+", " ", 
          RowBox[{"helixgammaw", " ", 
           RowBox[{"sigmaHelix", "[", 
            RowBox[{"i", ",", 
             RowBox[{"i", "+", "4"}]}], "]"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"h4prob", "[", 
           RowBox[{"[", 
            RowBox[{"se", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], "+", 
          RowBox[{"h4prob", "[", 
           RowBox[{"[", 
            RowBox[{"se", "[", 
             RowBox[{"[", 
              RowBox[{"i", "+", "4"}], "]"}], "]"}], "]"}], "]"}]}], ")"}], 
        " ", 
        RowBox[{"\[Theta]pair", "[", 
         RowBox[{"i", ",", 
          RowBox[{"i", "+", "4"}]}], "]"}]}]}], "]"}]}]}]}]}]], "Input",
 CellChangeTimes->{{3.4912367820456*^9, 3.4912368171236*^9}, {
   3.4912369024076*^9, 3.4912369101745996`*^9}, {3.4912369558136*^9, 
   3.4912370787656*^9}, {3.4912371149556*^9, 3.4912371272746*^9}, {
   3.4912387389346*^9, 3.4912387450866003`*^9}, {3.4912387930916*^9, 
   3.4912388112595997`*^9}, {3.4912388414736*^9, 3.4912388661916*^9}, {
   3.4912389047506*^9, 3.4912389141336*^9}, {3.4912390996046*^9, 
   3.4912391338176003`*^9}, {3.4912391741436*^9, 3.4912391795186*^9}, {
   3.4912404447326*^9, 3.4912404519666*^9}, {3.4912405329056*^9, 
   3.4912405336176*^9}, {3.4912405806156*^9, 3.4912406427956*^9}, {
   3.4912406728886003`*^9, 3.4912407571126003`*^9}, {3.491403767951*^9, 
   3.49140381875*^9}, {3.491403856148*^9, 3.491403921064*^9}, {
   3.4914042334709997`*^9, 3.491404254223*^9}, {3.4914043921029997`*^9, 
   3.491404394158*^9}, {3.4914075806*^9, 3.491407580881*^9}, {
   3.491407747216*^9, 3.4914077838129997`*^9}, {3.491411718149*^9, 
   3.491411733428*^9}, {3.491412204328*^9, 3.491412298362*^9}, {
   3.491412382873*^9, 3.491412487744*^9}, {3.491412532894*^9, 
   3.491412542645*^9}, {3.4914129028570004`*^9, 3.49141296115*^9}, {
   3.491414420347*^9, 3.491414442722*^9}, {3.4914144803599997`*^9, 
   3.491414496704*^9}, {3.4914145513310003`*^9, 3.491414666727*^9}, {
   3.491414700868*^9, 3.491414874782*^9}, {3.491430772488*^9, 
   3.491430778663*^9}, {3.491430818593*^9, 3.491430908502*^9}, {
   3.491430963159*^9, 3.491430968212*^9}, {3.491431055601*^9, 
   3.491431056152*^9}, {3.491431097566*^9, 3.4914312532939997`*^9}, {
   3.491431305645*^9, 3.49143131901*^9}, {3.491431424668*^9, 
   3.4914314427*^9}, {3.491431645451*^9, 3.491431689572*^9}, {
   3.491431729738*^9, 3.4914317581280003`*^9}, {3.4914318069040003`*^9, 
   3.491432018637*^9}, {3.491435150863*^9, 3.491435151727*^9}, {
   3.491435614043*^9, 3.491435614741*^9}, {3.491505941273*^9, 
   3.4915059721140003`*^9}, {3.4915074560880003`*^9, 3.49150753391*^9}, 
   3.49152942466028*^9, {3.4915302969262805`*^9, 3.4915302997042804`*^9}, {
   3.4915303324072804`*^9, 3.4915303326242805`*^9}, 3.4915317476862803`*^9, {
   3.4961593656041183`*^9, 3.496159431985414*^9}, {3.496159463935855*^9, 
   3.496159567355567*^9}, {3.496159936336125*^9, 3.496160001744379*^9}, {
   3.496160057518712*^9, 3.496160080317877*^9}, {3.496160346018867*^9, 
   3.496160380145644*^9}, {3.496160671530918*^9, 3.49616067559326*^9}, {
   3.496160713815338*^9, 3.496160768902717*^9}, {3.496160806069759*^9, 
   3.4961608181974583`*^9}, 3.496168649590753*^9, {3.496168704145046*^9, 
   3.4961687277469673`*^9}, {3.4961689029546824`*^9, 3.496168964599119*^9}, {
   3.496169050387465*^9, 3.496169060426627*^9}, {3.496169097128862*^9, 
   3.496169127336895*^9}, {3.496169296898683*^9, 3.496169304947937*^9}, {
   3.511724198753471*^9, 3.511724199209133*^9}, 3.5117242298679457`*^9, 
   3.511724264288126*^9, {3.512315837151211*^9, 3.512315889330798*^9}, {
   3.5123217310053864`*^9, 3.512321734984325*^9}, {3.512321775810339*^9, 
   3.512321800598653*^9}}],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "THIS", " ", "BLOCK", " ", "DEFINES", " ", "THE", " ", "RAMACHANDRAN", " ",
     "POTENTIAL"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"aps", "[", 
     RowBox[{"i_", ",", "j_"}], "]"}], ":=", 
    RowBox[{"Switch", "[", 
     RowBox[{
     "j", ",", "1", ",", "1.0", ",", "2", ",", "1.0", ",", "3", ",", "1.0", 
      ",", "4", ",", "0.0", ",", "5", ",", 
      RowBox[{"ssweight5", "[", 
       RowBox[{"[", "i", "]"}], "]"}], ",", "6", ",", 
      RowBox[{"ssweight6", "[", 
       RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ArcTan2", "[", 
     RowBox[{"y_", ",", "x_"}], "]"}], ":=", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"x", "\[Equal]", "0"}], ",", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"y", ">", "0"}], ",", 
        FractionBox["\[Pi]", "2"], ",", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"y", "<", "0"}], ",", 
          RowBox[{"-", 
           FractionBox["\[Pi]", "2"]}], ",", "\"\<undefine\>\""}], "]"}]}], 
       "]"}], ",", 
      RowBox[{
       RowBox[{"ArcTan", "[", 
        RowBox[{"y", "/", "x"}], "]"}], "+", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"x", "<", "0"}], ",", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"y", "\[GreaterEqual]", "0"}], ",", "\[Pi]", ",", 
           RowBox[{"-", "\[Pi]"}]}], "]"}], ",", "0"}], "]"}]}]}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"angle", "[", 
     RowBox[{"r1_", ",", "r2_", ",", "r3_", ",", "r4_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"c", "=", 
         RowBox[{"r2", "-", "r1"}]}], ",", " ", 
        RowBox[{"b", "=", 
         RowBox[{"r3", "-", "r2"}]}], ",", 
        RowBox[{"a", "=", 
         RowBox[{"r4", "-", "r3"}]}]}], "}"}], ",", 
      RowBox[{"Return", "[", 
       RowBox[{"ArcTan2", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"MyNorm", "[", "b", "]"}], " ", 
          RowBox[{"c", ".", 
           RowBox[{"Cross", "[", 
            RowBox[{"b", ",", "a"}], "]"}]}]}], ",", 
         RowBox[{
          RowBox[{"Cross", "[", 
           RowBox[{"c", ",", "b"}], "]"}], ".", 
          RowBox[{"Cross", "[", 
           RowBox[{"b", ",", "a"}], "]"}]}]}], "]"}], "]"}]}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Phi]", "[", "i_", "]"}], ":=", 
    RowBox[{"angle", "[", 
     RowBox[{
      SubscriptBox["r", 
       RowBox[{"Cp", ",", 
        RowBox[{"i", "-", "1"}]}]], ",", 
      SubscriptBox["r", 
       RowBox[{"N", ",", "i"}]], ",", 
      SubscriptBox["r", 
       RowBox[{"Ca", ",", "i"}]], ",", 
      SubscriptBox["r", 
       RowBox[{"Cp", ",", "i"}]]}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Psi]", "[", "i_", "]"}], ":=", 
    RowBox[{"angle", "[", 
     RowBox[{
      SubscriptBox["r", 
       RowBox[{"N", ",", "i"}]], ",", 
      SubscriptBox["r", 
       RowBox[{"Ca", ",", "i"}]], ",", 
      SubscriptBox["r", 
       RowBox[{"Cp", ",", "i"}]], ",", 
      SubscriptBox["r", 
       RowBox[{"N", ",", 
        RowBox[{"i", "+", "1"}]}]]}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"VRamaI", "[", "i_", "]"}], ":=", 
    RowBox[{
     UnderoverscriptBox["\[Sum]", 
      RowBox[{"j", "=", "1"}], "6"], 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"w", "[", 
          RowBox[{"[", "j", "]"}], "]"}], "\[NotEqual]", "0.0"}], " ", "&&", 
        " ", 
        RowBox[{
         RowBox[{"aps", "[", 
          RowBox[{"i", ",", "j"}], "]"}], "\[NotEqual]", "0.0"}]}], ",", 
       RowBox[{
        RowBox[{"w", "[", 
         RowBox[{"[", "j", "]"}], "]"}], 
        RowBox[{"Exp", "[", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"Sigma", "[", 
            RowBox[{"[", "j", "]"}], "]"}]}], 
          RowBox[{"(", " ", 
           RowBox[{
            RowBox[{
             RowBox[{"phiw", "[", 
              RowBox[{"[", "j", "]"}], "]"}], " ", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Cos", "[", 
                 RowBox[{
                  RowBox[{"\[Phi]", "[", "i", "]"}], "-", 
                  RowBox[{"phi0", "[", 
                   RowBox[{"[", "j", "]"}], "]"}]}], "]"}], "-", "1.0"}], 
               ")"}], "2"]}], "+", 
            RowBox[{
             RowBox[{"psiw", "[", 
              RowBox[{"[", "j", "]"}], "]"}], " ", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Cos", "[", 
                 RowBox[{
                  RowBox[{"\[Psi]", "[", "i", "]"}], "-", 
                  RowBox[{"psi0", "[", 
                   RowBox[{"[", "j", "]"}], "]"}]}], "]"}], "-", "1.0"}], 
               ")"}], "2"]}]}], ")"}]}], "]"}]}], ",", "0.0"}], "]"}]}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"VRamaIPr", "[", "i_", "]"}], ":=", 
    RowBox[{
     UnderoverscriptBox["\[Sum]", 
      RowBox[{"j", "=", "1"}], "6"], 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"wPr", "[", 
          RowBox[{"[", "j", "]"}], "]"}], "\[NotEqual]", "0.0"}], " ", "&&", 
        " ", 
        RowBox[{
         RowBox[{"aps", "[", 
          RowBox[{"i", ",", "j"}], "]"}], "\[NotEqual]", "0.0"}]}], ",", 
       RowBox[{
        RowBox[{"wPr", "[", 
         RowBox[{"[", "j", "]"}], "]"}], 
        RowBox[{"Exp", "[", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"SigmaPr", "[", 
            RowBox[{"[", "j", "]"}], "]"}]}], 
          RowBox[{"(", " ", 
           RowBox[{
            RowBox[{
             RowBox[{"phiwPr", "[", 
              RowBox[{"[", "j", "]"}], "]"}], " ", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Cos", "[", 
                 RowBox[{
                  RowBox[{"\[Phi]", "[", "i", "]"}], "-", 
                  RowBox[{"phi0Pr", "[", 
                   RowBox[{"[", "j", "]"}], "]"}]}], "]"}], "-", "1.0"}], 
               ")"}], "2"]}], "+", 
            RowBox[{
             RowBox[{"psiwPr", "[", 
              RowBox[{"[", "j", "]"}], "]"}], " ", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Cos", "[", 
                 RowBox[{
                  RowBox[{"\[Psi]", "[", "i", "]"}], "-", 
                  RowBox[{"psi0Pr", "[", 
                   RowBox[{"[", "j", "]"}], "]"}]}], "]"}], "-", "1.0"}], 
               ")"}], "2"]}]}], ")"}]}], "]"}]}], ",", "0.0"}], "]"}]}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Vramaij", "[", 
     RowBox[{"i_", ",", "j_"}], "]"}], " ", ":=", " ", 
    RowBox[{
     RowBox[{"-", "\[Lambda]Rama"}], " ", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"se", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "\[Equal]", "8"}], " ", "||", " ", 
        RowBox[{"i", "\[Equal]", "1"}], " ", "||", " ", 
        RowBox[{"i", "\[Equal]", "M"}], " ", "||", " ", 
        RowBox[{
         RowBox[{"aps", "[", 
          RowBox[{"i", ",", "j"}], "]"}], "\[Equal]", "0.0"}]}], ",", "0.0", 
       ",", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"se", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "\[Equal]", "15"}], " ", ",", 
         RowBox[{
          RowBox[{"wPr", "[", 
           RowBox[{"[", "j", "]"}], "]"}], 
          RowBox[{"Exp", "[", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"SigmaPr", "[", 
              RowBox[{"[", "j", "]"}], "]"}]}], 
            RowBox[{"(", " ", 
             RowBox[{
              RowBox[{
               RowBox[{"phiwPr", "[", 
                RowBox[{"[", "j", "]"}], "]"}], " ", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"Cos", "[", 
                   RowBox[{
                    RowBox[{"\[Phi]", "[", "i", "]"}], "-", 
                    RowBox[{"phi0Pr", "[", 
                    RowBox[{"[", "j", "]"}], "]"}]}], "]"}], "-", "1.0"}], 
                 ")"}], "2"]}], "+", 
              RowBox[{
               RowBox[{"psiwPr", "[", 
                RowBox[{"[", "j", "]"}], "]"}], " ", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"Cos", "[", 
                   RowBox[{
                    RowBox[{"\[Psi]", "[", "i", "]"}], "-", 
                    RowBox[{"psi0Pr", "[", 
                    RowBox[{"[", "j", "]"}], "]"}]}], "]"}], "-", "1.0"}], 
                 ")"}], "2"]}]}], ")"}]}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"w", "[", 
           RowBox[{"[", "j", "]"}], "]"}], 
          RowBox[{"Exp", "[", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"Sigma", "[", 
              RowBox[{"[", "j", "]"}], "]"}]}], 
            RowBox[{"(", " ", 
             RowBox[{
              RowBox[{
               RowBox[{"phiw", "[", 
                RowBox[{"[", "j", "]"}], "]"}], " ", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"Cos", "[", 
                   RowBox[{
                    RowBox[{"\[Phi]", "[", "i", "]"}], "-", 
                    RowBox[{"phi0", "[", 
                    RowBox[{"[", "j", "]"}], "]"}]}], "]"}], "-", "1.0"}], 
                 ")"}], "2"]}], "+", 
              RowBox[{
               RowBox[{"psiw", "[", 
                RowBox[{"[", "j", "]"}], "]"}], " ", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"Cos", "[", 
                   RowBox[{
                    RowBox[{"\[Psi]", "[", "i", "]"}], "-", 
                    RowBox[{"psi0", "[", 
                    RowBox[{"[", "j", "]"}], "]"}]}], "]"}], "-", "1.0"}], 
                 ")"}], "2"]}]}], ")"}]}], "]"}]}]}], "]"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"Vrama", " ", ":=", " ", 
    RowBox[{
     RowBox[{"-", "\[Lambda]Rama"}], 
     RowBox[{
      UnderoverscriptBox["\[Sum]", 
       RowBox[{"i", "=", "2"}], 
       RowBox[{"M", "-", "1"}]], 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"se", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "\[Equal]", "15"}], ",", 
        RowBox[{"VRamaIPr", "[", "i", "]"}], ",", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"se", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "\[Equal]", "8"}], ",", "0.0", 
          ",", 
          RowBox[{"VRamaI", "[", "i", "]"}]}], "]"}]}], 
       "]"}]}]}]}]}]}]], "Input",
 CellChangeTimes->{{3.5118051191327744`*^9, 3.511805119425357*^9}, {
  3.512316114456573*^9, 3.512316124828285*^9}, {3.51232202244118*^9, 
  3.512322028577326*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "THIS", " ", "BLOCK", " ", "DEFINES", " ", "THE", " ", "SOLVENT", " ", 
    "SEPARATED", " ", "BARRIER", " ", "POTENTIAL"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"kssb", "=", "1.0"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"kappassb", "=", "5.0"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"rssbmin", "=", "3.0"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"rssbmax", "=", "8.0"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"minsep", "=", "13"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"cbcorrection", "=", "1"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"residueradii", "=", 
     RowBox[{"{", 
      RowBox[{
      "0.00", ",", "2.04", ",", "0.57", ",", "0.57", ",", "0.36", ",", "1.11",
        ",", "1.17", ",", 
       RowBox[{"-", "1.52"}], ",", "0.87", ",", "0.67", ",", "0.79", ",", 
       "1.47", ",", "1.03", ",", "1.00", ",", 
       RowBox[{"-", "0.10"}], ",", "0.26", ",", "0.37", ",", "1.21", ",", 
       "1.15", ",", "0.39"}], "}"}]}], ";"}], "\n", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
      RowBox[{
      "DEFINE", " ", "THE", " ", "SEPARATION", " ", "AS", " ", "THE", " ", 
       "CB"}], "-", 
      RowBox[{
      "CB", " ", "DISTANCE", " ", "UNLESS", " ", "ONE", " ", "OR", " ", 
       "BOTH", " ", "OF", " ", "THE", " ", "RESIDUES", " ", "ARE", " ", 
       "GLYCINES"}]}], ",", " ", 
     RowBox[{
     "IN", " ", "WHICH", " ", "CASE", " ", "THE", " ", "CA", " ", 
      "COORDINATES", " ", "ARE", " ", "USED"}]}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"rssb", "[", 
     RowBox[{"i_", ",", "j_"}], "]"}], ":=", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"se", "[", 
        RowBox[{"[", "i", "]"}], "]"}], "\[Equal]", "8"}], ",", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"se", "[", 
          RowBox[{"[", "j", "]"}], "]"}], "\[Equal]", "8"}], ",", 
        RowBox[{"MyNorm", "[", 
         RowBox[{
          SubscriptBox["r", 
           RowBox[{"Ca", ",", "i"}]], "-", 
          SubscriptBox["r", 
           RowBox[{"Ca", ",", "j"}]]}], "]"}], ",", 
        RowBox[{"MyNorm", "[", 
         RowBox[{
          SubscriptBox["r", 
           RowBox[{"Ca", ",", "i"}]], "-", 
          SubscriptBox["r", 
           RowBox[{"Cb", ",", "j"}]]}], "]"}]}], "]"}], ",", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"se", "[", 
          RowBox[{"[", "j", "]"}], "]"}], "\[Equal]", "8"}], ",", 
        RowBox[{"MyNorm", "[", 
         RowBox[{
          SubscriptBox["r", 
           RowBox[{"Cb", ",", "i"}]], "-", 
          SubscriptBox["r", 
           RowBox[{"Ca", ",", "j"}]]}], "]"}], ",", 
        RowBox[{"MyNorm", "[", 
         RowBox[{
          SubscriptBox["r", 
           RowBox[{"Cb", ",", "i"}]], "-", 
          SubscriptBox["r", 
           RowBox[{"Cb", ",", "j"}]]}], "]"}]}], "]"}]}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "DEFINE", " ", "SHIFTED", " ", "rssbmin", " ", "AND", " ", "rssbmax", 
      " ", "WHICH", " ", "ARE", " ", "USED", " ", "IN", " ", "THE", " ", 
      "CASE", " ", "THAT", " ", "cbcorrection"}], "\[Equal]", "1"}], " ", 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"rssbminshifted", "[", 
     RowBox[{"i_", ",", "j_"}], "]"}], ":=", 
    RowBox[{"rssbmin", "+", 
     RowBox[{"residueradii", "[", 
      RowBox[{"[", 
       RowBox[{"se", "[", 
        RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], "+", 
     RowBox[{"residueradii", "[", 
      RowBox[{"[", 
       RowBox[{"se", "[", 
        RowBox[{"[", "j", "]"}], "]"}], "]"}], "]"}]}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"rssbmaxshifted", "[", 
     RowBox[{"i_", ",", "j_"}], "]"}], ":=", 
    RowBox[{"rssbmax", "+", 
     RowBox[{"residueradii", "[", 
      RowBox[{"[", 
       RowBox[{"se", "[", 
        RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], "+", 
     RowBox[{"residueradii", "[", 
      RowBox[{"[", 
       RowBox[{"se", "[", 
        RowBox[{"[", "j", "]"}], "]"}], "]"}], "]"}]}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"DEFINE", " ", "CUTOFF", " ", "DISTANCE"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"rssbmaxcutoff", "[", 
      RowBox[{"i_", ",", "j_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"cbcorrection", "\[Equal]", "1"}], ",", 
        RowBox[{"rssbmaxshifted", "[", 
         RowBox[{"i", ",", "j"}], "]"}], ",", "rssbmax"}], "]"}], "+", 
      RowBox[{"(", 
       RowBox[{"10.0", "/", "kappassb"}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "CALCULATE", " ", "THE", " ", "SOLVENT", " ", "SEPARATED", " ", "BARRIER",
      " ", "ENERGY", " ", "FOR", " ", "A", " ", "PAIR", " ", "OF", " ", 
     "RESIDUES"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Vssbij", "[", 
      RowBox[{"i_", ",", "j_"}], "]"}], ":=", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"rssb", "[", 
         RowBox[{"i", ",", "j"}], "]"}], ">", 
        RowBox[{"rssbmaxcutoff", "[", 
         RowBox[{"i", ",", "j"}], "]"}]}], ",", "0.0", ",", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Abs", "[", 
           RowBox[{"i", "-", "j"}], "]"}], "<", "minsep"}], ",", "0.0", ",", 
         RowBox[{"kssb", "*", "0.5", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Tanh", "[", 
             RowBox[{"kappassb", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"rssb", "[", 
                 RowBox[{"i", ",", "j"}], "]"}], "-", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"cbcorrection", "\[Equal]", "1"}], ",", 
                  RowBox[{"rssbminshifted", "[", 
                   RowBox[{"i", ",", "j"}], "]"}], ",", "rssbmin"}], "]"}]}], 
               ")"}]}], "]"}], "+", 
            RowBox[{"Tanh", "[", 
             RowBox[{"kappassb", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"cbcorrection", "\[Equal]", "1"}], ",", 
                  RowBox[{"rssbmaxshifted", "[", 
                   RowBox[{"i", ",", "j"}], "]"}], ",", "rssbmax"}], "]"}], 
                "-", 
                RowBox[{"rssb", "[", 
                 RowBox[{"i", ",", "j"}], "]"}]}], ")"}]}], "]"}]}], 
           ")"}]}]}], "]"}]}], "]"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Vssbij", "[", 
     RowBox[{"i_", ",", "j_"}], "]"}], ":=", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Abs", "[", 
        RowBox[{"i", "-", "j"}], "]"}], "<", "minsep"}], ",", "0.0", ",", 
      RowBox[{"kssb", "*", "0.5", "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Tanh", "[", 
          RowBox[{"kappassb", "*", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"rssb", "[", 
              RowBox[{"i", ",", "j"}], "]"}], "-", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"cbcorrection", "\[Equal]", "1"}], ",", 
               RowBox[{"rssbminshifted", "[", 
                RowBox[{"i", ",", "j"}], "]"}], ",", "rssbmin"}], "]"}]}], 
            ")"}]}], "]"}], "+", 
         RowBox[{"Tanh", "[", 
          RowBox[{"kappassb", "*", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"cbcorrection", "\[Equal]", "1"}], ",", 
               RowBox[{"rssbmaxshifted", "[", 
                RowBox[{"i", ",", "j"}], "]"}], ",", "rssbmax"}], "]"}], "-", 
             
             RowBox[{"rssb", "[", 
              RowBox[{"i", ",", "j"}], "]"}]}], ")"}]}], "]"}]}], ")"}]}]}], 
     "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "CALCULATE", " ", "THE", " ", "TOTAL", " ", "SOLVENT", " ", "SEPARATED", 
     " ", "BARRIER", " ", "ENERGY"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"Vssb", ":=", 
    RowBox[{
     UnderoverscriptBox["\[Sum]", 
      RowBox[{"i", "=", "1"}], 
      RowBox[{"M", "-", "1"}]], 
     RowBox[{"(", 
      RowBox[{
       UnderoverscriptBox["\[Sum]", 
        RowBox[{"j", "=", 
         RowBox[{"i", "+", "1"}]}], "M"], 
       RowBox[{"Vssbij", "[", 
        RowBox[{"i", ",", "j"}], "]"}]}], ")"}]}]}]}]}]], "Input",
 CellChangeTimes->{{3.512334374316305*^9, 3.512334561973007*^9}, {
   3.5123345975303783`*^9, 3.5123346394852047`*^9}, {3.5123346800437937`*^9, 
   3.512334702297639*^9}, {3.512334804848846*^9, 3.512334858189114*^9}, {
   3.512334929735024*^9, 3.5123349548524017`*^9}, 3.5123350158082323`*^9, {
   3.5123350808639183`*^9, 3.5123351543303223`*^9}, {3.512335427131501*^9, 
   3.5123354896958303`*^9}, {3.512340910822135*^9, 3.512341063069209*^9}, {
   3.5123411958281116`*^9, 3.512341360456814*^9}, {3.512341419962578*^9, 
   3.512341433075323*^9}, {3.512341469787331*^9, 3.5123414897850657`*^9}, {
   3.512341530113044*^9, 3.5123415324164457`*^9}, {3.512341562473892*^9, 
   3.5123416153786077`*^9}, {3.512341653632106*^9, 3.512341669363619*^9}, {
   3.512341716832548*^9, 3.5123418833052273`*^9}, {3.512341936361721*^9, 
   3.51234201869131*^9}, {3.512342051993537*^9, 3.512342157437056*^9}, {
   3.5123423094506598`*^9, 3.512342339274049*^9}, {3.512342382254984*^9, 
   3.512342382523411*^9}, {3.512342712247609*^9, 3.512342717333022*^9}, {
   3.51234291312582*^9, 3.5123429661412907`*^9}, {3.512343125923366*^9, 
   3.512343126144085*^9}, {3.512343159541482*^9, 3.512343180409527*^9}, {
   3.512343210983222*^9, 3.5123432541630774`*^9}, {3.5123457598095713`*^9, 
   3.512345764591309*^9}, 3.5123458020234737`*^9, {3.512345864588251*^9, 
   3.5123458668123217`*^9}, {3.512345903134356*^9, 3.512346001229871*^9}, {
   3.512349801985283*^9, 3.5123499951308947`*^9}, {3.512350126229039*^9, 
   3.5123501301930113`*^9}, {3.512350443793626*^9, 3.512350482408517*^9}, {
   3.512350879308119*^9, 3.512350888961907*^9}, {3.5123510850982924`*^9, 
   3.512351085280636*^9}, {3.512351539256563*^9, 3.5123515653785667`*^9}, {
   3.512351676650198*^9, 3.512351710406589*^9}, {3.512351768445006*^9, 
   3.512351778216229*^9}, {3.512353090641622*^9, 3.512353165722602*^9}, {
   3.5123532502716637`*^9, 3.512353284722406*^9}, {3.512353369908868*^9, 
   3.5123533784254847`*^9}, {3.5123534122009687`*^9, 
   3.5123534432903223`*^9}, {3.5123557768439913`*^9, 3.512355866261181*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "THIS", " ", "BLOCK", " ", "INITIALIZES", " ", "THE", " ", "VARIABLE", " ",
     "VTotal", " ", "WHICH", " ", "IS", " ", "USED", " ", "IN", " ", "THE", 
    " ", "SUBSEQUENT", " ", "BLOCK", " ", "THAT", " ", "EVALUATES", " ", 
    "THE", " ", "FORCES"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"VTotal", " ", "=", 
    RowBox[{"2", " ", "Vssb"}]}], ";", " ", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "THIS", " ", "ASSIGNMENT", " ", "CARRIES", " ", "WITH", " ", "IT", " ", 
      "ALL", " ", "THE", " ", "DETAILS", " ", "OF", " ", "THE", " ", 
      "FUNCTION"}], ",", " ", 
     RowBox[{
      RowBox[{"I", ".", "E", ".", " ", "IT"}], " ", "IS", " ", "NOT", " ", 
      "JUST", " ", "ASSIGNING", " ", "A", " ", "NUMBER", " ", "TO", " ", 
      RowBox[{"VTotal", ".", " ", "IN"}], " ", "THIS", " ", "WAY"}], ",", " ", 
     RowBox[{
     "IT", " ", "CAN", " ", "BE", " ", "USED", " ", "BELOW", " ", "AS", " ", 
      "INPUT", " ", "FOR", " ", "CALCULATING", " ", "THE", " ", "FORCES", " ",
       "AND", " ", "THAT", " ", "BLOCK", " ", 
      RowBox[{"DOESN", "'"}], "T", " ", "HAVE", " ", "TO", " ", "BE", " ", 
      "CHANGED", " ", "WHEN", " ", "CHANGING", " ", "THE", " ", "POTENTIAL", 
      " ", "THAT", " ", "YOU", " ", "ARE", " ", "TESTING"}]}], " ", "*)"}], 
   " "}]}]], "Input",
 CellChangeTimes->{{3.4706685671253777`*^9, 3.470668568923956*^9}, 
   3.470669140687944*^9, {3.472568135764303*^9, 3.472568136077662*^9}, {
   3.49153042070728*^9, 3.49153043000228*^9}, 3.5062799804243402`*^9, {
   3.5117206113578653`*^9, 3.5117206143005743`*^9}, {3.511720931183508*^9, 
   3.511720945895186*^9}, {3.511721091663517*^9, 3.511721093624007*^9}, 
   3.511730339573325*^9, 3.5118034247967377`*^9, {3.5123310006221437`*^9, 
   3.512331009104251*^9}, {3.512331066833764*^9, 3.51233109174583*^9}, {
   3.5123336302879763`*^9, 3.512333743640379*^9}, {3.5123432922590218`*^9, 
   3.512343294794918*^9}, {3.512345020526559*^9, 3.512345042630878*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"THIS", " ", "BLOCK", " ", "USES", " ", 
    RowBox[{"MATHEMATICA", "'"}], "S", " ", "CAPABILITIES", " ", "TO", " ", 
    "ANALYTICALLY", " ", "DIFFERENTIATE", " ", "THE", " ", "POTENTIAL", " ", 
    "FUNCTION", " ", "TO", " ", "GIVE", " ", "FORCES"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"ProgressIndicator", "[", 
    RowBox[{
     RowBox[{"Dynamic", "[", "ipr", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "M"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
   RowBox[{"FCA", "=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"V0", ",", "V"}], "}"}], ",", 
      RowBox[{
       RowBox[{"ipr", "=", "0"}], ";", 
       RowBox[{"V0", "=", 
        RowBox[{
         RowBox[{"VTotal", "/.", 
          RowBox[{"Ruless", "[", "2", "]"}]}], "/.", 
         RowBox[{"Ruless", "[", "3", "]"}]}]}], ";", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"ipr", "=", "i"}], ";", 
          RowBox[{"V", "=", 
           RowBox[{"V0", "/.", 
            RowBox[{"Rules", "[", 
             RowBox[{"1", ",", "i"}], "]"}]}]}], ";", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"D", "[", 
               RowBox[{"V", ",", " ", 
                SubscriptBox["x", 
                 RowBox[{"Ca", ",", "i"}]]}], "]"}], "/.", 
              RowBox[{"Rulee", "[", 
               RowBox[{"1", ",", "i"}], "]"}]}], ")"}], ",", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"D", "[", 
               RowBox[{"V", ",", " ", 
                SubscriptBox["y", 
                 RowBox[{"Ca", ",", "i"}]]}], "]"}], "/.", 
              RowBox[{"Rulee", "[", 
               RowBox[{"1", ",", "i"}], "]"}]}], ")"}], ",", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"D", "[", 
               RowBox[{"V", ",", " ", 
                SubscriptBox["z", 
                 RowBox[{"Ca", ",", "i"}]]}], "]"}], "/.", 
              RowBox[{"Rulee", "[", 
               RowBox[{"1", ",", "i"}], "]"}]}], ")"}]}], "}"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "M"}], "}"}]}], "]"}]}]}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"FCB", "=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"V0", ",", "V"}], "}"}], ",", 
      RowBox[{
       RowBox[{"ipr", "=", "0"}], ";", 
       RowBox[{"V0", "=", 
        RowBox[{
         RowBox[{"VTotal", "/.", 
          RowBox[{"Ruless", "[", "1", "]"}]}], "/.", 
         RowBox[{"Ruless", "[", "3", "]"}]}]}], ";", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"ipr", "=", "i"}], ";", 
          RowBox[{"V", "=", 
           RowBox[{"V0", "/.", 
            RowBox[{"Rules", "[", 
             RowBox[{"2", ",", "i"}], "]"}]}]}], ";", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"D", "[", 
               RowBox[{"V", ",", " ", 
                SubscriptBox["x", 
                 RowBox[{"Cb", ",", "i"}]]}], "]"}], "/.", 
              RowBox[{"Rulee", "[", 
               RowBox[{"2", ",", "i"}], "]"}]}], ")"}], ",", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"D", "[", 
               RowBox[{"V", ",", " ", 
                SubscriptBox["y", 
                 RowBox[{"Cb", ",", "i"}]]}], "]"}], "/.", 
              RowBox[{"Rulee", "[", 
               RowBox[{"2", ",", "i"}], "]"}]}], ")"}], ",", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"D", "[", 
               RowBox[{"V", ",", " ", 
                SubscriptBox["z", 
                 RowBox[{"Cb", ",", "i"}]]}], "]"}], "/.", 
              RowBox[{"Rulee", "[", 
               RowBox[{"2", ",", "i"}], "]"}]}], ")"}]}], "}"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "M"}], "}"}]}], "]"}]}]}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"FO", "=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"V0", ",", "V"}], "}"}], ",", 
      RowBox[{
       RowBox[{"ipr", "=", "0"}], ";", 
       RowBox[{"V0", "=", 
        RowBox[{
         RowBox[{"VTotal", "/.", 
          RowBox[{"Ruless", "[", "1", "]"}]}], "/.", 
         RowBox[{"Ruless", "[", "2", "]"}]}]}], ";", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"ipr", "=", "i"}], ";", 
          RowBox[{"V", "=", 
           RowBox[{"V0", "/.", 
            RowBox[{"Rules", "[", 
             RowBox[{"3", ",", "i"}], "]"}]}]}], ";", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"D", "[", 
               RowBox[{"V", ",", " ", 
                SubscriptBox["x", 
                 RowBox[{"O", ",", "i"}]]}], "]"}], "/.", 
              RowBox[{"Rulee", "[", 
               RowBox[{"3", ",", "i"}], "]"}]}], ")"}], ",", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"D", "[", 
               RowBox[{"V", ",", " ", 
                SubscriptBox["y", 
                 RowBox[{"O", ",", "i"}]]}], "]"}], "/.", 
              RowBox[{"Rulee", "[", 
               RowBox[{"3", ",", "i"}], "]"}]}], ")"}], ",", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"D", "[", 
               RowBox[{"V", ",", " ", 
                SubscriptBox["z", 
                 RowBox[{"O", ",", "i"}]]}], "]"}], "/.", 
              RowBox[{"Rulee", "[", 
               RowBox[{"3", ",", "i"}], "]"}]}], ")"}]}], "}"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "M"}], "}"}]}], "]"}]}]}], 
     "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.471701217544476*^9, 3.471701246546933*^9}, {
   3.472406747727654*^9, 3.47240675002771*^9}, {3.472574328849304*^9, 
   3.472574329475623*^9}, 3.4725743767652073`*^9, {3.472574432137315*^9, 
   3.472574434319613*^9}, {3.472574739790389*^9, 3.472574750794717*^9}, {
   3.472574799687457*^9, 3.472574800128894*^9}, {3.47257485955485*^9, 
   3.4725748713780193`*^9}, {3.512331096871563*^9, 3.51233115208499*^9}, {
   3.512349578871891*^9, 3.512349580132258*^9}, {3.512353658151764*^9, 
   3.512353659727635*^9}}],

Cell[BoxData[
 ProgressIndicatorBox[Dynamic[$CellContext`ipr], {0, 26}]], "Output",
 CellChangeTimes->{{3.512353639656427*^9, 3.5123536605858107`*^9}, 
   3.512354547183454*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "3.002456402919901`*^-44"}], ",", 
     RowBox[{"-", "1.19928907121873`*^-45"}], ",", 
     RowBox[{"-", "2.3475745168914947`*^-45"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "2.716280784508039`*^-21"}], ",", 
     "2.0774929620320823`*^-23", ",", 
     RowBox[{"-", "3.8293253450131935`*^-22"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "4.447659696196152`*^-8"}], ",", 
     RowBox[{"-", "2.7916699172401752`*^-8"}], ",", 
     RowBox[{"-", "2.4324262831603445`*^-9"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.00019500413845230808`"}], ",", 
     RowBox[{"-", "0.00013192792816170735`"}], ",", 
     "0.00007485707745552705`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.6359596435776081`", ",", 
     RowBox[{"-", "3.971967576621283`"}], ",", 
     RowBox[{"-", "1.349303751211566`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.015398200634992787`", ",", 
     RowBox[{"-", "0.012957576255066676`"}], ",", 
     RowBox[{"-", "0.015972510239302674`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"9.396584176875784`*^-7", ",", 
     RowBox[{"-", "7.410400150459667`*^-8"}], ",", 
     RowBox[{"-", "2.05220138783288`*^-7"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "3.782927296959023`*^-103", ",", "3.1116733259507816`*^-104", ",", 
     "7.444771946794101`*^-104"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.512353639656427*^9, 3.5123536605858107`*^9}, 
   3.512354547413719*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "8.389388465739988`*^-52"}], ",", 
     "2.1136700549384978`*^-53", ",", 
     RowBox[{"-", "2.4722303157936797`*^-52"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "1.2515126075379982`*^-9"}], ",", 
     RowBox[{"-", "1.3763160304687586`*^-10"}], ",", 
     RowBox[{"-", "3.402652640165812`*^-11"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.005246133492365766`"}], ",", "0.0009250955062570106`", 
     ",", "0.0015884660435535808`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "1.9369081372667643`"}], ",", 
     RowBox[{"-", "2.3125414943705747`"}], ",", 
     RowBox[{"-", "0.3081332111622031`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4.0726830745161723`*^-7", ",", 
     RowBox[{"-", "3.07521392264422`*^-6"}], ",", 
     RowBox[{"-", "1.4928805869412207`*^-6"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.0005222668219242262`", ",", 
     RowBox[{"-", "0.00020144424858211052`"}], ",", 
     RowBox[{"-", "0.0004003954374286114`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "2.5345863891856907`*^-93", ",", "8.220894365645098`*^-94", ",", 
     "9.533632418366613`*^-94"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "8.956745743539773`*^-76", ",", "4.4568947084418047`*^-76", ",", 
     "3.069505699596027`*^-76"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "1.7758782416188195`*^-55", ",", "1.2476590487205665`*^-55", ",", 
     "6.768684469198583`*^-56"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"6.836318386530069`*^-40", ",", "4.549145648301227`*^-40", ",", 
     RowBox[{"-", "2.9285297207455933`*^-41"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1.4152893802182494`*^-51", ",", "7.305746969791147`*^-52", ",", 
     RowBox[{"-", "2.2090953781233636`*^-52"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1.488389155858018`*^-32", ",", "7.136383326614247`*^-33", ",", 
     RowBox[{"-", "4.661478663095277`*^-33"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4.5581650673449425`*^-17", ",", "2.777637539846992`*^-17", ",", 
     RowBox[{"-", "4.046448002087302`*^-18"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "1.936914146851159`", ",", "2.3125457354011125`", ",", 
     "0.30813117162833`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.00495068420004628`", ",", 
     RowBox[{"-", "0.0006505775251528026`"}], ",", 
     RowBox[{"-", "0.0017358955246387893`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.0149166750228056`"}], ",", "0.012811884609179246`", ",", 
     "0.01604672168026175`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "2.5228272064144126`*^-6", ",", "1.90961456374103`*^-6", ",", 
     "1.9489435140341818`*^-6"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.6364828161911649`"}], ",", "3.972169149189963`", ",", 
     "1.349704298769203`"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.512353639656427*^9, 3.5123536605858107`*^9}, 
   3.5123545479930687`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.512353639656427*^9, 3.5123536605858107`*^9}, 
   3.512354548183622*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "THIS", " ", "CALCULATES", " ", "FORCES", " ", "FROM", " ", "POTENTIALS", 
     " ", "USING", " ", "A", " ", "NUMERICAL", " ", "DIFFERENTIATION", " ", 
     "SCHEME"}], " ", "-", " ", 
    RowBox[{
    "IT", " ", "IS", " ", "NOT", " ", "THE", " ", "RECOMMENDED", " ", 
     "METHOD"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"h", "=", "0.0001"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"rdh", "[", 
     RowBox[{"r_", ",", "h_", ",", "i_", ",", "j_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "rr", "}"}], ",", 
      RowBox[{
       RowBox[{"rr", "=", "r"}], ";", 
       RowBox[{
        RowBox[{"rr", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "j"}], "]"}], "]"}], "+=", "h"}], ";", 
       RowBox[{"Return", "[", "rr", "]"}]}]}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"i", "=", "5"}], ";", 
    RowBox[{"j", "=", "2"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Vwaterhij", "[", 
     RowBox[{"h_", ",", "ii_", ",", "jj_", ",", "kk_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"rcah", "=", "rca"}], ",", 
        RowBox[{"rcbh", "=", "rcb"}], ",", 
        RowBox[{"roh", "=", "ro"}], ",", "ruleh"}], "}"}], ",", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"kk", "\[Equal]", "1"}], ",", 
         RowBox[{"rcah", "=", 
          RowBox[{"rdh", "[", 
           RowBox[{"rca", ",", "h", ",", "ii", ",", "jj"}], "]"}]}], ",", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"kk", "\[Equal]", "2"}], ",", 
           RowBox[{"rcbh", "=", 
            RowBox[{"rdh", "[", 
             RowBox[{"rcb", ",", "h", ",", "ii", ",", "jj"}], "]"}]}], ",", 
           RowBox[{"roh", "=", 
            RowBox[{"rdh", "[", 
             RowBox[{"ro", ",", "h", ",", "ii", ",", "jj"}], "]"}]}]}], 
          "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"ruleh", "=", 
        RowBox[{"Flatten", "[", 
         RowBox[{"Append", "[", 
          RowBox[{
           RowBox[{"Append", "[", 
            RowBox[{
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  SubscriptBox["r", 
                   RowBox[{"Ca", ",", "i"}]], "[", 
                  RowBox[{"[", "j", "]"}], "]"}], "\[Rule]", 
                 RowBox[{"rcah", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", ",", "j"}], "]"}], "]"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", "1", ",", "M"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"j", ",", "1", ",", "3"}], "}"}]}], "]"}], ",", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  SubscriptBox["r", 
                   RowBox[{"Cb", ",", "i"}]], "[", 
                  RowBox[{"[", "j", "]"}], "]"}], "\[Rule]", 
                 RowBox[{"rcbh", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", ",", "j"}], "]"}], "]"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", "1", ",", "M"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"j", ",", "1", ",", "3"}], "}"}]}], "]"}]}], "]"}], 
           ",", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                SubscriptBox["r", 
                 RowBox[{"O", ",", "i"}]], "[", 
                RowBox[{"[", "j", "]"}], "]"}], "\[Rule]", 
               RowBox[{"roh", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "j"}], "]"}], "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", "M"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"j", ",", "1", ",", "3"}], "}"}]}], "]"}]}], "]"}], 
         "]"}]}], ";", 
       RowBox[{"Return", "[", 
        RowBox[{"Vwater", "/.", "ruleh"}], "]"}]}]}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"ProgressIndicator", "[", 
    RowBox[{
     RowBox[{"Dynamic", "[", "kt", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "3"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
   RowBox[{"ProgressIndicator", "[", 
    RowBox[{
     RowBox[{"Dynamic", "[", "it", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "M"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
   RowBox[{"ProgressIndicator", "[", 
    RowBox[{
     RowBox[{"Dynamic", "[", "jt", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "3"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
   RowBox[{"FF", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"0.5", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Vwaterhij", "[", 
           RowBox[{"h", ",", "it", ",", "jt", ",", "kt"}], "]"}], "-", 
          RowBox[{"Vwaterhij", "[", 
           RowBox[{
            RowBox[{"-", "h"}], ",", "it", ",", "jt", ",", "kt"}], "]"}]}], 
         ")"}], "/", "h"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"kt", ",", "1", ",", "3"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"it", ",", "1", ",", "M"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"jt", ",", "1", ",", "3"}], "}"}]}], "]"}]}], 
   "\[IndentingNewLine]"}]}]], "Input",
 CellOpen->False,
 CellChangeTimes->{{3.5062785899733057`*^9, 3.506278831999267*^9}, {
  3.5062788718752813`*^9, 3.506279041983946*^9}, {3.5062791047284107`*^9, 
  3.5062793944440813`*^9}, {3.50627942466101*^9, 3.50627947534096*^9}, {
  3.50627950604035*^9, 3.5062795625999727`*^9}, {3.5062796037022867`*^9, 
  3.506279793908305*^9}, {3.50627982401138*^9, 3.5062799104062243`*^9}, {
  3.506280017732071*^9, 3.5062800212929363`*^9}, {3.5062800998437862`*^9, 
  3.506280271146153*^9}, {3.506282150400591*^9, 3.5062821577074633`*^9}, {
  3.506343452089678*^9, 3.506343459765299*^9}, {3.512323114881507*^9, 
  3.512323142960685*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "TEST", " ", "IF", " ", "FORCES", " ", "CALCULATED", " ", "BY", " ", 
    "MATHEMATICA", " ", "AGREE", " ", "WITH", " ", "FORCES", " ", "INPUT", 
    " ", "FROM", " ", "LAMMPS"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Max", "[", 
    RowBox[{"Abs", "[", 
     RowBox[{"Flatten", "[", 
      RowBox[{"FCA", "+", "fca"}], "]"}], "]"}], "]"}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "THE", " ", "REASON", " ", "WHY", " ", "IT", " ", "IS", " ", "PLUS", " ",
       "INSTEAD", " ", "OF", " ", "MINUS", " ", "IS", " ", "BECAUSE", " ", 
      "WHAT", " ", "MATHEMATICA", " ", "CALCULATES", " ", "IS", " ", 
      "ACTUALLY"}], "..."}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"Max", "[", 
    RowBox[{"Abs", "[", 
     RowBox[{"Flatten", "[", 
      RowBox[{"FCB", "+", "fcb"}], "]"}], "]"}], "]"}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"dV", "/", "dX"}], " ", "AND", " ", "THE", " ", "FORCE", " ", 
      "IS", " ", "ACTUALLY", " ", "F"}], "=", 
     RowBox[{
      RowBox[{"-", "dV"}], "/", "dX"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   
   RowBox[{"Max", "[", 
    RowBox[{"Abs", "[", 
     RowBox[{"Flatten", "[", 
      RowBox[{"FO", "+", "fo"}], "]"}], "]"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.5117206881029053`*^9, 3.5117206995741243`*^9}, {
  3.512316013182979*^9, 3.512316014174736*^9}, {3.512331686034169*^9, 
  3.512331742949005*^9}}],

Cell[BoxData["12.88374467`"], "Output",
 CellChangeTimes->{3.512353648742532*^9, 3.512354561462784*^9}],

Cell[BoxData["4.294675929189963`"], "Output",
 CellChangeTimes->{3.512353648742532*^9, 3.5123545614638*^9}],

Cell[BoxData["16.83897085`"], "Output",
 CellChangeTimes->{3.512353648742532*^9, 3.512354561464691*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "THIS", " ", "IS", " ", "AN", " ", "EXAMPLE", " ", "OF", " ", "HOW", " ", 
    "TO", " ", "GET", " ", "THE", " ", "NUMERICAL", " ", "TOTAL", " ", "FOR", 
    " ", "A", " ", "PARTICULAR", " ", "POTENTIAL"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"2", " ", "*", "Vssb"}], "/.", "rule", " ", 
   RowBox[{"(*", " ", 
    RowBox[{
    "THE", " ", "2", " ", "HERE", " ", "IS", " ", "SET", " ", "TO", " ", 
     "MATCH", " ", "THE", " ", "\"\<[EPSILON]\>\"", " ", "VALUE", " ", "IN", 
     " ", "LAMMPS"}], " ", "*)"}]}]}]], "Input",
 CellChangeTimes->{{3.5123160223112993`*^9, 3.512316072711299*^9}, {
  3.512333763072858*^9, 3.512333784509334*^9}, {3.5123434025408363`*^9, 
  3.5123434035251617`*^9}, {3.5123449229128637`*^9, 3.5123449278072243`*^9}, {
  3.512351074117487*^9, 3.5123510741929903`*^9}, {3.512351327148741*^9, 
  3.512351328312166*^9}, {3.5123513596639147`*^9, 3.512351361284752*^9}, {
  3.512351488344685*^9, 3.5123514919008904`*^9}, {3.512354590125286*^9, 
  3.512354590480981*^9}}],

Cell[BoxData["25.07961028248574`"], "Output",
 CellChangeTimes->{
  3.5123514923659277`*^9, {3.5123515708003817`*^9, 3.51235157413842*^9}, 
   3.51235171549555*^9, 3.5123517833435593`*^9, 3.51235307282952*^9, 
   3.512353109116144*^9, {3.512353146769271*^9, 3.512353171467236*^9}, 
   3.512353289425601*^9, 3.5123533847355623`*^9, 3.5123536147463093`*^9, 
   3.512354565776368*^9, {3.512354602731491*^9, 3.512354616504883*^9}, {
   3.512355847760723*^9, 3.512355873053504*^9}}]
}, Open  ]]
},
WindowSize->{1920, 1003},
WindowMargins->{{0, Automatic}, {0, Automatic}},
FrontEndVersion->"8.0 for Linux x86 (64-bit) (November 7, 2010)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[545, 20, 3588, 77, 359, "Text"],
Cell[4136, 99, 19603, 503, 810, "Input"],
Cell[23742, 604, 12126, 317, 411, "Input"],
Cell[35871, 923, 12072, 315, 411, "Input"],
Cell[47946, 1240, 593, 13, 50, "Input"],
Cell[48542, 1255, 2191, 62, 19, "Input",
 CellOpen->False],
Cell[CellGroupData[{
Cell[50758, 1321, 1981, 40, 88, "Input"],
Cell[52742, 1363, 4058, 104, 88, "Output"],
Cell[56803, 1469, 4021, 108, 107, "Output"],
Cell[60827, 1579, 4105, 106, 88, "Output"]
}, Open  ]],
Cell[64947, 1688, 13777, 320, 734, "Input"],
Cell[78727, 2010, 11869, 350, 367, "Input"],
Cell[90599, 2362, 37160, 983, 938, "Input"],
Cell[127762, 3347, 7561, 215, 283, "Input"],
Cell[135326, 3564, 14532, 405, 686, "Input"],
Cell[149861, 3971, 20851, 566, 1053, "Input"],
Cell[170715, 4539, 11055, 312, 401, "Input"],
Cell[181773, 4853, 10653, 264, 487, "Input"],
Cell[192429, 5119, 2043, 37, 69, "Input"],
Cell[CellGroupData[{
Cell[194497, 5160, 6331, 168, 107, "Input"],
Cell[200831, 5330, 177, 3, 33, "Output"],
Cell[201011, 5335, 2809, 76, 77, "Output"],
Cell[203823, 5413, 3597, 91, 99, "Output"],
Cell[207423, 5506, 1941, 56, 50, "Output"]
}, Open  ]],
Cell[209379, 5565, 6160, 157, 19, "Input",
 CellOpen->False],
Cell[CellGroupData[{
Cell[215564, 5726, 1497, 37, 88, "Input"],
Cell[217064, 5765, 103, 1, 30, "Output"],
Cell[217170, 5768, 107, 1, 30, "Output"],
Cell[217280, 5771, 103, 1, 30, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[217420, 5777, 1079, 21, 50, "Input"],
Cell[218502, 5800, 477, 7, 30, "Output"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
