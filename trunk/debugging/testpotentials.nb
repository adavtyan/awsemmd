(* Content-type: application/mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 7.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       145,          7]
NotebookDataLength[    232506,       6098]
NotebookOptionsPosition[    230788,       6044]
NotebookOutlinePosition[    231116,       6059]
CellTagsIndexPosition[    231073,       6056]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[TextData[{
 StyleBox["This is a ",
  FontSize->18],
 StyleBox["Mathematica",
  FontSize->18,
  FontSlant->"Italic"],
 StyleBox[" notebook which can be used to help verify and debug potentials \
implemented in LAMMPS. It works by taking output from a LAMMPS simulation in \
the form of coordinates and forces (from forces.dat) at a particular \
timestep. The forces that are due to a particular potential term are obtained \
by subtracting the total forces before that term was calculated from the \
total forces after that term was calculated. The total potential energy due \
to that term is also available in forces.dat. To test a potential term, you \
must implement the form of the potential in the notebook below exactly as it \
is implemented in LAMMPS, including the same values of any parameters that \
were used in the LAMMPS simulation. The advantage of using ",
  FontSize->18],
 StyleBox["Mathematica",
  FontSize->18,
  FontSlant->"Italic"],
 StyleBox[" is that, unlike in LAMMPS where you have to manually calculate \
the derivative of the potential function and implement that separately to get \
the forces on each atom, ",
  FontSize->18],
 StyleBox["Mathematica",
  FontSize->18,
  FontSlant->"Italic"],
 StyleBox[" will calculate the derivative automatically and analytically and \
output what it thinks the forces should be. If there is disagreement between \
the energy of a particular potential term, then it is most likely an error in \
either the LAMMPS or ",
  FontSize->18],
 StyleBox["Mathematica",
  FontSize->18,
  FontSlant->"Italic"],
 StyleBox[" implementations and both must be checked. If there is agreement \
in the energies but disagreement in the forces then it is almost certainly a \
problem with the form of the forces being calculated in LAMMPS. If there is \
agreement to within machine precision in both the forces and the energies \
then, congratulations, you (most likely) have a working potential.\n\nCare \
must be taken that all the parameters used in the potentials are the same. \
Differences in the parameters can easily cause false negatives in the \
agreement between LAMMPS and ",
  FontSize->18],
 StyleBox["Mathematica",
  FontSize->18,
  FontSlant->"Italic"],
 StyleBox[". Because the derivatives are calculated analytically in ",
  FontSize->18],
 StyleBox["Mathematica",
  FontSize->18,
  FontSlant->"Italic"],
 StyleBox[", it can be quite slow, so a small protein should probably be \
used. In ",
  FontSize->18],
 StyleBox["Mathematica",
  FontSize->18,
  FontSlant->"Italic"],
 StyleBox[", each block that contains information that is going to be used \
later must be executed. Simply \[OpenCurlyDoubleQuote]being there\
\[CloseCurlyDoubleQuote] is not enough. For a typical tests, most of the \
blocks can be executed sequentially from top to bottom. Exceptions are noted \
in the comments at the top of the blocks.\n\nMost of the initial ",
  FontSize->18],
 StyleBox["Mathematica",
  FontSize->18,
  FontSlant->"Italic"],
 StyleBox[" code was written by Aram Davtyan (davtyan.aram@gmail.com) and \
most of the initial commenting was done by Nick Schafer (nschafer@ucsd.edu). \
All hail Aram, ",
  FontSize->18],
 StyleBox["Mathematica-",
  FontSize->18,
  FontSlant->"Italic"],
 StyleBox["man.",
  FontSize->18]
}], "Text",
 CellChangeTimes->{{3.512331963053382*^9, 3.512332007741375*^9}, {
  3.5123320617638483`*^9, 3.512332082951221*^9}, {3.512332422522584*^9, 
  3.512332771412112*^9}, {3.512332821642769*^9, 3.5123328996107903`*^9}, {
  3.5123329719186697`*^9, 3.512333128943853*^9}, {3.512333239722148*^9, 
  3.512333308884424*^9}, {3.512333367244809*^9, 3.512333367433116*^9}, {
  3.5123334203677073`*^9, 3.512333511994548*^9}, {3.5129328225443172`*^9, 
  3.5129328269707613`*^9}, {3.5137106624870453`*^9, 3.513710679429757*^9}}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"(*", " ", 
    RowBox[{"COPY", " ", "THE", " ", "COORDINATES", " ", "FROM", " ", 
     RowBox[{"forces", ".", "dat"}], " ", "GENERATED", " ", "BY", " ", 
     "LAMMPS", " ", "HERE"}], " ", "*)"}], "Text"], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"rca", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"43.19800186", ",", "5.46199989", ",", "36.83100128"}], "}"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"41.02899933", ",", "8.56700039", ",", "36.17900085"}], "}"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"37.68500137", ",", "7.97300005", ",", "34.40200043"}], "}"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"36.72000122", ",", "5.56199980", ",", "31.58799934"}], "}"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"33.37799835", ",", "7.04600000", ",", "30.82399940"}], "}"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"32.32699966", ",", "10.75300026", ",", "30.25499916"}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"29.85700035", ",", "13.09000015", ",", "32.06000137"}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"26.59900093", ",", "11.39999962", ",", "33.23400116"}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"23.10499954", ",", "12.68900013", ",", "32.19699860"}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"20.89500046", ",", "15.13799953", ",", "34.13199997"}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"17.88800049", ",", "12.75199986", ",", "33.88499832"}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"17.03100014", ",", "8.96000004", ",", "33.92699814"}], "}"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"15.19999981", ",", "6.37799978", ",", "31.79400063"}], "}"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"14.71899986", ",", "2.84200001", ",", "30.35300064"}], "}"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"14.48799992", ",", "0.43000001", ",", "27.45800018"}], "}"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"12.59700012", ",", 
         RowBox[{"-", "2.98300004"}], ",", "27.23500061"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"15.88000011", ",", 
         RowBox[{"-", "5.07100010"}], ",", "27.68499947"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"15.28400040", ",", 
         RowBox[{"-", "4.47900009"}], ",", "31.54400063"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"12.41100025", ",", 
         RowBox[{"-", "3.28099990"}], ",", "34.07300186"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"14.79899979", ",", 
         RowBox[{"-", "0.90700001"}], ",", "35.93500137"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"15.59200001", ",", "2.81100011", ",", "35.26300049"}], "}"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"19.13599968", ",", "4.22499990", ",", "34.62200165"}], "}"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"20.93700027", ",", "7.58400011", ",", "34.08200073"}], "}"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"20.43499947", ",", "8.71199989", ",", "30.39299965"}], "}"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"19.51099968", ",", "5.01399994", ",", "29.69899940"}], "}"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"23.37599945", ",", "4.35200024", ",", "29.72100067"}], 
        "}"}]}], "}"}]}], ";"}], "\n", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"rcb", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"44.66600037", ",", "5.30999994", ",", "36.26100159"}], "}"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"41.95600128", ",", "9.33099737", ",", "33.54702653"}], "}"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"36.62900162", ",", "9.07400036", ",", "34.45000076"}], "}"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"36.92100143", ",", "4.29159086", ",", "28.88836590"}], "}"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"32.20700073", ",", "6.30800009", ",", "31.52099991"}], "}"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"32.48300171", ",", "11.14590089", ",", "27.84385280"}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"30.99699974", ",", "13.26522480", ",", "30.75693041"}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"26.31900024", ",", "10.92199993", ",", "34.71200180"}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"24.22999954", ",", "12.30834339", ",", "29.08143550"}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"20.81500053", ",", "16.49099922", ",", "33.37200165"}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"19.12599945", ",", "12.13734295", ",", "32.05389107"}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"16.98399925", ",", "8.46199989", ",", "35.37900162"}], "}"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"16.12400055", ",", "6.23561796", ",", "29.09831203"}], "}"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"14.64900017", ",", "1.56557471", ",", "29.04898797"}], "}"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"15.88899994", ",", "0.39899999", ",", "26.72100067"}], "}"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"11.75199986", ",", 
         RowBox[{"-", "3.30200005"}], ",", "25.93000031"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"17.14200020", ",", 
         RowBox[{"-", "4.62099981"}], ",", "27.02000046"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"16.59499931", ",", 
         RowBox[{"-", "4.07999992"}], ",", "32.18999863"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"11.52200031", ",", 
         RowBox[{"-", "4.37400007"}], ",", "34.74499893"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"16.11899948", ",", 
         RowBox[{"-", "1.40300000"}], ",", "36.55699921"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"14.47700024", ",", "3.70199990", ",", "35.76399994"}], "}"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"19.86100006", ",", "3.20799994", ",", "33.68299866"}], "}"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"22.24099922", ",", "7.93900013", ",", "34.98899841"}], "}"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"21.72299957", ",", "9.54899979", ",", "29.92499924"}], "}"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"18.44000053", ",", "4.96400023", ",", "28.62899971"}], "}"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"24.23299980", ",", "5.67500019", ",", "29.81900024"}], 
        "}"}]}], "}"}]}], ";"}], "\n", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ro", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"42.19400024", ",", "6.45699978", ",", "34.85100174"}], "}"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"39.11600113", ",", "7.21500015", ",", "36.61199951"}], "}"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"38.65599823", ",", "7.77199984", ",", "32.25799942"}], "}"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"35.32899857", ",", "5.50899982", ",", "29.64999962"}], "}"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"33.58499908", ",", "9.21000004", ",", "31.98500061"}], "}"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"30.66200066", ",", "10.43099976", ",", "31.88699913"}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"28.24900055", ",", "11.83600044", ",", "30.81999969"}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"25.62500000", ",", "13.53800011", ",", "32.63800049"}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"22.72200012", ",", "12.81099987", ",", "34.54100037"}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"18.85000038", ",", "14.94900036", ",", "35.40800095"}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"19.24799919", ",", "10.78400040", ",", "33.38800049"}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"14.85099983", ",", "8.89500046", ",", "32.81600189"}], "}"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"16.28400040", ",", "4.23699999", ",", "32.20700073"}], "}"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"13.78400040", ",", "3.16599989", ",", "28.11499977"}], "}"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"14.58199978", ",", 
         RowBox[{"-", "1.60200000"}], ",", "28.72999954"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"13.15699959", ",", 
         RowBox[{"-", "5.00099993"}], ",", "28.48200035"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"16.82200050", ",", 
         RowBox[{"-", "6.00299978"}], ",", "29.66799927"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"13.79599953", ",", 
         RowBox[{"-", "2.58400011"}], ",", "31.51099968"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"11.97399998", ",", 
         RowBox[{"-", "1.34099996"}], ",", "35.39699936"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"14.93900013", ",", "0.40599999", ",", "33.85599899"}], "}"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"17.54599953", ",", "2.95900011", ",", "36.68099976"}], "}"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"18.60799980", ",", "6.09399986", ",", "33.27299881"}], "}"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"21.77599907", ",", "6.69399977", ",", "32.06399918"}], "}"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"20.77099991", ",", "7.36299992", ",", "28.44499969"}], "}"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"20.95499992", ",", "3.49699998", ",", "28.42700005"}], "}"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"23.63800049", ",", "2.13899994", ",", "30.26899910"}], 
        "}"}]}], "}"}]}], ";"}], "\n", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"rn", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0.00000000", ",", "0.00000000", ",", "0.00000000"}], "}"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"41.85993738", ",", "7.45974526", ",", "36.74092489"}], "}"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"39.03398643", ",", "8.40089020", ",", "34.84923180"}], "}"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"36.82600085", ",", "6.31545291", ",", "32.82254185"}], "}"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"34.62929970", ",", "6.61510994", ",", "31.41137533"}], "}"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"32.60064414", ",", "9.24951718", ",", "30.20804601"}], "}"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"30.90027996", ",", "12.45580328", ",", "31.22036372"}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"27.86571472", ",", "12.13517372", ",", "33.11596353"}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"24.32388213", ",", "11.90849889", ",", "32.61584448"}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"21.62260808", ",", "14.38795476", ",", "33.12132023"}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"19.16144950", ",", "13.49579561", ",", "33.72102163"}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"17.03256949", ",", "10.45227189", ",", "34.00696579"}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"16.14928697", ",", "7.15694378", ",", "32.63414619"}], "}"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"14.66023274", ",", "4.29041790", ",", "30.70415962"}], "}"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"14.73051680", ",", "1.08610003", ",", "28.73408348"}], "}"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"13.14114309", ",", 
         RowBox[{"-", "1.59138702"}], ",", "27.06463960"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"14.80078921", ",", 
         RowBox[{"-", "4.07551610"}], ",", "27.31940786"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"15.28580024", ",", 
         RowBox[{"-", "4.48147215"}], ",", "30.02903932"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"13.54104946", ",", 
         RowBox[{"-", "3.98927595"}], ",", "33.32802667"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"14.17104598", ",", 
         RowBox[{"-", "1.97291797"}], ",", "35.13572398"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"15.33043888", ",", "1.46253607", ",", "35.84927919"}], "}"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"17.71998787", ",", "3.77751396", ",", "34.54863044"}], "}"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"20.50031107", ",", "6.23874306", ",", "34.49329553"}], "}"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"20.42803993", ",", "8.54252402", ",", "31.86398126"}], "}"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"19.72293154", ",", "6.36321992", ",", "30.26744547"}], "}"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"21.95951047", ",", "4.83077614", ",", "29.95105817"}], 
        "}"}]}], "}"}]}], ";"}], "\n", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"rcp", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"42.36600175", ",", "6.51106997", ",", "36.04220133"}], "}"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"39.62908739", ",", "7.99341823", ",", "35.90039832"}], "}"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"37.76991633", ",", "7.34189392", ",", "33.05248585"}], "}"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"35.48811869", ",", "5.89372685", ",", "30.78636144"}], "}"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"33.19746089", ",", "8.61178907", ",", "31.06296573"}], "}"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"31.21208514", ",", "11.19883307", ",", "31.20304667"}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"28.57520255", ",", "12.29031612", ",", "31.93785078"}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"25.46525630", ",", "12.38921290", ",", "32.79898934"}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"22.46270694", ",", "13.30367691", ",", "33.40414849"}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"19.53191044", ",", "14.51662087", ",", "34.48355090"}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"18.12316499", ",", "11.22915208", ",", "33.73533197"}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"15.90093496", ",", "8.33236511", ",", "33.06911393"}], "}"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"15.43492901", ",", "4.85977890", ",", "31.58793866"}], "}"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"14.36458005", ",", "2.37918397", ",", "28.95427725"}], "}"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"14.07378892", ",", 
         RowBox[{"-", "1.02432700"}], ",", "27.81390708"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"13.54826495", ",", 
         RowBox[{"-", "4.12145802"}], ",", "27.74103726"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"16.04232230", ",", 
         RowBox[{"-", "5.23105199"}], ",", "29.22840768"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"14.13119709", ",", 
         RowBox[{"-", "3.58917505"}], ",", "32.12772261"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"12.83190306", ",", 
         RowBox[{"-", "2.10036995"}], ",", "34.93557494"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"15.03029495", ",", "0.38820302", ",", "35.10972140"}], "}"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"17.05207378", ",", "3.19079806", ",", "35.56754353"}], "}"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"19.38974686", ",", "5.61431394", ",", "34.06207152"}], "}"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"21.08834870", ",", "7.56338995", ",", "32.56730698"}], "}"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"20.32571566", ",", "7.40994091", ",", "29.60460160"}], "}"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"20.88279870", ",", "4.37147302", ",", "29.29585791"}], "}"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"0.00000000", ",", "0.00000000", ",", "0.00000000"}], "}"}]}],
       "}"}]}], ";"}], "\n", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"rh", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0.00000000", ",", "0.00000000", ",", "0.00000000"}], "}"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"41.99801979", ",", "7.50443542", ",", "37.70208456"}], "}"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"39.44694983", ",", "9.02892626", ",", "34.27431846"}], "}"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"36.11054454", ",", "5.96751098", ",", "33.46279420"}], "}"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"34.75658860", ",", "6.92611396", ",", "32.32823919"}], "}"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"32.28751798", ",", "8.76797520", ",", "29.46370730"}], "}"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"31.34339954", ",", "13.07628953", ",", "30.66897816"}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"28.12787872", ",", "12.50126546", ",", "34.01854442"}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"24.19377437", ",", "10.98178472", ",", "32.74542237"}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"21.41259194", ",", "14.78640879", ",", "32.20445752"}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"19.71077955", ",", "13.14602722", ",", "32.97484278"}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"16.12446013", ",", "10.81025562", ",", "34.28730057"}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"16.99603707", ",", "6.70198350", ",", "32.83770261"}], "}"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"13.97481042", ",", "4.79184583", ",", "30.20404557"}], "}"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"15.19900652", ",", "0.45026810", ",", "29.41045787"}], "}"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"12.73034120", ",", 
         RowBox[{"-", "1.12632103"}], ",", "26.32521403"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"15.11767950", ",", 
         RowBox[{"-", "3.36637217"}], ",", "26.72155178"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"14.65634408", ",", 
         RowBox[{"-", "3.85825633"}], ",", "29.67556565"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"13.81060390", ",", 
         RowBox[{"-", "4.80011591"}], ",", "33.82662143"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"14.86424204", ",", 
         RowBox[{"-", "2.58497795"}], ",", "34.76395326"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"15.40438874", ",", "1.44943210", ",", "36.86089233"}], "}"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"17.32255607", ",", "3.96506992", ",", "33.64977706"}], "}"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"21.13184512", ",", "5.85274112", ",", "35.12994891"}], "}"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"19.87288844", ",", "9.24456416", ",", "32.26893590"}], "}"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"19.36324333", ",", "6.39985191", ",", "31.20308940"}], "}"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"21.90254830", ",", "5.53631218", ",", "30.65229406"}], 
        "}"}]}], "}"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.511798320180912*^9, 3.5117983202450314`*^9}, {
   3.5123207502160463`*^9, 3.512320781172483*^9}, {3.512320852239596*^9, 
   3.512320852366061*^9}, {3.512334055642219*^9, 3.5123340571629333`*^9}, {
   3.5123444087209787`*^9, 3.512344437571576*^9}, 3.512354398396409*^9, 
   3.5127587811106873`*^9, 3.512768157736011*^9, 3.512768927501512*^9, 
   3.512926414866827*^9, {3.512932849752404*^9, 3.5129329070154543`*^9}, 
   3.512941831241247*^9, 3.512947358604451*^9, 3.512947614171072*^9, 
   3.512947906850597*^9, 3.51301905855206*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "COPY", " ", "THE", " ", "FORCE", " ", "ARRAY", " ", "THAT", " ", "WAS", 
    " ", "CALCULATED", " ", "UP", " ", "TO", " ", "BUT", " ", "NOT", " ", 
    "INCLUDING", " ", "THE", " ", "POTENTIAL", " ", "THAT", " ", "YOU", " ", 
    "ARE", " ", "TRYING", " ", "TO", " ", "TEST", " ", "HERE"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"DON", "'"}], "T", " ", "FORGET", " ", "TO", " ", "RENAME", " ", 
    "THE", " ", "ARRAYS", " ", "BY", " ", "PUTTING", " ", "A", " ", 
    "\"\<0\>\"", " ", "AFTER", " ", "THEM"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"fca0", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1.65119579", ",", "0.40657705", ",", 
         RowBox[{"-", "0.64233337"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"11.55984144", ",", 
         RowBox[{"-", "1.19648059"}], ",", 
         RowBox[{"-", "25.34846543"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"1.44729560", ",", "0.55311658", ",", "2.25980497"}], "}"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"12.53305090", ",", 
         RowBox[{"-", "5.53621316"}], ",", 
         RowBox[{"-", "25.66188203"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "2.59451408"}], ",", "6.38600718", ",", "4.62823925"}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"5.45218722", ",", "3.19574990", ",", 
         RowBox[{"-", "16.72076176"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"6.53831213", ",", 
         RowBox[{"-", "10.65709558"}], ",", 
         RowBox[{"-", "7.79197837"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"3.34416251", ",", "2.44523184", ",", 
         RowBox[{"-", "6.09521491"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"21.38643276", ",", "8.44542587", ",", 
         RowBox[{"-", "24.89192846"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"5.61086356", ",", 
         RowBox[{"-", "14.33793873"}], ",", 
         RowBox[{"-", "0.52322691"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"14.09346656", ",", 
         RowBox[{"-", "6.40390159"}], ",", 
         RowBox[{"-", "19.07191607"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "14.80892186"}], ",", "2.94735044", ",", 
         RowBox[{"-", "4.34595046"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"11.76539415", ",", 
         RowBox[{"-", "3.59196714"}], ",", 
         RowBox[{"-", "37.18239509"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"2.84576326", ",", "5.23325957", ",", 
         RowBox[{"-", "0.09475590"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"13.54178628", ",", 
         RowBox[{"-", "5.91344767"}], ",", 
         RowBox[{"-", "3.81553687"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"10.01380380", ",", 
         RowBox[{"-", "5.73430216"}], ",", "18.07643073"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "10.17249509"}], ",", "8.43042063", ",", "3.60601249"}],
         "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"6.12357961", ",", "16.59849891", ",", "1.82221466"}], "}"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"2.46807676", ",", "3.57701973", ",", 
         RowBox[{"-", "10.35421682"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "5.46752409"}], ",", 
         RowBox[{"-", "2.93132766"}], ",", 
         RowBox[{"-", "7.54629282"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "5.13726264"}], ",", 
         RowBox[{"-", "3.10223573"}], ",", "4.46214818"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "6.53850100"}], ",", 
         RowBox[{"-", "5.40712401"}], ",", "2.23282886"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"11.54913523", ",", 
         RowBox[{"-", "10.15231986"}], ",", "0.67525706"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"9.01842176", ",", 
         RowBox[{"-", "9.60362814"}], ",", "1.24988306"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"5.51836683", ",", "7.41900055", ",", 
         RowBox[{"-", "2.59543386"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "11.49686852"}], ",", "1.83628901", ",", 
         RowBox[{"-", "3.17632189"}]}], "}"}]}], "}"}]}], ";"}], "\n", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"fcb0", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "4.21809702"}], ",", "1.87566065", ",", 
         RowBox[{"-", "0.02363819"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "8.67132599"}], ",", 
         RowBox[{"-", "7.14655117"}], ",", "24.61991295"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"2.41297393", ",", 
         RowBox[{"-", "0.40292612"}], ",", "0.58437111"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1.94976210"}], ",", "12.32334633", ",", 
         "26.18725104"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0.26471740", ",", "1.55929568", ",", 
         RowBox[{"-", "0.36985260"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1.15720957"}], ",", 
         RowBox[{"-", "2.91450252"}], ",", "17.88567286"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "2.62300803"}], ",", 
         RowBox[{"-", "0.40317185"}], ",", "2.99821703"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"3.20674615", ",", "5.13859733", ",", 
         RowBox[{"-", "3.80234928"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "12.10787416"}], ",", "4.09683903", ",", 
         "33.53141863"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "4.62782642"}], ",", "3.90920288", ",", "2.64193169"}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "8.13971672"}], ",", "4.04130640", ",", "12.03934315"}],
         "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "10.07000041"}], ",", "0.60295623", ",", "2.28742051"}],
         "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "8.50554453"}], ",", "1.31064279", ",", "24.81415699"}],
         "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0.21933537", ",", "3.99952073", ",", "4.08596234"}], "}"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1.38529277"}], ",", 
         RowBox[{"-", "1.41271969"}], ",", 
         RowBox[{"-", "0.00321466"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"5.58954992", ",", 
         RowBox[{"-", "1.35292482"}], ",", "5.81591302"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"1.51721530", ",", 
         RowBox[{"-", "0.38689278"}], ",", "0.63794294"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1.86957258"}], ",", 
         RowBox[{"-", "0.44857331"}], ",", 
         RowBox[{"-", "3.18283874"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"3.95812068", ",", "4.82522079", ",", 
         RowBox[{"-", "0.69431911"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1.33643431"}], ",", "0.96661239", ",", 
         RowBox[{"-", "1.38569835"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"3.67454157", ",", "1.58064761", ",", 
         RowBox[{"-", "0.28015657"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0.90351983", ",", 
         RowBox[{"-", "3.77288490"}], ",", 
         RowBox[{"-", "1.34955871"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "5.54835864"}], ",", 
         RowBox[{"-", "2.19201517"}], ",", 
         RowBox[{"-", "8.38520645"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "9.36506198"}], ",", 
         RowBox[{"-", "16.02058376"}], ",", 
         RowBox[{"-", "5.98655109"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"4.18844358", ",", "0.23546977", ",", "1.90439132"}], "}"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"1.26350499", ",", 
         RowBox[{"-", "3.96148305"}], ",", 
         RowBox[{"-", "1.36993116"}]}], "}"}]}], "}"}]}], ";"}], "\n", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"fo0", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "0.97971278"}], ",", "3.13332354", ",", "2.85488380"}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "3.00836083"}], ",", "2.16552814", ",", 
         RowBox[{"-", "4.65076292"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "9.69058705"}], ",", 
         RowBox[{"-", "4.72778252"}], ",", 
         RowBox[{"-", "4.72462811"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "3.37309537"}], ",", "2.76301280", ",", "3.66531054"}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"7.81962424", ",", 
         RowBox[{"-", "9.23535927"}], ",", 
         RowBox[{"-", "0.71375981"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"4.55907228", ",", 
         RowBox[{"-", "3.37997577"}], ",", "5.98864160"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "21.48008897"}], ",", "7.15614592", ",", "1.41661420"}],
         "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "5.33478798"}], ",", 
         RowBox[{"-", "0.72664593"}], ",", "6.40751781"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "5.90231232"}], ",", "8.53673810", ",", 
         RowBox[{"-", "1.38195458"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0.72740182", ",", 
         RowBox[{"-", "3.94898801"}], ",", 
         RowBox[{"-", "4.84290039"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "6.79401533"}], ",", 
         RowBox[{"-", "1.17299587"}], ",", "4.95584096"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"1.36731682", ",", 
         RowBox[{"-", "1.39397626"}], ",", "10.31902455"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "11.34289179"}], ",", 
         RowBox[{"-", "2.08211862"}], ",", 
         RowBox[{"-", "3.59081506"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"1.56031797", ",", 
         RowBox[{"-", "5.35919375"}], ",", "2.99306472"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "17.39743204"}], ",", "13.18160011", ",", 
         RowBox[{"-", "7.19342255"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"5.83793355", ",", "8.74374639", ",", 
         RowBox[{"-", "14.50188348"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "11.86656052"}], ",", 
         RowBox[{"-", "2.25853990"}], ",", 
         RowBox[{"-", "0.76108005"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "7.59899407"}], ",", 
         RowBox[{"-", "13.97112953"}], ",", "20.37032155"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"9.12708798", ",", 
         RowBox[{"-", "6.78998574"}], ",", "0.02073513"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"6.79222758", ",", "1.95239662", ",", "4.61352318"}], "}"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"1.61888821", ",", "3.03279872", ",", 
         RowBox[{"-", "7.55402260"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"16.45819924", ",", "7.76897213", ",", "1.68234140"}], "}"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"1.99598112", ",", "8.82228436", ",", 
         RowBox[{"-", "3.30326015"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "3.33521544"}], ",", 
         RowBox[{"-", "4.39365099"}], ",", "7.63717528"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"4.10842963", ",", "5.44868571", ",", "3.38873033"}], "}"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"0.26294164", ",", 
         RowBox[{"-", "2.22094510"}], ",", "0.54996578"}], "}"}]}], "}"}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.5117983675998487`*^9, 3.511798376364098*^9}, {
   3.512320809937397*^9, 3.512320872585106*^9}, {3.512344502544957*^9, 
   3.512344504918571*^9}, 3.512354345077203*^9, {3.512354421910468*^9, 
   3.512354434568941*^9}, {3.512758729598061*^9, 3.512758742074319*^9}, 
   3.512761498935484*^9, {3.5127615296205177`*^9, 3.512761540441431*^9}, {
   3.5127681846423197`*^9, 3.512768192596807*^9}, {3.512768980350909*^9, 
   3.512768989418456*^9}, {3.5129264465569057`*^9, 3.512926503817889*^9}, {
   3.513542704308346*^9, 3.513542712466998*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "COPY", " ", "THE", " ", "FORCE", " ", "ARRAY", " ", "THAT", " ", "WAS", 
    " ", "CALCULATED", " ", "INCLUDING", " ", "THE", " ", "POTENTIAL", " ", 
    "THAT", " ", "YOU", " ", "ARE", " ", "TRYING", " ", "TO", " ", "TEST", 
    " ", "HERE"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"DON", "'"}], "T", " ", "FORGET", " ", "TO", " ", "RENAME", " ", 
    "THE", " ", "ARRAYS", " ", "BY", " ", "PUTTING", " ", "A", " ", 
    "\"\<1\>\"", " ", "AFTER", " ", "THEM"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"fca1", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1.65119579", ",", "0.40657705", ",", 
         RowBox[{"-", "0.64233337"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"11.55984144", ",", 
         RowBox[{"-", "1.19648059"}], ",", 
         RowBox[{"-", "25.34846543"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"1.44745149", ",", "0.55303570", ",", "2.25992562"}], "}"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"12.53305090", ",", 
         RowBox[{"-", "5.53621316"}], ",", 
         RowBox[{"-", "25.66188203"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "2.59451408"}], ",", "6.38600718", ",", "4.62823925"}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"5.45192665", ",", "3.19587164", ",", 
         RowBox[{"-", "16.72098449"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"6.53831213", ",", 
         RowBox[{"-", "10.65709558"}], ",", 
         RowBox[{"-", "7.79197837"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"3.37005011", ",", "2.45165068", ",", 
         RowBox[{"-", "6.09088238"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"21.39382462", ",", "8.45261153", ",", 
         RowBox[{"-", "24.87888016"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"5.61084083", ",", 
         RowBox[{"-", "14.30534946"}], ",", 
         RowBox[{"-", "0.51404435"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"14.10935578", ",", 
         RowBox[{"-", "6.41960112"}], ",", 
         RowBox[{"-", "19.08588082"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "14.86134469"}], ",", "2.98242948", ",", 
         RowBox[{"-", "4.30879675"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"11.77785707", ",", 
         RowBox[{"-", "3.56068680"}], ",", 
         RowBox[{"-", "37.23066418"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"2.86375952", ",", "5.25082920", ",", 
         RowBox[{"-", "0.11719692"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"13.55728933", ",", 
         RowBox[{"-", "5.90016817"}], ",", 
         RowBox[{"-", "3.80699041"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"10.01367913", ",", 
         RowBox[{"-", "5.73447520"}], ",", "18.07843513"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "10.17249509"}], ",", "8.43042063", ",", "3.60601249"}],
         "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"6.12334082", ",", "16.60072385", ",", "1.82120311"}], "}"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"2.47037557", ",", "3.58276678", ",", 
         RowBox[{"-", "10.35982583"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "5.46726144"}], ",", 
         RowBox[{"-", "2.94363605"}], ",", 
         RowBox[{"-", "7.52796648"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "5.13217485"}], ",", 
         RowBox[{"-", "3.10365380"}], ",", "4.46131740"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "6.48978259"}], ",", 
         RowBox[{"-", "5.45705406"}], ",", "2.24310073"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"11.62241959", ",", 
         RowBox[{"-", "10.19203568"}], ",", "0.66146906"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"8.96852617", ",", 
         RowBox[{"-", "9.63730605"}], ",", "1.22333784"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"5.49250401", ",", "7.38251351", ",", 
         RowBox[{"-", "2.59954571"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "11.49666029"}], ",", "1.83506065", ",", 
         RowBox[{"-", "3.17841866"}]}], "}"}]}], "}"}]}], ";"}], "\n", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"fcb1", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "4.21809702"}], ",", "1.87566065", ",", 
         RowBox[{"-", "0.02363819"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "8.67132599"}], ",", 
         RowBox[{"-", "7.14655117"}], ",", "24.61991295"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"2.41307862", ",", 
         RowBox[{"-", "0.40296698"}], ",", "0.58447319"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1.94976210"}], ",", "12.32334633", ",", 
         "26.18725104"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0.26452902", ",", "1.55946672", ",", 
         RowBox[{"-", "0.36979506"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1.15720957"}], ",", 
         RowBox[{"-", "2.91450252"}], ",", "17.88567286"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "2.62300803"}], ",", 
         RowBox[{"-", "0.40317185"}], ",", "2.99821703"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"3.22216683", ",", "5.13682054", ",", 
         RowBox[{"-", "3.79226306"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "12.10787416"}], ",", "4.09683903", ",", 
         "33.53141863"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "4.62746255"}], ",", "3.90642093", ",", "2.64055033"}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "8.13971672"}], ",", "4.04130640", ",", "12.03934315"}],
         "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "10.15886958"}], ",", "0.61653420", ",", "2.34324740"}],
         "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "8.50554453"}], ",", "1.31064279", ",", "24.81415699"}],
         "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0.21933537", ",", "3.99952073", ",", "4.08596234"}], "}"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1.37636109"}], ",", 
         RowBox[{"-", "1.39906945"}], ",", "0.00370322"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"5.58954992", ",", 
         RowBox[{"-", "1.35292482"}], ",", "5.81591302"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"1.51721530", ",", 
         RowBox[{"-", "0.38689278"}], ",", "0.63794294"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1.87066240"}], ",", 
         RowBox[{"-", "0.44463925"}], ",", 
         RowBox[{"-", "3.18350438"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"3.95820729", ",", "4.82533285", ",", 
         RowBox[{"-", "0.69492413"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1.33525663"}], ",", "0.96304152", ",", 
         RowBox[{"-", "1.38047959"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"3.68697112", ",", "1.59559292", ",", 
         RowBox[{"-", "0.28661784"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0.89219471", ",", 
         RowBox[{"-", "3.75873259"}], ",", 
         RowBox[{"-", "1.36444494"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "5.54565534"}], ",", 
         RowBox[{"-", "2.18466952"}], ",", 
         RowBox[{"-", "8.38588021"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "9.37599509"}], ",", 
         RowBox[{"-", "16.02973466"}], ",", 
         RowBox[{"-", "6.02751730"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"4.16821170", ",", "0.20055038", ",", "1.90094955"}], "}"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"1.25860540", ",", 
         RowBox[{"-", "3.93790786"}], ",", 
         RowBox[{"-", "1.34315534"}]}], "}"}]}], "}"}]}], ";"}], "\n", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"fo1", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "0.97971278"}], ",", "3.13332354", ",", "2.85488380"}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "3.00836083"}], ",", "2.16552814", ",", 
         RowBox[{"-", "4.65076292"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "9.69058705"}], ",", 
         RowBox[{"-", "4.72778252"}], ",", 
         RowBox[{"-", "4.72462811"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "3.37309537"}], ",", "2.76301280", ",", "3.66531054"}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"7.81962424", ",", 
         RowBox[{"-", "9.23535927"}], ",", 
         RowBox[{"-", "0.71375981"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"4.55907228", ",", 
         RowBox[{"-", "3.37997577"}], ",", "5.98864160"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "21.48008897"}], ",", "7.15614592", ",", "1.41661420"}],
         "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "5.33478798"}], ",", 
         RowBox[{"-", "0.72664593"}], ",", "6.40751781"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "5.90231232"}], ",", "8.53673810", ",", 
         RowBox[{"-", "1.38195458"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0.72740182", ",", 
         RowBox[{"-", "3.94898801"}], ",", 
         RowBox[{"-", "4.84290039"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "6.79401533"}], ",", 
         RowBox[{"-", "1.17299587"}], ",", "4.95584096"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"1.36731682", ",", 
         RowBox[{"-", "1.39397626"}], ",", "10.31902455"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "11.34289179"}], ",", 
         RowBox[{"-", "2.08211862"}], ",", 
         RowBox[{"-", "3.59081506"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"1.56031797", ",", 
         RowBox[{"-", "5.35919375"}], ",", "2.99306472"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "17.39743204"}], ",", "13.18160011", ",", 
         RowBox[{"-", "7.19342255"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"5.83793355", ",", "8.74374639", ",", 
         RowBox[{"-", "14.50188348"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "11.86656052"}], ",", 
         RowBox[{"-", "2.25853990"}], ",", 
         RowBox[{"-", "0.76108005"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "7.59899407"}], ",", 
         RowBox[{"-", "13.97112953"}], ",", "20.37032155"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"9.12708798", ",", 
         RowBox[{"-", "6.78998574"}], ",", "0.02073513"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"6.79222758", ",", "1.95239662", ",", "4.61352318"}], "}"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"1.61888821", ",", "3.03279872", ",", 
         RowBox[{"-", "7.55402260"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"16.45819924", ",", "7.76897213", ",", "1.68234140"}], "}"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"1.99598112", ",", "8.82228436", ",", 
         RowBox[{"-", "3.30326015"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "3.33521544"}], ",", 
         RowBox[{"-", "4.39365099"}], ",", "7.63717528"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"4.10842963", ",", "5.44868571", ",", "3.38873033"}], "}"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"0.26294164", ",", 
         RowBox[{"-", "2.22094510"}], ",", "0.54996578"}], "}"}]}], "}"}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.511798392167981*^9, 3.511798396976932*^9}, {
   3.512321201022827*^9, 3.512321233665188*^9}, {3.512344581438944*^9, 
   3.512344600547886*^9}, {3.5123544790394363`*^9, 3.51235448468552*^9}, {
   3.512758696860867*^9, 3.512758707968214*^9}, 3.5127614811263247`*^9, {
   3.51276154399411*^9, 3.512761547824424*^9}, {3.51276821187714*^9, 
   3.512768217069875*^9}, {3.5127690067473717`*^9, 3.5127690160493317`*^9}, {
   3.512926510406075*^9, 3.512926532111826*^9}, {3.512926607582354*^9, 
   3.5129266150663958`*^9}, {3.513542755673101*^9, 3.513542767577026*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "THIS", " ", "DIRECTORY", " ", "SHOULD", " ", "CONTAIN", " ", "THE", " ", 
    "PARAMETER", " ", "FILES", " ", "THAT", " ", "WERE", " ", "USED", " ", 
    "IN", " ", "THE", " ", "LAMMPS", " ", "SIMULATION"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
   "SetDirectory", "[", 
    "\"\</home/nschafer/lammpsamw/amnesiacmd/debugging/h4/\>\"", "]"}], 
   ";"}]}]], "Input",
 CellChangeTimes->{{3.5117197480160503`*^9, 3.5117197494880667`*^9}, {
  3.512309479799055*^9, 3.5123095136667624`*^9}, {3.51232123983422*^9, 
  3.5123212632084303`*^9}, {3.512920262916583*^9, 3.512920284558443*^9}, {
  3.5129203286558237`*^9, 3.512920332856193*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"I", "'"}], "M", " ", "NOT", " ", "SURE", " ", "WHAT", " ", 
     "THIS", " ", "IS", " ", "FOR"}], ",", " ", 
    RowBox[{
    "BUT", " ", "IT", " ", "SHOULD", " ", "NOT", " ", "BE", " ", "EXECUTED", 
     " ", "ON", " ", "A", " ", "TYPICAL", " ", "TEST"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"MyClear", "[", "A_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"B", "=", 
        RowBox[{"{", "}"}]}], "}"}], ",", 
      RowBox[{
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "1"}], ",", 
         RowBox[{"i", "\[LessEqual]", 
          RowBox[{"Length", "[", "A", "]"}]}], ",", 
         RowBox[{
          RowBox[{"B", "=", 
           RowBox[{"Append", "[", 
            RowBox[{"B", ",", 
             RowBox[{"A", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", 
                RowBox[{
                 RowBox[{"-", "3"}], ";;"}]}], "]"}], "]"}]}], " ", "]"}]}], 
          ";", 
          RowBox[{"i", "++"}]}]}], "]"}], ";", 
       RowBox[{"Return", "[", "B", "]"}]}]}], "]"}]}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{"rca", " ", "=", 
     RowBox[{"MyClear", "[", "rca", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"rcb", " ", "=", 
     RowBox[{"MyClear", "[", "rcb", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ro", " ", "=", 
     RowBox[{"MyClear", "[", "ro", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"fca", "=", 
     RowBox[{"MyClear", "[", 
      RowBox[{"fca1", "-", "fca0"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"fcb", "=", 
     RowBox[{"MyClear", "[", 
      RowBox[{"fcb1", "-", "fcb0"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"fo", "=", 
     RowBox[{"MyClear", "[", 
      RowBox[{"fo1", "-", "fo0"}], "]"}]}], ";"}]}]}]], "Input",
 CellOpen->False,
 CellChangeTimes->{{3.4689395345104523`*^9, 3.468939772553584*^9}, {
  3.468939885126484*^9, 3.468939950867543*^9}, {3.512321272798214*^9, 
  3.5123212954290247`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "THIS", " ", "BLOCK", " ", "ISOLATES", " ", "THE", " ", "FORCES", " ", 
    "THAT", " ", "ARE", " ", "DUE", " ", "TO", " ", "THE", " ", "PARTICULAR", 
    " ", "POTENTIAL", " ", "THAT", " ", "YOU", " ", "ARE", " ", "TESTING"}], 
   " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"fca", "=", 
    RowBox[{"fca1", "-", "fca0"}]}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{
    "fca1", " ", "IS", " ", "THE", " ", "TOTAL", " ", "CUMMULATIVE", " ", 
     "FORCE", " ", "FOR", " ", "ALL", " ", "POTENTIALS", " ", "UP", " ", "TO",
      " ", "AND", " ", "INCLUDING", " ", "THE", " ", "ONE", " ", "YOU", " ", 
     "ARE", " ", "TRYING", " ", "TO", " ", "TEST"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"fcb", "=", 
    RowBox[{"fcb1", "-", "fcb0"}]}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{
    "fca0", " ", "IS", " ", "THE", " ", "TOTAL", " ", "CUMMULATIVE", " ", 
     "FORCE", " ", "FOR", " ", "ALL", " ", "POTENTIALS", " ", "UP", " ", "TO",
      " ", "BUT", " ", "NOT", " ", "INCLUDING", " ", "THE", " ", "ONE", " ", 
     "YOU", " ", "ARE", " ", "TRYING", " ", "TO", " ", "TEST"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"fo", "=", 
    RowBox[{"fo1", "-", "fo0", " ", 
     RowBox[{"(*", " ", 
      RowBox[{
      "THEREFORE", " ", "fca", " ", "IS", " ", "THE", " ", "TOTAL", " ", 
       "FORCE", " ", "DUE", " ", "TO", " ", "THE", " ", "POTENTIAL", " ", 
       "THAT", " ", "YOU", " ", "ARE", " ", "TRYING", " ", "TO", " ", "TEST", 
       " ", "AND", " ", "LIKEWISE", " ", "FOR", " ", "THE", " ", "OTHER", " ",
        "ATOMS"}], " ", "*)"}]}]}]}]}]], "Input",
 CellChangeTimes->{{3.468954040626171*^9, 3.468954069185055*^9}, {
  3.4716984564339027`*^9, 3.471698467245936*^9}, {3.512316206321393*^9, 
  3.5123163497499866`*^9}, {3.512320148247431*^9, 3.512320154373982*^9}, {
  3.512321321857375*^9, 3.512321330960184*^9}, {3.5123536916185923`*^9, 
  3.512353694149489*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.`", ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.`", ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.00015589000000004738`", ",", 
     RowBox[{"-", "0.00008087999999994988`"}], ",", 
     "0.0001206500000003885`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.`", ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.`", ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.0002605700000000155`"}], ",", "0.00012173999999998131`", 
     ",", 
     RowBox[{"-", "0.00022273000000083698`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.`", ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.025887600000000344`", ",", "0.006418840000000259`", ",", 
     "0.004332530000000112`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.0073918599999984735`", ",", "0.007185660000001093`", ",", 
     "0.013048299999997681`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.000022730000000414918`"}], ",", "0.032589269999999004`", 
     ",", "0.00918255999999995`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.015889220000000037`", ",", 
     RowBox[{"-", "0.015699530000000017`"}], ",", 
     RowBox[{"-", "0.013964749999999526`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.052422829999999365`"}], ",", "0.03507903999999984`", ",",
      "0.03715371000000012`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.012462919999999045`", ",", "0.03128033999999991`", ",", 
     RowBox[{"-", "0.048269089999998016`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.017996259999999875`", ",", "0.01756962999999967`", ",", 
     RowBox[{"-", "0.022441019999999992`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.015503049999999519`", ",", "0.013279500000000333`", ",", 
     "0.008546459999999811`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.00012466999999993789`"}], ",", 
     RowBox[{"-", "0.00017303999999995767`"}], ",", 
     "0.0020044000000005724`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.`", ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.00023879000000004424`"}], ",", "0.0022249400000013964`", 
     ",", 
     RowBox[{"-", "0.0010115500000000832`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.0022988099999996514`", ",", "0.005747050000000087`", ",", 
     RowBox[{"-", "0.0056090100000005805`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.00026265000000069705`", ",", 
     RowBox[{"-", "0.012308389999999836`"}], ",", "0.018326339999999774`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.0050877900000001475`", ",", 
     RowBox[{"-", "0.00141807000000016`"}], ",", 
     RowBox[{"-", "0.0008307799999993648`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.04871841000000021`", ",", 
     RowBox[{"-", "0.049930049999999504`"}], ",", "0.01027186999999996`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.0732843600000006`", ",", 
     RowBox[{"-", "0.039715819999999624`"}], ",", 
     RowBox[{"-", "0.013787999999999911`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.04989559000000021`"}], ",", 
     RowBox[{"-", "0.033677909999999756`"}], ",", 
     RowBox[{"-", "0.026545220000000036`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.02586281999999951`"}], ",", 
     RowBox[{"-", "0.036487039999999915`"}], ",", 
     RowBox[{"-", "0.004111850000000139`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.00020823000000014247`", ",", 
     RowBox[{"-", "0.0012283600000000394`"}], ",", 
     RowBox[{"-", "0.002096770000000081`"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.5129266214696217`*^9, 3.513542791635504*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.`", ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.`", ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.00010468999999968531`", ",", 
     RowBox[{"-", "0.000040859999999975916`"}], ",", 
     "0.00010208000000000439`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.`", ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.000188379999999988`"}], ",", "0.0001710400000001222`", 
     ",", "0.00005753999999996706`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.`", ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.`", ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.015420680000000075`", ",", 
     RowBox[{"-", "0.0017767899999991954`"}], ",", "0.010086220000000257`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.`", ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.0003638700000001549`", ",", 
     RowBox[{"-", "0.002781950000000144`"}], ",", 
     RowBox[{"-", "0.0013813599999998871`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.`", ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.08886916999999883`"}], ",", "0.01357797000000005`", ",", 
     "0.05582689000000007`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.`", ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.`", ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.008931679999999886`", ",", "0.013650240000000036`", ",", 
     "0.0069178799999999995`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.`", ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.`", ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.001089820000000019`"}], ",", "0.003934060000000017`", 
     ",", 
     RowBox[{"-", "0.0006656399999998008`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.00008660999999987595`", ",", "0.00011205999999930327`", ",", 
     RowBox[{"-", "0.0006050199999999561`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.0011776800000000698`", ",", 
     RowBox[{"-", "0.0035708700000000038`"}], ",", "0.005218759999999989`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.01242954999999979`", ",", "0.0149453100000001`", ",", 
     RowBox[{"-", "0.006461270000000019`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.011325120000000077`"}], ",", "0.014152310000000057`", 
     ",", 
     RowBox[{"-", "0.014886230000000111`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.002703300000000297`", ",", "0.007345649999999981`", ",", 
     RowBox[{"-", "0.0006737599999997457`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.010933109999999857`"}], ",", 
     RowBox[{"-", "0.009150899999998074`"}], ",", 
     RowBox[{"-", "0.04096621000000056`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.020231880000000757`"}], ",", 
     RowBox[{"-", "0.034919389999999995`"}], ",", 
     RowBox[{"-", "0.0034417700000000107`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.004899589999999954`"}], ",", "0.023575189999999857`", 
     ",", "0.026775819999999895`"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.5129266214696217`*^9, 3.5135427916379766`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.`", ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.`", ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.`", ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.`", ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.`", ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.`", ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.`", ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.`", ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.`", ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.`", ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.`", ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.`", ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.`", ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.`", ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.`", ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.`", ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.`", ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.`", ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.`", ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.`", ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.`", ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.`", ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.`", ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.`", ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.`", ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.`", ",", "0.`"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.5129266214696217`*^9, 3.513542791639963*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "THIS", " ", "MAPS", " ", "EACH", " ", "LETTER", " ", "OF", " ", "THE", 
    " ", "ALPHABET", " ", "TO", " ", "THE", " ", "ONE", " ", "LETTER", " ", 
    "AMINO", " ", "ACID", " ", "CODE"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"resmap", "=", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "4", ",", "3", ",", "6", ",", "13", ",", "7", ",", 
       "8", ",", "9", ",", "0", ",", "11", ",", "10", ",", "12", ",", "2", 
       ",", "0", ",", "14", ",", "5", ",", "1", ",", "15", ",", "16", ",", 
       "0", ",", "19", ",", "17", ",", "0", ",", "18", ",", "0"}], "}"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "THIS", " ", "IS", " ", "THE", " ", "ONE", " ", "LETTER", " ", "SEQUENCE",
      " ", "OF", " ", "THE", " ", "PROTEIN", " ", "THAT", " ", "YOU", " ", 
     "ARE", " ", "USING", " ", "TO", " ", "TEST"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"seq", "=", "\"\<SGRGKGGKGLGKGGAKRARKVLRDNQ\>\""}], ";"}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{
    "THIS", " ", "PARTICULAR", " ", "SEQUENCE", " ", "IS", " ", "THAT", " ", 
     "OF", " ", "H4", " ", "HISTONE", " ", "TAIL", " ", "PROTEIN"}], " ", 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "THESE", " ", "LINES", " ", "CREATE", " ", "AN", " ", "ARRAY", " ", "se", 
     " ", "THAT", " ", "CONVERTS", " ", "THE", " ", "INPUT", " ", "SEQUENCE", 
     " ", "ABOVE", " ", "USING", " ", "THE", " ", "resmap", " ", "ARRAY", " ",
      "FROM", " ", "A", " ", "ONE", " ", "LETTER", " ", "CODE", " ", "TO", 
     " ", "A", " ", "NUMBER", " ", "CODE"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"chseq", "=", 
     RowBox[{"Characters", "[", "seq", "]"}]}], ";"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{"M", "=", 
     RowBox[{"Length", "[", "chseq", "]"}]}], ";"}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{
    "CALCULATES", " ", "THE", " ", "LENGTH", " ", "OF", " ", "THE", " ", 
     "INPUT", " ", "SEQUENCE", " ", "DEFINED", " ", "ABOVE"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"se", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"index", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"ToCharacterCode", "[", "seq", "]"}], "[", 
           RowBox[{"[", "i", "]"}], "]"}], "-", 
          RowBox[{
           RowBox[{"ToCharacterCode", "[", "\"\<A\>\"", "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}], "+", "1"}]}], ";", 
        RowBox[{
         RowBox[{"resmap", "[", 
          RowBox[{"[", "index", "]"}], "]"}], "+", "1"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "M"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "THESE", " ", "ARE", " ", "TWO", " ", "POSSIBLE", " ", "CHOICES", " ", 
     "OF", " ", "COEFFICIENTS", " ", "FOR", " ", "CALCULATING", " ", "THE", 
     " ", "POSITIONS", " ", "OF", " ", "THE", " ", "MISSING", " ", "ATOMS"}], 
    " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"an", "=", "0.4831806"}], ";", 
    RowBox[{"bn", "=", "0.7032820"}], ";", 
    RowBox[{"cn", "=", 
     RowBox[{"-", "0.1864262"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"ap", "=", "0.4436538"}], ";", 
    RowBox[{"bp", "=", "0.2352006"}], ";", 
    RowBox[{"cp", "=", "0.3211455"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"ah", "=", "0.8409657"}], ";", 
    RowBox[{"bh", "=", "0.8929599"}], ";", 
    RowBox[{"ch", "=", 
     RowBox[{"-", "0.7338894"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "SINCE", " ", "THESE", " ", "ARE", " ", "EXECUTED", " ", "LAST"}], ",", 
     " ", 
     RowBox[{
     "THESE", " ", "ARE", " ", "THE", " ", "VALUES", " ", "THAT", " ", "ARE", 
      " ", "USED", " ", "AND", " ", "SHOULD", " ", "MATCH", " ", "THOSE", " ",
       "IN", " ", "LAMMPS"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"an", "=", "0.483"}], ";", " ", 
    RowBox[{"bn", "=", " ", "0.703"}], ";", " ", 
    RowBox[{"cn", "=", " ", 
     RowBox[{"-", "0.186"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"ap", "=", "0.444"}], ";", " ", 
    RowBox[{"bp", "=", " ", "0.235"}], ";", " ", 
    RowBox[{"cp", "=", " ", "0.321"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"ah", "=", "0.841"}], ";", " ", 
    RowBox[{"bh", "=", " ", "0.893"}], ";", " ", 
    RowBox[{"ch", "=", 
     RowBox[{"-", "0.734"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "THESE", " ", "LINES", " ", "DEFINE", " ", "PARAMETERS", " ", "EITHER", 
     " ", "DIRECTLY", " ", "OR", " ", "BY", " ", "READING", " ", "FILES", " ",
      "THAT", " ", "ARE", " ", "IN", " ", "THE", " ", "DIRECTORY", " ", 
     "SPECIFIED", " ", "ABOVE"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"rNOzero", "=", "2.98"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"rHOzero", "=", "2.06"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Sigma]NO", "=", "0.68"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Sigma]HO", "=", "0.76"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"dnu", "=", "12.0"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"pref", "=", "0.5"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"cutoff", " ", "=", " ", "7.0"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"hbscl", "=", 
      RowBox[{"{", 
       RowBox[{
       "1.0", ",", " ", "1.0", ",", " ", "1.0", ",", " ", "1.0", ",", " ", 
        "4.0", ",", " ", "1.0", ",", " ", "1.0", ",", " ", "1.0", ",", " ", 
        "4.0", ",", " ", "4.0", ",", " ", "1.0", ",", " ", "1.0", ",", " ", 
        "1.0", ",", " ", "1.0", ",", " ", "1.0", ",", " ", "1.0", ",", " ", 
        "1.0"}], "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"hbscl", "=", 
      RowBox[{"{", 
       RowBox[{
       "0.0", ",", " ", "0.0", ",", " ", "1.0", ",", " ", "0.0", ",", " ", 
        "4.0", ",", " ", "0.0", ",", " ", "1.0", ",", " ", "0.0", ",", " ", 
        "4.0", ",", " ", "4.0", ",", " ", "1.0", ",", " ", "1.0", ",", " ", 
        "1.0", ",", " ", "1.0", ",", " ", "1.0", ",", " ", "1.0", ",", " ", 
        "1.0"}], "}"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"hbscl", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0.0", ",", " ", "0.0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
        "1.37", ",", " ", "0.0", ",", " ", "3.89", ",", " ", "1.30", ",", " ",
          "1.32", ",", " ", "1.22", ",", " ", "0.0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
        "1.36", ",", " ", "0.0", ",", " ", "3.50", ",", " ", "1.30", ",", " ",
          "1.32", ",", " ", "1.22", ",", " ", "3.47", ",", " ", "0.33", ",", 
         " ", "1.01"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
        "1.17", ",", " ", "0.0", ",", " ", "3.52", ",", " ", "1.30", ",", " ",
          "1.32", ",", " ", "1.22", ",", " ", "3.62", ",", " ", "0.33", ",", 
         " ", "1.01"}], "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "THE", " ", "FILES", " ", "READ", " ", "HERE", " ", "SHOULD", " ", "BE", 
     " ", "IDENTICAL", " ", "TO", " ", "THOSE", " ", "USED", " ", "IN", " ", 
     "THE", " ", "LAMMPS", " ", "SIMULATIONS"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"antiHB", "=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"A", ",", "A1", ",", "A2"}], "}"}], ",", 
       RowBox[{
        RowBox[{"A", "=", 
         RowBox[{"StringSplit", "[", 
          RowBox[{"ReadList", "[", 
           RowBox[{"\"\<anti_HB\>\"", ",", "String"}], "]"}], "]"}]}], ";", 
        RowBox[{"A1", "=", 
         RowBox[{"A", "[", 
          RowBox[{"[", 
           RowBox[{";;", "20"}], "]"}], "]"}]}], ";", 
        RowBox[{"A2", "=", 
         RowBox[{"A", "[", 
          RowBox[{"[", 
           RowBox[{"22", ";;"}], "]"}], "]"}]}], ";", 
        RowBox[{"ToExpression", "[", 
         RowBox[{"{", 
          RowBox[{"A1", ",", "A2"}], "}"}], "]"}]}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"antiNHB", "=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"A", ",", "A1", ",", "A2"}], "}"}], ",", 
       RowBox[{
        RowBox[{"A", "=", 
         RowBox[{"StringSplit", "[", 
          RowBox[{"ReadList", "[", 
           RowBox[{"\"\<anti_NHB\>\"", ",", "String"}], "]"}], "]"}]}], ";", 
        RowBox[{"A1", "=", 
         RowBox[{"A", "[", 
          RowBox[{"[", 
           RowBox[{";;", "20"}], "]"}], "]"}]}], ";", 
        RowBox[{"A2", "=", 
         RowBox[{"A", "[", 
          RowBox[{"[", 
           RowBox[{"22", ";;"}], "]"}], "]"}]}], ";", 
        RowBox[{"ToExpression", "[", 
         RowBox[{"{", 
          RowBox[{"A1", ",", "A2"}], "}"}], "]"}]}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"paraHB", "=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"A", ",", "A1", ",", "A2"}], "}"}], ",", 
       RowBox[{
        RowBox[{"A", "=", 
         RowBox[{"StringSplit", "[", 
          RowBox[{"ReadList", "[", 
           RowBox[{"\"\<para_HB\>\"", ",", "String"}], "]"}], "]"}]}], ";", 
        RowBox[{"A1", "=", 
         RowBox[{"A", "[", 
          RowBox[{"[", 
           RowBox[{";;", "20"}], "]"}], "]"}]}], ";", 
        RowBox[{"A2", "=", 
         RowBox[{"A", "[", 
          RowBox[{"[", 
           RowBox[{"22", ";;"}], "]"}], "]"}]}], ";", 
        RowBox[{"ToExpression", "[", 
         RowBox[{"{", 
          RowBox[{"A1", ",", "A2"}], "}"}], "]"}]}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"paraOne", "=", 
     RowBox[{"ReadList", "[", 
      RowBox[{"\"\<para_one\>\"", ",", "Real"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"antiOne", "=", 
     RowBox[{"ReadList", "[", 
      RowBox[{"\"\<anti_one\>\"", ",", "Real"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "WHEN", " ", "TESTING", " ", "THE", " ", "SECONDARY", " ", "STRUCTURE", 
      " ", "BIAS"}], ",", " ", 
     RowBox[{
     "IT", " ", "IS", " ", "NECESSARY", " ", "TO", " ", "INPUT", " ", "THE", 
      " ", "ssweight", " ", "FILE", " ", "HERE"}]}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ssweight5", "=", 
     RowBox[{"Table", "[", 
      RowBox[{"0.0", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "M"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ssweight6", "=", 
     RowBox[{"Table", "[", 
      RowBox[{"0.0", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "M"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ssweight5", "=", 
     RowBox[{"{", 
      RowBox[{
      "0.0", ",", "0.0", ",", "0.0", ",", "0.0", ",", "0.0", ",", "0.0", ",", 
       "0.0", ",", "1.0", ",", "1.0", ",", "1.0", ",", "0.0", ",", "0.0", ",",
        "0.0", ",", "0.0", ",", "1.0", ",", "1.0", ",", "1.0", ",", "1.0", 
       ",", "1.0", ",", "1.0", ",", "1.0", ",", "0.0", ",", "0.0", ",", "0.0",
        ",", "0.0", ",", "0.0"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ssweight6", "=", 
     RowBox[{"{", 
      RowBox[{
      "0.0", ",", "0.0", ",", "1.0", ",", "0.0", ",", "0.0", ",", "1.0", ",", 
       "0.0", ",", "0.0", ",", "1.0", ",", "0.0", ",", "0.0", ",", "1.0", ",",
        "0.0", ",", "0.0", ",", "1.0", ",", "0.0", ",", "0.0", ",", "1.0", 
       ",", "0.0", ",", "0.0", ",", "1.0", ",", "0.0", ",", "0.0", ",", "1.0",
        ",", "0.0", ",", "0.0"}], "}"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.468855041674871*^9, 3.468855079950027*^9}, {
   3.468855666605926*^9, 3.468855673900051*^9}, 3.468855709289034*^9, {
   3.468855745638946*^9, 3.468855829557212*^9}, {3.468855888638706*^9, 
   3.468855943278901*^9}, {3.4688576810114937`*^9, 3.468857684633127*^9}, {
   3.46885855303533*^9, 3.468858580761301*^9}, {3.468859141012412*^9, 
   3.468859145274663*^9}, {3.468859214252527*^9, 3.4688592331711807`*^9}, {
   3.468859979725029*^9, 3.46885999866171*^9}, {3.468860818095912*^9, 
   3.4688608360157146`*^9}, {3.468860933646689*^9, 3.468860942091736*^9}, {
   3.468861504985867*^9, 3.468861524727579*^9}, {3.468861960119812*^9, 
   3.468861960417213*^9}, {3.468935785699058*^9, 3.4689357869081783`*^9}, {
   3.4689361497449617`*^9, 3.468936212542829*^9}, {3.468936354506432*^9, 
   3.468936355251848*^9}, {3.46894268019945*^9, 3.4689426846410217`*^9}, 
   3.4704215988137207`*^9, {3.470422467249007*^9, 3.470422497914154*^9}, {
   3.470422776821528*^9, 3.470422801419194*^9}, {3.47042441676908*^9, 
   3.470424484888514*^9}, {3.470503754616066*^9, 3.470503755284004*^9}, {
   3.470507820837861*^9, 3.470507854574795*^9}, {3.4706652122045116`*^9, 
   3.470665213975938*^9}, {3.470704290766*^9, 3.470704300461*^9}, {
   3.471097821352539*^9, 3.471097834694333*^9}, {3.4729055995300703`*^9, 
   3.472905673556264*^9}, {3.472921774872183*^9, 3.472921775391543*^9}, {
   3.511719292462266*^9, 3.511719361249833*^9}, {3.5117277678340693`*^9, 
   3.511727800103484*^9}, 3.511727869234653*^9, {3.511727923766663*^9, 
   3.51172792509929*^9}, {3.5117280512682447`*^9, 3.511728053650504*^9}, {
   3.51173014931666*^9, 3.5117301502023907`*^9}, {3.511730197731691*^9, 
   3.511730199507243*^9}, {3.5123201646345787`*^9, 3.512320285482141*^9}, {
   3.512320320954728*^9, 3.5123204634327106`*^9}, {3.512320515247918*^9, 
   3.512320536041355*^9}, {3.512320581393486*^9, 3.5123207300306892`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"THIS", " ", "BLOCK", " ", "\"\<SETS THE RULES\>\""}], ",", " ", 
    RowBox[{
    "WHICH", " ", "MEANS", " ", "IT", " ", "TELLS", " ", "MATHEMATICA", " ", 
     "HOW", " ", "TO", " ", "EVALUATE", " ", "ALL", " ", "THE", " ", 
     "POTENTIALS", " ", "GIVEN", " ", "THE", " ", "INPUT", " ", "SPECIFIED", 
     " ", "ABOVE"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    SubscriptBox["r", 
     RowBox[{"u_", ",", "i_"}]], ":=", 
    RowBox[{"{", 
     RowBox[{
      SubscriptBox["x", 
       RowBox[{"u", ",", "i"}]], ",", 
      SubscriptBox["y", 
       RowBox[{"u", ",", "i"}]], ",", 
      SubscriptBox["z", 
       RowBox[{"u", ",", "i"}]]}], "}"}]}], "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["r", 
     RowBox[{"N", ",", "i_"}]], ":=", 
    RowBox[{
     RowBox[{"an", " ", 
      SubscriptBox["r", 
       RowBox[{"Ca", ",", 
        RowBox[{"i", "-", "1"}]}]]}], "+", 
     RowBox[{"bn", " ", 
      SubscriptBox["r", 
       RowBox[{"Ca", ",", "i"}]]}], "+", 
     RowBox[{"cn", " ", 
      SubscriptBox["r", 
       RowBox[{"O", ",", 
        RowBox[{"i", "-", "1"}]}]]}]}]}], "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["r", 
     RowBox[{"H", ",", "i_"}]], ":=", 
    RowBox[{
     RowBox[{"ah", " ", 
      SubscriptBox["r", 
       RowBox[{"Ca", ",", 
        RowBox[{"i", "-", "1"}]}]]}], "+", 
     RowBox[{"bh", " ", 
      SubscriptBox["r", 
       RowBox[{"Ca", ",", "i"}]]}], "+", 
     RowBox[{"ch", " ", 
      SubscriptBox["r", 
       RowBox[{"O", ",", 
        RowBox[{"i", "-", "1"}]}]]}]}]}], "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["r", 
     RowBox[{"Cp", ",", "i_"}]], ":=", 
    RowBox[{
     RowBox[{"ap", " ", 
      SubscriptBox["r", 
       RowBox[{"Ca", ",", "i"}]]}], "+", 
     RowBox[{"bp", " ", 
      SubscriptBox["r", 
       RowBox[{"Ca", ",", 
        RowBox[{"i", "+", "1"}]}]]}], "+", 
     RowBox[{"cp", " ", 
      SubscriptBox["r", 
       RowBox[{"O", ",", "i"}]]}]}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MyNorm", "[", "a_", "]"}], ":=", 
    SqrtBox[
     RowBox[{"Total", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        SuperscriptBox["ai", "2"], ",", 
        RowBox[{"{", 
         RowBox[{"ai", ",", "a"}], "}"}]}], "]"}], "]"}]]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"rule", "=", 
     RowBox[{"Flatten", "[", 
      RowBox[{"Append", "[", 
       RowBox[{
        RowBox[{"Append", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               SubscriptBox["r", 
                RowBox[{"Ca", ",", "i"}]], "[", 
               RowBox[{"[", "j", "]"}], "]"}], "\[Rule]", 
              RowBox[{"rca", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "j"}], "]"}], "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", "M"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", "1", ",", "3"}], "}"}]}], "]"}], ",", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               SubscriptBox["r", 
                RowBox[{"Cb", ",", "i"}]], "[", 
               RowBox[{"[", "j", "]"}], "]"}], "\[Rule]", 
              RowBox[{"rcb", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "j"}], "]"}], "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", "M"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", "1", ",", "3"}], "}"}]}], "]"}]}], "]"}], ",", 
        
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             SubscriptBox["r", 
              RowBox[{"O", ",", "i"}]], "[", 
             RowBox[{"[", "j", "]"}], "]"}], "\[Rule]", 
            RowBox[{"ro", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "j"}], "]"}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "M"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "1", ",", "3"}], "}"}]}], "]"}]}], "]"}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"rule", "=", 
     RowBox[{"Flatten", "[", 
      RowBox[{"Append", "[", 
       RowBox[{
        RowBox[{"Append", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               SubscriptBox["r", 
                RowBox[{"Ca", ",", "i"}]], "[", 
               RowBox[{"[", "j", "]"}], "]"}], "\[Rule]", 
              RowBox[{"rca", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "j"}], "]"}], "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", "M"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", "1", ",", "3"}], "}"}]}], "]"}], ",", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               SubscriptBox["r", 
                RowBox[{"Cb", ",", "i"}]], "[", 
               RowBox[{"[", "j", "]"}], "]"}], "\[Rule]", 
              RowBox[{"rcb", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "j"}], "]"}], "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", "M"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", "1", ",", "3"}], "}"}]}], "]"}]}], "]"}], ",", 
        
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             SubscriptBox["r", 
              RowBox[{"O", ",", "i"}]], "[", 
             RowBox[{"[", "j", "]"}], "]"}], "\[Rule]", 
            RowBox[{"ro", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "j"}], "]"}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "M"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "1", ",", "3"}], "}"}]}], "]"}]}], "]"}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"rulee", "[", 
     RowBox[{"a_", ",", "i_"}], "]"}], ":=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"rule", "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{"3", "M", 
          RowBox[{"(", 
           RowBox[{"a", "-", "1"}], ")"}]}], "+", 
         RowBox[{"3", 
          RowBox[{"(", 
           RowBox[{"i", "-", "1"}], ")"}]}], "+", "1"}], "]"}], "]"}], ",", 
      RowBox[{"rule", "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{"3", "M", 
          RowBox[{"(", 
           RowBox[{"a", "-", "1"}], ")"}]}], "+", 
         RowBox[{"3", 
          RowBox[{"(", 
           RowBox[{"i", "-", "1"}], ")"}]}], "+", "2"}], "]"}], "]"}], ",", 
      RowBox[{"rule", "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{"3", "M", 
          RowBox[{"(", 
           RowBox[{"a", "-", "1"}], ")"}]}], "+", 
         RowBox[{"3", 
          RowBox[{"(", 
           RowBox[{"i", "-", "1"}], ")"}]}], "+", "3"}], "]"}], "]"}]}], 
     "}"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"rules", "[", 
     RowBox[{"a_", ",", "i_"}], "]"}], ":=", 
    RowBox[{"Delete", "[", 
     RowBox[{"rule", ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"3", "M", 
           RowBox[{"(", 
            RowBox[{"a", "-", "1"}], ")"}]}], "+", 
          RowBox[{"3", 
           RowBox[{"(", 
            RowBox[{"i", "-", "1"}], ")"}]}], "+", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"3", "M", 
           RowBox[{"(", 
            RowBox[{"a", "-", "1"}], ")"}]}], "+", 
          RowBox[{"3", 
           RowBox[{"(", 
            RowBox[{"i", "-", "1"}], ")"}]}], "+", "2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"3", "M", 
           RowBox[{"(", 
            RowBox[{"a", "-", "1"}], ")"}]}], "+", 
          RowBox[{"3", 
           RowBox[{"(", 
            RowBox[{"i", "-", "1"}], ")"}]}], "+", "3"}], "}"}]}], "}"}]}], 
     "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Ruless", "[", "a_", "]"}], ":=", 
     RowBox[{"Flatten", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"a", "\[Equal]", "1"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             SubscriptBox["r", 
              RowBox[{"Ca", ",", "i"}]], "[", 
             RowBox[{"[", "j", "]"}], "]"}], "\[Rule]", 
            RowBox[{"rca", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "j"}], "]"}], "]"}]}], "}"}], ",", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"a", "\[Equal]", "2"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               SubscriptBox["r", 
                RowBox[{"Cb", ",", "i"}]], "[", 
               RowBox[{"[", "j", "]"}], "]"}], "\[Rule]", 
              RowBox[{"rcb", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "j"}], "]"}], "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               SubscriptBox["r", 
                RowBox[{"O", ",", "i"}]], "[", 
               RowBox[{"[", "j", "]"}], "]"}], "\[Rule]", 
              RowBox[{"ro", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "j"}], "]"}], "]"}]}], "}"}]}], "]"}]}], 
         "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "M"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", "3"}], "}"}]}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Rulee", "[", 
     RowBox[{"a_", ",", "i_"}], "]"}], ":=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"Ruless", "[", "a", "]"}], "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{"3", 
          RowBox[{"(", 
           RowBox[{"i", "-", "1"}], ")"}]}], "+", "1"}], "]"}], "]"}], ",", 
      RowBox[{
       RowBox[{"Ruless", "[", "a", "]"}], "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{"3", 
          RowBox[{"(", 
           RowBox[{"i", "-", "1"}], ")"}]}], "+", "2"}], "]"}], "]"}], ",", 
      RowBox[{
       RowBox[{"Ruless", "[", "a", "]"}], "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{"3", 
          RowBox[{"(", 
           RowBox[{"i", "-", "1"}], ")"}]}], "+", "3"}], "]"}], "]"}]}], 
     "}"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Rules", "[", 
     RowBox[{"a_", ",", "i_"}], "]"}], ":=", 
    RowBox[{"Delete", "[", 
     RowBox[{
      RowBox[{"Ruless", "[", "a", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"3", 
           RowBox[{"(", 
            RowBox[{"i", "-", "1"}], ")"}]}], "+", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"3", 
           RowBox[{"(", 
            RowBox[{"i", "-", "1"}], ")"}]}], "+", "2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"3", 
           RowBox[{"(", 
            RowBox[{"i", "-", "1"}], ")"}]}], "+", "3"}], "}"}]}], "}"}]}], 
     "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.468854673666232*^9, 3.468854684512622*^9}, {
  3.468854902951829*^9, 3.468854932950259*^9}, {3.46885839650323*^9, 
  3.468858396977489*^9}, {3.468860186729788*^9, 3.4688601872483377`*^9}, {
  3.472411610493401*^9, 3.472411621584505*^9}, {3.512321382434227*^9, 
  3.5123214118001003`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "THIS", " ", "BLOCK", " ", "DEFINES", " ", "THE", " ", "DSSP", " ", 
    "POTENTIAL"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"iRepulsive", "[", 
     RowBox[{"i_", ",", "j_"}], "]"}], ":=", 
    RowBox[{"If", " ", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"j", "\[Equal]", "M"}], "  ", "||", " ", 
       RowBox[{
        RowBox[{"se", "[", 
         RowBox[{"[", 
          RowBox[{"j", "+", "1"}], "]"}], "]"}], "\[Equal]", "15"}]}], ",", 
      " ", "False", ",", " ", "True"}], "]"}]}], "\n", 
   RowBox[{
    RowBox[{"iAP", "[", 
     RowBox[{"i_", ",", "j_"}], "]"}], ":=", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"i", "\[Equal]", "1"}], " ", "||", " ", 
       RowBox[{"j", "\[Equal]", "M"}], " ", "||", " ", 
       RowBox[{
        RowBox[{"se", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "\[Equal]", "15"}]}], ",", "False", 
      ",", " ", "True"}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"iP", "[", 
     RowBox[{"i_", ",", "j_"}], "]"}], ":=", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"i", "\[Equal]", 
        RowBox[{"M", "-", "1"}]}], " ", "||", " ", 
       RowBox[{"j", "\[Equal]", "M"}], " ", "||", " ", 
       RowBox[{
        RowBox[{"se", "[", 
         RowBox[{"[", 
          RowBox[{"i", "+", "2"}], "]"}], "]"}], "\[Equal]", "15"}]}], ",", 
      "False", ",", " ", "True"}], "]"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"thetaSeqAntiHB", "[", 
     RowBox[{"i_", ",", "j_", ",", "k_"}], "]"}], ":=", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"iAP", "[", 
        RowBox[{"i", ",", "j"}], "]"}], "\[Equal]", "True"}], ",", 
      RowBox[{"0.5", "*", 
       RowBox[{"antiHB", "[", 
        RowBox[{"[", 
         RowBox[{"k", ",", 
          RowBox[{"se", "[", 
           RowBox[{"[", "i", "]"}], "]"}], ",", 
          RowBox[{"se", "[", 
           RowBox[{"[", "j", "]"}], "]"}]}], "]"}], "]"}]}], ",", "0.0"}], 
     "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"thetaSeqAntiNHB", "[", 
     RowBox[{"i_", ",", "j_", ",", "k_"}], "]"}], ":=", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"iAP", "[", 
        RowBox[{"i", ",", "j"}], "]"}], "\[Equal]", "True"}], ",", 
      RowBox[{"0.25", "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"antiNHB", "[", 
          RowBox[{"[", 
           RowBox[{"k", ",", 
            RowBox[{"se", "[", 
             RowBox[{"[", 
              RowBox[{"i", "+", "1"}], "]"}], "]"}], ",", 
            RowBox[{"se", "[", 
             RowBox[{"[", 
              RowBox[{"j", "-", "1"}], "]"}], "]"}]}], "]"}], "]"}], "+", 
         "\[IndentingNewLine]", 
         RowBox[{"antiNHB", "[", 
          RowBox[{"[", 
           RowBox[{"k", ",", 
            RowBox[{"se", "[", 
             RowBox[{"[", 
              RowBox[{"i", "-", "1"}], "]"}], "]"}], ",", 
            RowBox[{"se", "[", 
             RowBox[{"[", 
              RowBox[{"j", "+", "1"}], "]"}], "]"}]}], "]"}], "]"}]}], 
        ")"}]}], ",", "0.0"}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"thetaSeqParaHB", "[", 
     RowBox[{"i_", ",", "j_", ",", "k_"}], "]"}], ":=", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"iP", "[", 
       RowBox[{"i", ",", "j"}], "]"}], ",", 
      RowBox[{"paraHB", "[", 
       RowBox[{"[", 
        RowBox[{"k", ",", 
         RowBox[{"se", "[", 
          RowBox[{"[", 
           RowBox[{"i", "+", "1"}], "]"}], "]"}], ",", 
         RowBox[{"se", "[", 
          RowBox[{"[", "j", "]"}], "]"}]}], "]"}], "]"}], ",", "0.0"}], 
     "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"\[Lambda]1", "[", 
      RowBox[{"i_", ",", "j_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Abs", "[", 
           RowBox[{"j", "-", "i"}], "]"}], "<", "5"}], ",", 
         RowBox[{"-", 
          RowBox[{"hbscl", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ",", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Abs", "[", 
             RowBox[{"j", "-", "i"}], "]"}], "<", "20"}], ",", 
           RowBox[{"-", 
            RowBox[{"hbscl", "[", 
             RowBox[{"[", "3", "]"}], "]"}]}], ",", 
           RowBox[{"-", 
            RowBox[{"hbscl", "[", 
             RowBox[{"[", "7", "]"}], "]"}]}]}], "]"}]}], "]"}], 
       "\[IndentingNewLine]", 
       RowBox[{"\[Lambda]2", "[", 
        RowBox[{"i_", ",", "j_"}], "]"}]}], ":=", 
      RowBox[{
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Abs", "[", 
            RowBox[{"j", "-", "i"}], "]"}], "<", "5"}], ",", 
          RowBox[{"-", 
           RowBox[{"hbscl", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], ",", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Abs", "[", 
              RowBox[{"j", "-", "i"}], "]"}], "<", "20"}], ",", 
            RowBox[{"-", 
             RowBox[{"hbscl", "[", 
              RowBox[{"[", "4", "]"}], "]"}]}], ",", 
            RowBox[{"-", 
             RowBox[{"hbscl", "[", 
              RowBox[{"[", "8", "]"}], "]"}]}]}], "]"}]}], "]"}], 
        "\[IndentingNewLine]", 
        RowBox[{"\[Lambda]3", "[", 
         RowBox[{"i_", ",", "j_"}], "]"}]}], ":=", 
       RowBox[{
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Abs", "[", 
             RowBox[{"j", "-", "i"}], "]"}], "<", "5"}], ",", "0.0", ",", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Abs", "[", 
               RowBox[{"j", "-", "i"}], "]"}], "<", "20"}], ",", 
             RowBox[{
              RowBox[{"-", 
               RowBox[{"hbscl", "[", 
                RowBox[{"[", "5", "]"}], "]"}]}], "-", 
              RowBox[{
               RowBox[{"hbscl", "[", 
                RowBox[{"[", "11", "]"}], "]"}], 
               RowBox[{"thetaSeqAntiHB", "[", 
                RowBox[{"i", ",", "j", ",", "1"}], "]"}]}], "-", 
              RowBox[{
               RowBox[{"hbscl", "[", 
                RowBox[{"[", "12", "]"}], "]"}], 
               RowBox[{"thetaSeqAntiNHB", "[", 
                RowBox[{"i", ",", "j", ",", "1"}], "]"}]}], "-", 
              RowBox[{
               RowBox[{"hbscl", "[", 
                RowBox[{"[", "16", "]"}], "]"}], 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"antiOne", "[", 
                  RowBox[{"[", 
                   RowBox[{"se", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], "+", 
                 RowBox[{"antiOne", "[", 
                  RowBox[{"[", 
                   RowBox[{"se", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "]"}], "]"}]}], ")"}]}]}],
              ",", 
             RowBox[{
              RowBox[{"-", 
               RowBox[{"hbscl", "[", 
                RowBox[{"[", "9", "]"}], "]"}]}], "-", 
              RowBox[{
               RowBox[{"hbscl", "[", 
                RowBox[{"[", "13", "]"}], "]"}], 
               RowBox[{"thetaSeqAntiHB", "[", 
                RowBox[{"i", ",", "j", ",", "2"}], "]"}]}], "-", 
              RowBox[{
               RowBox[{"hbscl", "[", 
                RowBox[{"[", "14", "]"}], "]"}], 
               RowBox[{"thetaSeqAntiNHB", "[", 
                RowBox[{"i", ",", "j", ",", "2"}], "]"}]}], "-", 
              RowBox[{
               RowBox[{"hbscl", "[", 
                RowBox[{"[", "16", "]"}], "]"}], 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"antiOne", "[", 
                  RowBox[{"[", 
                   RowBox[{"se", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], "+", 
                 RowBox[{"antiOne", "[", 
                  RowBox[{"[", 
                   RowBox[{"se", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "]"}], "]"}]}], 
                ")"}]}]}]}], "]"}]}], "]"}], "\[IndentingNewLine]", 
         RowBox[{"\[Lambda]4", "[", 
          RowBox[{"i_", ",", "j_"}], "]"}]}], ":=", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Abs", "[", 
            RowBox[{"j", "-", "i"}], "]"}], "<", "5"}], ",", "0.0", ",", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Abs", "[", 
              RowBox[{"j", "-", "i"}], "]"}], "<", "20"}], ",", 
            RowBox[{"-", 
             RowBox[{"hbscl", "[", 
              RowBox[{"[", "6", "]"}], "]"}]}], ",", 
            RowBox[{
             RowBox[{"-", 
              RowBox[{"hbscl", "[", 
               RowBox[{"[", "10", "]"}], "]"}]}], "-", 
             RowBox[{
              RowBox[{"hbscl", "[", 
               RowBox[{"[", "15", "]"}], "]"}], 
              RowBox[{"thetaSeqParaHB", "[", 
               RowBox[{"i", ",", "j", ",", "2"}], "]"}]}], "-", 
             RowBox[{
              RowBox[{"hbscl", "[", 
               RowBox[{"[", "17", "]"}], "]"}], 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"paraOne", "[", 
                 RowBox[{"[", 
                  RowBox[{"se", "[", 
                   RowBox[{"[", 
                    RowBox[{"i", "+", "1"}], "]"}], "]"}], "]"}], "]"}], "+", 
                
                RowBox[{"paraOne", "[", 
                 RowBox[{"[", 
                  RowBox[{"se", "[", 
                   RowBox[{"[", "j", "]"}], "]"}], "]"}], "]"}]}], 
               ")"}]}]}]}], "]"}]}], "]"}]}]}]}]}], "*)"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Lambda]1", "[", 
     RowBox[{"i_", ",", "j_"}], "]"}], ":=", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Abs", "[", 
        RowBox[{"j", "-", "i"}], "]"}], "<", "4"}], ",", 
      RowBox[{"-", 
       RowBox[{"hbscl", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ",", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Abs", "[", 
          RowBox[{"j", "-", "i"}], "]"}], "<", "18"}], ",", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"ssweight6", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "\[Equal]", "1.0"}], " ", "&&", 
           " ", 
           RowBox[{
            RowBox[{"ssweight6", "[", 
             RowBox[{"[", "j", "]"}], "]"}], "\[Equal]", "1.0"}]}], ",", 
          RowBox[{"-", 
           RowBox[{"hbscl", "[", 
            RowBox[{"[", 
             RowBox[{"2", ",", "1"}], "]"}], "]"}]}], ",", "0.0"}], "]"}], 
        ",", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Abs", "[", 
            RowBox[{"j", "-", "i"}], "]"}], "<", "45"}], ",", 
          RowBox[{"-", 
           RowBox[{"hbscl", "[", 
            RowBox[{"[", 
             RowBox[{"3", ",", "1"}], "]"}], "]"}]}], ",", 
          RowBox[{"-", 
           RowBox[{"hbscl", "[", 
            RowBox[{"[", 
             RowBox[{"4", ",", "1"}], "]"}], "]"}]}]}], "]"}]}], "]"}]}], 
     "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Lambda]2", "[", 
     RowBox[{"i_", ",", "j_"}], "]"}], ":=", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Abs", "[", 
        RowBox[{"j", "-", "i"}], "]"}], "<", "4"}], ",", 
      RowBox[{"-", 
       RowBox[{"hbscl", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "2"}], "]"}], "]"}]}], ",", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Abs", "[", 
          RowBox[{"j", "-", "i"}], "]"}], "<", "18"}], ",", 
        RowBox[{"-", 
         RowBox[{"hbscl", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "2"}], "]"}], "]"}]}], ",", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Abs", "[", 
            RowBox[{"j", "-", "i"}], "]"}], "<", "45"}], ",", 
          RowBox[{"-", 
           RowBox[{"hbscl", "[", 
            RowBox[{"[", 
             RowBox[{"3", ",", "2"}], "]"}], "]"}]}], ",", 
          RowBox[{"-", 
           RowBox[{"hbscl", "[", 
            RowBox[{"[", 
             RowBox[{"4", ",", "2"}], "]"}], "]"}]}]}], "]"}]}], "]"}]}], 
     "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Lambda]3", "[", 
     RowBox[{"i_", ",", "j_"}], "]"}], ":=", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Abs", "[", 
        RowBox[{"j", "-", "i"}], "]"}], "<", "4"}], ",", "0.0", ",", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Abs", "[", 
          RowBox[{"j", "-", "i"}], "]"}], "<", "18"}], ",", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"ssweight6", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "\[Equal]", "1.0"}], " ", "&&", 
           " ", 
           RowBox[{
            RowBox[{"ssweight6", "[", 
             RowBox[{"[", "j", "]"}], "]"}], "\[Equal]", "1.0"}]}], ",", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"hbscl", "[", 
             RowBox[{"[", 
              RowBox[{"2", ",", "3"}], "]"}], "]"}]}], "-", 
           RowBox[{
            RowBox[{"hbscl", "[", 
             RowBox[{"[", 
              RowBox[{"2", ",", "4"}], "]"}], "]"}], 
            RowBox[{"thetaSeqAntiHB", "[", 
             RowBox[{"i", ",", "j", ",", "1"}], "]"}]}], "-", 
           RowBox[{
            RowBox[{"hbscl", "[", 
             RowBox[{"[", 
              RowBox[{"2", ",", "5"}], "]"}], "]"}], 
            RowBox[{"thetaSeqAntiNHB", "[", 
             RowBox[{"i", ",", "j", ",", "1"}], "]"}]}], "-", 
           RowBox[{
            RowBox[{"hbscl", "[", 
             RowBox[{"[", 
              RowBox[{"2", ",", "6"}], "]"}], "]"}], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"antiOne", "[", 
               RowBox[{"[", 
                RowBox[{"se", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], "+", 
              RowBox[{"antiOne", "[", 
               RowBox[{"[", 
                RowBox[{"se", "[", 
                 RowBox[{"[", "j", "]"}], "]"}], "]"}], "]"}]}], ")"}]}]}], 
          ",", "0.0"}], "]"}], ",", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Abs", "[", 
            RowBox[{"j", "-", "i"}], "]"}], "<", "45"}], ",", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"hbscl", "[", 
             RowBox[{"[", 
              RowBox[{"3", ",", "3"}], "]"}], "]"}]}], "-", 
           RowBox[{
            RowBox[{"hbscl", "[", 
             RowBox[{"[", 
              RowBox[{"3", ",", "4"}], "]"}], "]"}], 
            RowBox[{"thetaSeqAntiHB", "[", 
             RowBox[{"i", ",", "j", ",", "2"}], "]"}]}], "-", 
           RowBox[{
            RowBox[{"hbscl", "[", 
             RowBox[{"[", 
              RowBox[{"3", ",", "5"}], "]"}], "]"}], 
            RowBox[{"thetaSeqAntiNHB", "[", 
             RowBox[{"i", ",", "j", ",", "2"}], "]"}]}], "-", 
           RowBox[{
            RowBox[{"hbscl", "[", 
             RowBox[{"[", 
              RowBox[{"3", ",", "6"}], "]"}], "]"}], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"antiOne", "[", 
               RowBox[{"[", 
                RowBox[{"se", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], "+", 
              RowBox[{"antiOne", "[", 
               RowBox[{"[", 
                RowBox[{"se", "[", 
                 RowBox[{"[", "j", "]"}], "]"}], "]"}], "]"}]}], ")"}]}]}], 
          ",", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"hbscl", "[", 
             RowBox[{"[", 
              RowBox[{"4", ",", "3"}], "]"}], "]"}]}], "-", 
           RowBox[{
            RowBox[{"hbscl", "[", 
             RowBox[{"[", 
              RowBox[{"4", ",", "4"}], "]"}], "]"}], 
            RowBox[{"thetaSeqAntiHB", "[", 
             RowBox[{"i", ",", "j", ",", "2"}], "]"}]}], "-", 
           RowBox[{
            RowBox[{"hbscl", "[", 
             RowBox[{"[", 
              RowBox[{"4", ",", "5"}], "]"}], "]"}], 
            RowBox[{"thetaSeqAntiNHB", "[", 
             RowBox[{"i", ",", "j", ",", "2"}], "]"}]}], "-", 
           RowBox[{
            RowBox[{"hbscl", "[", 
             RowBox[{"[", 
              RowBox[{"4", ",", "6"}], "]"}], "]"}], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"antiOne", "[", 
               RowBox[{"[", 
                RowBox[{"se", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], "+", 
              RowBox[{"antiOne", "[", 
               RowBox[{"[", 
                RowBox[{"se", "[", 
                 RowBox[{"[", "j", "]"}], "]"}], "]"}], "]"}]}], ")"}]}]}]}], 
         "]"}]}], "]"}]}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Lambda]4", "[", 
     RowBox[{"i_", ",", "j_"}], "]"}], ":=", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Abs", "[", 
        RowBox[{"j", "-", "i"}], "]"}], "<", "4"}], ",", "0.0", ",", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Abs", "[", 
          RowBox[{"j", "-", "i"}], "]"}], "<", "18"}], ",", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"ssweight6", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "\[Equal]", "1.0"}], " ", "&&", 
           " ", 
           RowBox[{
            RowBox[{"ssweight6", "[", 
             RowBox[{"[", "j", "]"}], "]"}], "\[Equal]", "1.0"}]}], ",", 
          RowBox[{"-", 
           RowBox[{"hbscl", "[", 
            RowBox[{"[", 
             RowBox[{"2", ",", "7"}], "]"}], "]"}]}], ",", "0.0"}], "]"}], 
        ",", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Abs", "[", 
            RowBox[{"j", "-", "i"}], "]"}], "<", "45"}], ",", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"hbscl", "[", 
             RowBox[{"[", 
              RowBox[{"3", ",", "7"}], "]"}], "]"}]}], "-", 
           RowBox[{
            RowBox[{"hbscl", "[", 
             RowBox[{"[", 
              RowBox[{"3", ",", "8"}], "]"}], "]"}], 
            RowBox[{"thetaSeqParaHB", "[", 
             RowBox[{"i", ",", "j", ",", "2"}], "]"}]}], "-", 
           RowBox[{
            RowBox[{"hbscl", "[", 
             RowBox[{"[", 
              RowBox[{"3", ",", "9"}], "]"}], "]"}], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"paraOne", "[", 
               RowBox[{"[", 
                RowBox[{"se", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", "+", "1"}], "]"}], "]"}], "]"}], "]"}], "+", 
              RowBox[{"paraOne", "[", 
               RowBox[{"[", 
                RowBox[{"se", "[", 
                 RowBox[{"[", "j", "]"}], "]"}], "]"}], "]"}]}], ")"}]}]}], 
          ",", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"hbscl", "[", 
             RowBox[{"[", 
              RowBox[{"4", ",", "7"}], "]"}], "]"}]}], "-", 
           RowBox[{
            RowBox[{"hbscl", "[", 
             RowBox[{"[", 
              RowBox[{"4", ",", "8"}], "]"}], "]"}], 
            RowBox[{"thetaSeqParaHB", "[", 
             RowBox[{"i", ",", "j", ",", "2"}], "]"}]}], "-", 
           RowBox[{
            RowBox[{"hbscl", "[", 
             RowBox[{"[", 
              RowBox[{"4", ",", "9"}], "]"}], "]"}], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"paraOne", "[", 
               RowBox[{"[", 
                RowBox[{"se", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", "+", "1"}], "]"}], "]"}], "]"}], "]"}], "+", 
              RowBox[{"paraOne", "[", 
               RowBox[{"[", 
                RowBox[{"se", "[", 
                 RowBox[{"[", "j", "]"}], "]"}], "]"}], "]"}]}], ")"}]}]}]}], 
         "]"}]}], "]"}]}], "]"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"rNO", "[", 
     RowBox[{"k_", ",", "i_", ",", "j_"}], "]"}], ":=", 
    RowBox[{"Switch", "[", 
     RowBox[{"k", ",", "1", ",", 
      RowBox[{"MyNorm", "[", 
       RowBox[{
        SubscriptBox["r", 
         RowBox[{"O", ",", "i"}]], "-", 
        SubscriptBox["r", 
         RowBox[{"N", ",", "j"}]]}], "]"}], ",", "2", ",", 
      RowBox[{"MyNorm", "[", 
       RowBox[{
        SubscriptBox["r", 
         RowBox[{"O", ",", "i"}]], "-", 
        SubscriptBox["r", 
         RowBox[{"N", ",", 
          RowBox[{"j", "+", "1"}]}]]}], "]"}], ",", "3", ",", 
      RowBox[{"MyNorm", "[", 
       RowBox[{
        SubscriptBox["r", 
         RowBox[{"O", ",", "j"}]], "-", 
        SubscriptBox["r", 
         RowBox[{"N", ",", "i"}]]}], "]"}], ",", "4", ",", 
      RowBox[{"MyNorm", "[", 
       RowBox[{
        SubscriptBox["r", 
         RowBox[{"O", ",", "j"}]], "-", 
        SubscriptBox["r", 
         RowBox[{"N", ",", 
          RowBox[{"i", "+", "2"}]}]]}], "]"}]}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"rHO", "[", 
     RowBox[{"k_", ",", "i_", ",", "j_"}], "]"}], ":=", 
    RowBox[{"Switch", "[", 
     RowBox[{"k", ",", "1", ",", 
      RowBox[{"MyNorm", "[", 
       RowBox[{
        SubscriptBox["r", 
         RowBox[{"O", ",", "i"}]], "-", 
        SubscriptBox["r", 
         RowBox[{"H", ",", "j"}]]}], "]"}], ",", "2", ",", 
      RowBox[{"MyNorm", "[", 
       RowBox[{
        SubscriptBox["r", 
         RowBox[{"O", ",", "i"}]], "-", 
        SubscriptBox["r", 
         RowBox[{"H", ",", 
          RowBox[{"j", "+", "1"}]}]]}], "]"}], ",", "3", ",", 
      RowBox[{"MyNorm", "[", 
       RowBox[{
        SubscriptBox["r", 
         RowBox[{"O", ",", "j"}]], "-", 
        SubscriptBox["r", 
         RowBox[{"H", ",", "i"}]]}], "]"}], ",", "4", ",", 
      RowBox[{"MyNorm", "[", 
       RowBox[{
        SubscriptBox["r", 
         RowBox[{"O", ",", "j"}]], "-", 
        SubscriptBox["r", 
         RowBox[{"H", ",", 
          RowBox[{"i", "+", "2"}]}]]}], "]"}]}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Delta]", "[", 
     RowBox[{"k_", ",", "i_", ",", "j_"}], "]"}], ":=", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"k", "\[Equal]", "2"}], " ", "&&", "  ", 
       RowBox[{
        RowBox[{"iRepulsive", "[", 
         RowBox[{"i", ",", "j"}], "]"}], "\[Equal]", "False"}]}], ",", "0", 
      ",", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"k", "\[Equal]", "3"}], " ", "&&", " ", 
         RowBox[{
          RowBox[{"iAP", "[", 
           RowBox[{"i", ",", "j"}], "]"}], "\[Equal]", "False"}]}], ",", "0", 
        ",", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"k", "\[Equal]", "4"}], " ", "&&", " ", 
           RowBox[{
            RowBox[{"iP", "[", 
             RowBox[{"i", ",", "j"}], "]"}], "\[Equal]", "False"}]}], ",", 
          "0", ",", "1"}], "]"}]}], "]"}]}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Theta]", "[", 
     RowBox[{"k_", ",", "i_", ",", "j_"}], "]"}], ":=", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Delta]", "[", 
        RowBox[{"k", ",", "i", ",", "j"}], "]"}], " ", "\[Equal]", "1"}], ",", 
      RowBox[{"Exp", "[", 
       RowBox[{
        RowBox[{"-", 
         FractionBox[
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{"rNO", "[", 
              RowBox[{"k", ",", "i", ",", "j"}], "]"}], "-", "rNOzero"}], 
            ")"}], "2"], 
          RowBox[{"2.0", " ", 
           SuperscriptBox["\[Sigma]NO", "2"]}]]}], "-", 
        FractionBox[
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"rHO", "[", 
             RowBox[{"k", ",", "i", ",", "j"}], "]"}], "-", "rHOzero"}], 
           ")"}], "2"], 
         RowBox[{"2.0", " ", 
          SuperscriptBox["\[Sigma]HO", "2"]}]]}], "]"}], ",", "0.0"}], 
     "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Nu]1", "[", "i_", "]"}], ":=", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"i", "-", "2"}], ">", "1"}], " ", "&&", " ", 
       RowBox[{
        RowBox[{"i", "+", "2"}], "\[LessEqual]", "M"}]}], " ", ",", 
      RowBox[{"0.5", 
       RowBox[{"(", 
        RowBox[{"1.0", "+", 
         RowBox[{"Tanh", "[", 
          RowBox[{
           RowBox[{"MyNorm", "[", 
            RowBox[{
             SubscriptBox["r", 
              RowBox[{"Ca", ",", 
               RowBox[{"i", "-", "2"}]}]], "-", 
             SubscriptBox["r", 
              RowBox[{"Ca", ",", 
               RowBox[{"i", "+", "2"}]}]]}], "]"}], "-", "dnu"}], "]"}]}], 
        ")"}]}], ",", "1.0"}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Nu]2", "[", "i_", "]"}], ":=", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"i", "-", "2"}], ">", "1"}], " ", "&&", " ", 
       RowBox[{
        RowBox[{"i", "+", "2"}], "\[LessEqual]", "M"}]}], " ", ",", 
      RowBox[{"0.5", 
       RowBox[{"(", 
        RowBox[{"1.0", "+", 
         RowBox[{"Tanh", "[", 
          RowBox[{"pref", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"MyNorm", "[", 
              RowBox[{
               SubscriptBox["r", 
                RowBox[{"Ca", ",", 
                 RowBox[{"i", "-", "2"}]}]], "-", 
               SubscriptBox["r", 
                RowBox[{"Ca", ",", 
                 RowBox[{"i", "+", "2"}]}]]}], "]"}], "-", "dnu"}], ")"}]}], 
          "]"}]}], ")"}]}], ",", "1.0"}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "THIS", " ", "CALCULATES", " ", "THE", " ", "TOTAL", " ", "POTENTIAL", 
     " ", "ENERGY"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"Vdssp", ":=", 
    RowBox[{
     UnderoverscriptBox["\[Sum]", 
      RowBox[{"i", "=", "1"}], 
      RowBox[{"M", "-", "1"}]], 
     RowBox[{
      UnderoverscriptBox["\[Sum]", 
       RowBox[{"j", "=", "2"}], "M"], 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Abs", "[", 
            RowBox[{"j", "-", "i"}], "]"}], "\[LessEqual]", "2"}], " ", "||", 
          " ", 
          RowBox[{
           RowBox[{"se", "[", 
            RowBox[{"[", "j", "]"}], "]"}], "\[Equal]", "15"}], " ", "||", 
          " ", 
          RowBox[{
           RowBox[{"MyNorm", "[", 
            RowBox[{
             SubscriptBox["r", 
              RowBox[{"O", ",", "i"}]], "-", 
             SubscriptBox["r", 
              RowBox[{"N", ",", "j"}]]}], "]"}], ">", "cutoff"}]}], ",", "0", 
         ",", "1"}], "]"}], " ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Abs", "[", 
            RowBox[{"j", "-", "i"}], "]"}], "<", "18"}], " ", "&&", " ", 
          RowBox[{
           RowBox[{"Abs", "[", 
            RowBox[{"j", "-", "i"}], "]"}], "\[GreaterEqual]", "4"}]}], ",", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"\[Lambda]1", "[", 
             RowBox[{"i", ",", "j"}], "]"}], 
            RowBox[{"\[Theta]", "[", 
             RowBox[{"1", ",", "i", ",", "j"}], "]"}]}], "+", 
           RowBox[{
            RowBox[{"\[Lambda]2", "[", 
             RowBox[{"i", ",", "j"}], "]"}], 
            RowBox[{"\[Theta]", "[", 
             RowBox[{"1", ",", "i", ",", "j"}], "]"}], 
            RowBox[{"\[Theta]", "[", 
             RowBox[{"2", ",", "i", ",", "j"}], "]"}]}], "+", 
           RowBox[{
            RowBox[{"\[Lambda]3", "[", 
             RowBox[{"i", ",", "j"}], "]"}], 
            RowBox[{"\[Theta]", "[", 
             RowBox[{"1", ",", "i", ",", "j"}], "]"}], 
            RowBox[{"\[Theta]", "[", 
             RowBox[{"3", ",", "i", ",", "j"}], "]"}]}], "+", 
           RowBox[{
            RowBox[{"\[Lambda]4", "[", 
             RowBox[{"i", ",", "j"}], "]"}], 
            RowBox[{"\[Theta]", "[", 
             RowBox[{"1", ",", "i", ",", "j"}], "]"}], 
            RowBox[{"\[Theta]", "[", 
             RowBox[{"4", ",", "i", ",", "j"}], "]"}]}]}], ")"}], ",", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"\[Lambda]1", "[", 
             RowBox[{"i", ",", "j"}], "]"}], 
            RowBox[{"\[Theta]", "[", 
             RowBox[{"1", ",", "i", ",", "j"}], "]"}], 
            RowBox[{"\[Nu]1", "[", "i", "]"}], 
            RowBox[{"\[Nu]2", "[", "j", "]"}]}], "+", 
           RowBox[{
            RowBox[{"\[Lambda]2", "[", 
             RowBox[{"i", ",", "j"}], "]"}], 
            RowBox[{"\[Theta]", "[", 
             RowBox[{"1", ",", "i", ",", "j"}], "]"}], 
            RowBox[{"\[Theta]", "[", 
             RowBox[{"2", ",", "i", ",", "j"}], "]"}], 
            RowBox[{"\[Nu]1", "[", "i", "]"}], 
            RowBox[{"\[Nu]2", "[", "j", "]"}]}], "+", 
           RowBox[{
            RowBox[{"\[Lambda]3", "[", 
             RowBox[{"i", ",", "j"}], "]"}], 
            RowBox[{"\[Theta]", "[", 
             RowBox[{"1", ",", "i", ",", "j"}], "]"}], 
            RowBox[{"\[Theta]", "[", 
             RowBox[{"3", ",", "i", ",", "j"}], "]"}], 
            RowBox[{"\[Nu]1", "[", "i", "]"}], 
            RowBox[{"\[Nu]2", "[", "j", "]"}]}], "+", 
           RowBox[{
            RowBox[{"\[Lambda]4", "[", 
             RowBox[{"i", ",", "j"}], "]"}], 
            RowBox[{"\[Theta]", "[", 
             RowBox[{"1", ",", "i", ",", "j"}], "]"}], 
            RowBox[{"\[Theta]", "[", 
             RowBox[{"4", ",", "i", ",", "j"}], "]"}], 
            RowBox[{"\[Nu]1", "[", "i", "]"}], 
            RowBox[{"\[Nu]2", "[", "j", "]"}]}]}], ")"}]}], "]"}]}]}]}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "THIS", " ", "CALCULATES", " ", "THE", " ", "POTENTIAL", " ", "ENERGY", 
      " ", "FOR", " ", "A", " ", "PARTICULAR", " ", "PAIR", " ", "OR", " ", 
      "RESIDUES", " ", "I"}], ",", "J"}], " ", "*)"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{"VDSSP", "[", 
     RowBox[{"i_", ",", "j_"}], "]"}], ":=", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"i", "\[Equal]", "M"}], " ", "||", " ", 
       RowBox[{"j", "\[Equal]", "1"}], " ", "||", " ", 
       RowBox[{
        RowBox[{"Abs", "[", 
         RowBox[{"j", "-", "i"}], "]"}], "\[LessEqual]", "2"}], " ", "||", 
       " ", 
       RowBox[{
        RowBox[{"se", "[", 
         RowBox[{"[", "j", "]"}], "]"}], "\[Equal]", "15"}], " ", "||", " ", 
       RowBox[{
        RowBox[{"MyNorm", "[", 
         RowBox[{
          SubscriptBox["r", 
           RowBox[{"O", ",", "i"}]], "-", 
          SubscriptBox["r", 
           RowBox[{"N", ",", "j"}]]}], "]"}], ">", "cutoff"}]}], ",", "0.0", 
      ",", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Abs", "[", 
           RowBox[{"j", "-", "i"}], "]"}], "<", "18"}], " ", "&&", " ", 
         RowBox[{
          RowBox[{"Abs", "[", 
           RowBox[{"j", "-", "i"}], "]"}], "\[GreaterEqual]", "4"}]}], ",", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"\[Lambda]1", "[", 
            RowBox[{"i", ",", "j"}], "]"}], 
           RowBox[{"\[Theta]", "[", 
            RowBox[{"1", ",", "i", ",", "j"}], "]"}]}], "+", 
          RowBox[{
           RowBox[{"\[Lambda]2", "[", 
            RowBox[{"i", ",", "j"}], "]"}], 
           RowBox[{"\[Theta]", "[", 
            RowBox[{"1", ",", "i", ",", "j"}], "]"}], 
           RowBox[{"\[Theta]", "[", 
            RowBox[{"2", ",", "i", ",", "j"}], "]"}]}], "+", 
          RowBox[{
           RowBox[{"\[Lambda]3", "[", 
            RowBox[{"i", ",", "j"}], "]"}], 
           RowBox[{"\[Theta]", "[", 
            RowBox[{"1", ",", "i", ",", "j"}], "]"}], 
           RowBox[{"\[Theta]", "[", 
            RowBox[{"3", ",", "i", ",", "j"}], "]"}]}], "+", 
          RowBox[{
           RowBox[{"\[Lambda]4", "[", 
            RowBox[{"i", ",", "j"}], "]"}], 
           RowBox[{"\[Theta]", "[", 
            RowBox[{"1", ",", "i", ",", "j"}], "]"}], 
           RowBox[{"\[Theta]", "[", 
            RowBox[{"4", ",", "i", ",", "j"}], "]"}]}]}], ")"}], ",", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"\[Lambda]1", "[", 
            RowBox[{"i", ",", "j"}], "]"}], 
           RowBox[{"\[Theta]", "[", 
            RowBox[{"1", ",", "i", ",", "j"}], "]"}], 
           RowBox[{"\[Nu]1", "[", "i", "]"}], 
           RowBox[{"\[Nu]2", "[", "j", "]"}]}], "+", 
          RowBox[{
           RowBox[{"\[Lambda]2", "[", 
            RowBox[{"i", ",", "j"}], "]"}], 
           RowBox[{"\[Theta]", "[", 
            RowBox[{"1", ",", "i", ",", "j"}], "]"}], 
           RowBox[{"\[Theta]", "[", 
            RowBox[{"2", ",", "i", ",", "j"}], "]"}], 
           RowBox[{"\[Nu]1", "[", "i", "]"}], 
           RowBox[{"\[Nu]2", "[", "j", "]"}]}], "+", 
          RowBox[{
           RowBox[{"\[Lambda]3", "[", 
            RowBox[{"i", ",", "j"}], "]"}], 
           RowBox[{"\[Theta]", "[", 
            RowBox[{"1", ",", "i", ",", "j"}], "]"}], 
           RowBox[{"\[Theta]", "[", 
            RowBox[{"3", ",", "i", ",", "j"}], "]"}], 
           RowBox[{"\[Nu]1", "[", "i", "]"}], 
           RowBox[{"\[Nu]2", "[", "j", "]"}]}], "+", 
          RowBox[{
           RowBox[{"\[Lambda]4", "[", 
            RowBox[{"i", ",", "j"}], "]"}], 
           RowBox[{"\[Theta]", "[", 
            RowBox[{"1", ",", "i", ",", "j"}], "]"}], 
           RowBox[{"\[Theta]", "[", 
            RowBox[{"4", ",", "i", ",", "j"}], "]"}], 
           RowBox[{"\[Nu]1", "[", "i", "]"}], 
           RowBox[{"\[Nu]2", "[", "j", "]"}]}]}], ")"}]}], "]"}]}], 
     "]"}]}]}]}]], "Input",
 CellOpen->False,
 CellChangeTimes->{{3.4688545231987553`*^9, 3.468854591733592*^9}, {
   3.46885469809086*^9, 3.468854712306538*^9}, {3.468854752252572*^9, 
   3.468854888823358*^9}, {3.468854934100111*^9, 3.468854938119452*^9}, {
   3.4688551412646914`*^9, 3.468855392880972*^9}, {3.468855559233973*^9, 
   3.468855559887401*^9}, {3.468855607223339*^9, 3.4688556132112923`*^9}, {
   3.468856005341827*^9, 3.468856019661236*^9}, {3.468856186726363*^9, 
   3.4688561934160547`*^9}, {3.468856275029667*^9, 3.468856325584127*^9}, {
   3.4688563834264107`*^9, 3.4688564010607567`*^9}, {3.468856472039454*^9, 
   3.468856560114645*^9}, {3.468856649460094*^9, 3.468856714871167*^9}, {
   3.468856878141852*^9, 3.46885694397437*^9}, 3.468857067921371*^9, {
   3.468858009915308*^9, 3.468858011729107*^9}, {3.468858041804687*^9, 
   3.468858106570197*^9}, {3.468858164091794*^9, 3.468858164390669*^9}, {
   3.468858195379747*^9, 3.46885832355942*^9}, {3.46885842587939*^9, 
   3.468858544400716*^9}, {3.468858608278529*^9, 3.468858650600499*^9}, {
   3.468858729321307*^9, 3.4688588790179234`*^9}, {3.468858985244705*^9, 
   3.4688590146875277`*^9}, {3.468859079936151*^9, 3.468859085113804*^9}, {
   3.468859116799193*^9, 3.468859136314533*^9}, {3.468859267094181*^9, 
   3.468859335903599*^9}, {3.468859407223928*^9, 3.468859416937151*^9}, {
   3.468859451039817*^9, 3.468859525464444*^9}, {3.468859624182054*^9, 
   3.4688596529330273`*^9}, {3.468859690038817*^9, 3.468859727512344*^9}, {
   3.468859775627851*^9, 3.4688599201589823`*^9}, {3.468860687353223*^9, 
   3.468860698488188*^9}, {3.468860744299596*^9, 3.468860757782031*^9}, {
   3.468861902865514*^9, 3.468861925163712*^9}, {3.468940498807138*^9, 
   3.468940514255422*^9}, {3.468940594671103*^9, 3.468940649034878*^9}, {
   3.468942698120571*^9, 3.4689427091209393`*^9}, {3.4689427681289473`*^9, 
   3.468942791303822*^9}, {3.468942920426601*^9, 3.4689429236360083`*^9}, {
   3.4689432558686743`*^9, 3.468943257263085*^9}, {3.4689447061034307`*^9, 
   3.468944706570022*^9}, {3.470422398922974*^9, 3.4704224291365757`*^9}, {
   3.4704225305752077`*^9, 3.470422532281509*^9}, {3.470668638299728*^9, 
   3.470668639305203*^9}, {3.472904008302815*^9, 3.47290403310181*^9}, {
   3.472904132257702*^9, 3.472904185418413*^9}, {3.472904232331568*^9, 
   3.472904246516877*^9}, {3.472904296173376*^9, 3.472904384387455*^9}, {
   3.4729044458323603`*^9, 3.4729044921841803`*^9}, {3.472904606823674*^9, 
   3.472904635566135*^9}, {3.472904685794245*^9, 3.47290471335958*^9}, {
   3.472904746313723*^9, 3.472904786318532*^9}, {3.472904829328277*^9, 
   3.4729050579230022`*^9}, {3.472905232696363*^9, 3.47290524054075*^9}, {
   3.472905339089567*^9, 3.472905341199419*^9}, {3.472905404353219*^9, 
   3.4729054629688883`*^9}, {3.4729101666063223`*^9, 3.472910189211753*^9}, {
   3.4729103191411953`*^9, 3.4729103680395327`*^9}, {3.472910405257567*^9, 
   3.4729105003996267`*^9}, {3.512321503856079*^9, 3.5123215159614964`*^9}, {
   3.5123215755892477`*^9, 3.512321619082347*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"THIS", " ", "BLOCK", " ", "DEFINES", " ", "THE", " ", "P_AP", " ", 
    RowBox[{"(", 
     RowBox[{"LIQUID", " ", "CRYSTAL"}], ")"}], " ", "POTENTIAL"}], " ", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"iMin", "=", "5"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"iMax", "=", "8"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"iDiff", "=", "4"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"papPref", "=", "7.0"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"papCut", "=", "8.0"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"W", "=", 
     RowBox[{"{", 
      RowBox[{"0.6", ",", "0.6", ",", "0.6"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Nu]", "[", 
     RowBox[{"i_", ",", "j_"}], "]"}], ":=", 
    RowBox[{"0.5", " ", 
     RowBox[{"(", 
      RowBox[{"1", "+", 
       RowBox[{"Tanh", "[", 
        RowBox[{"papPref", 
         RowBox[{"(", 
          RowBox[{"papCut", "-", 
           RowBox[{"MyNorm", "[", 
            RowBox[{
             SubscriptBox["r", 
              RowBox[{"Ca", ",", "j"}]], "-", 
             SubscriptBox["r", 
              RowBox[{"Ca", ",", "i"}]]}], "]"}]}], ")"}]}], "]"}]}], 
      ")"}]}]}], "\[IndentingNewLine]", 
   RowBox[{"VPAP", ":=", 
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       RowBox[{"W", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], 
      RowBox[{
       UnderoverscriptBox["\[Sum]", 
        RowBox[{"i", "=", "1"}], 
        RowBox[{"M", "-", 
         RowBox[{"(", 
          RowBox[{"iMin", "+", 
           RowBox[{"2", "iDiff"}]}], ")"}]}]], 
       RowBox[{
        UnderoverscriptBox["\[Sum]", 
         RowBox[{"j", "=", 
          RowBox[{"i", "+", 
           RowBox[{"(", 
            RowBox[{"iMin", "+", 
             RowBox[{"2", "iDiff"}]}], ")"}]}]}], 
         RowBox[{"Min", "[", 
          RowBox[{
           RowBox[{"i", "+", 
            RowBox[{"(", 
             RowBox[{"iMax", "+", 
              RowBox[{"2", "iDiff"}]}], ")"}]}], ",", "M"}], "]"}]], 
        RowBox[{
         RowBox[{"\[Nu]", "[", 
          RowBox[{"i", ",", "j"}], "]"}], 
         RowBox[{"\[Nu]", "[", 
          RowBox[{
           RowBox[{"i", "+", "iDiff"}], ",", 
           RowBox[{"j", "-", "iDiff"}]}], "]"}]}]}]}]}], "-", 
     RowBox[{
      RowBox[{"W", "[", 
       RowBox[{"[", "2", "]"}], "]"}], 
      RowBox[{
       UnderoverscriptBox["\[Sum]", 
        RowBox[{"i", "=", "1"}], 
        RowBox[{"M", "-", 
         RowBox[{"(", 
          RowBox[{"iMax", "+", 
           RowBox[{"2", "iDiff"}], "+", "1"}], ")"}]}]], 
       RowBox[{
        UnderoverscriptBox["\[Sum]", 
         RowBox[{"j", "=", 
          RowBox[{"i", "+", 
           RowBox[{"(", 
            RowBox[{"iMax", "+", 
             RowBox[{"2", "iDiff"}], "+", "1"}], ")"}]}]}], "M"], 
        RowBox[{
         RowBox[{"\[Nu]", "[", 
          RowBox[{"i", ",", "j"}], "]"}], 
         RowBox[{"\[Nu]", "[", 
          RowBox[{
           RowBox[{"i", "+", "iDiff"}], ",", 
           RowBox[{"j", "-", "iDiff"}]}], "]"}]}]}]}]}], "-", 
     RowBox[{
      RowBox[{"W", "[", 
       RowBox[{"[", "3", "]"}], "]"}], 
      RowBox[{
       UnderoverscriptBox["\[Sum]", 
        RowBox[{"i", "=", "1"}], 
        RowBox[{"M", "-", 
         RowBox[{"(", 
          RowBox[{"iMax", "+", "iDiff", "+", "1"}], ")"}]}]], 
       RowBox[{
        UnderoverscriptBox["\[Sum]", 
         RowBox[{"j", "=", 
          RowBox[{"i", "+", 
           RowBox[{"(", 
            RowBox[{"iMax", "+", "1"}], ")"}]}]}], 
         RowBox[{"M", "-", "iDiff"}]], 
        RowBox[{
         RowBox[{"\[Nu]", "[", 
          RowBox[{"i", ",", "j"}], "]"}], 
         RowBox[{"\[Nu]", "[", 
          RowBox[{
           RowBox[{"i", "+", "iDiff"}], ",", 
           RowBox[{"j", "+", "iDiff"}]}], "]"}]}]}]}]}]}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"VPAPij", "[", 
     RowBox[{"i_", ",", "j_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       RowBox[{"W", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"i", "<=", 
          RowBox[{"M", "-", 
           RowBox[{"(", 
            RowBox[{"iMin", "+", 
             RowBox[{"2", "iDiff"}]}], ")"}]}]}], " ", "&&", " ", 
         RowBox[{"j", ">=", 
          RowBox[{"i", "+", 
           RowBox[{"(", 
            RowBox[{"iMin", "+", 
             RowBox[{"2", "iDiff"}]}], ")"}]}]}], " ", "&&", " ", 
         RowBox[{"j", "<=", 
          RowBox[{"Min", "[", 
           RowBox[{
            RowBox[{"i", "+", 
             RowBox[{"(", 
              RowBox[{"iMax", "+", 
               RowBox[{"2", "iDiff"}]}], ")"}]}], ",", "M"}], "]"}]}]}], ",", 
        
        RowBox[{
         RowBox[{"\[Nu]", "[", 
          RowBox[{"i", ",", "j"}], "]"}], 
         RowBox[{"\[Nu]", "[", 
          RowBox[{
           RowBox[{"i", "+", "iDiff"}], ",", 
           RowBox[{"j", "-", "iDiff"}]}], "]"}]}], ",", "0.0"}], "]"}]}], "-", 
     RowBox[{
      RowBox[{"W", "[", 
       RowBox[{"[", "2", "]"}], "]"}], 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"i", "<=", 
          RowBox[{"M", "-", 
           RowBox[{"(", 
            RowBox[{"iMax", "+", 
             RowBox[{"2", "iDiff"}], "+", "1"}], ")"}]}]}], " ", "&&", " ", 
         RowBox[{"j", ">=", 
          RowBox[{"i", "+", 
           RowBox[{"(", 
            RowBox[{"iMax", "+", 
             RowBox[{"2", "iDiff"}], "+", "1"}], ")"}]}]}], " ", "&&", " ", 
         RowBox[{"j", "\[LessEqual]", "M"}]}], ",", 
        RowBox[{
         RowBox[{"\[Nu]", "[", 
          RowBox[{"i", ",", "j"}], "]"}], 
         RowBox[{"\[Nu]", "[", 
          RowBox[{
           RowBox[{"i", "+", "iDiff"}], ",", 
           RowBox[{"j", "-", "iDiff"}]}], "]"}]}], ",", "0.0"}], "]"}]}], "-", 
     RowBox[{
      RowBox[{"W", "[", 
       RowBox[{"[", "3", "]"}], "]"}], 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"i", "<=", 
          RowBox[{"M", "-", 
           RowBox[{"(", 
            RowBox[{"iMax", "+", "iDiff", "+", "1"}], ")"}]}]}], " ", "&&", 
         " ", 
         RowBox[{"j", ">=", 
          RowBox[{"i", "+", 
           RowBox[{"(", 
            RowBox[{"iMax", "+", "1"}], ")"}]}]}], " ", "&&", " ", 
         RowBox[{"j", "<=", 
          RowBox[{"M", "-", "iDiff"}]}]}], ",", 
        RowBox[{
         RowBox[{"\[Nu]", "[", 
          RowBox[{"i", ",", "j"}], "]"}], 
         RowBox[{"\[Nu]", "[", 
          RowBox[{
           RowBox[{"i", "+", "iDiff"}], ",", 
           RowBox[{"j", "+", "iDiff"}]}], "]"}]}], ",", "0.0"}], 
       "]"}]}]}]}]}]}]], "Input",
 CellOpen->False,
 CellChangeTimes->{{3.470511078395874*^9, 3.4705111331393127`*^9}, {
   3.470511254251968*^9, 3.470511286660549*^9}, {3.4705113226215897`*^9, 
   3.470511410840014*^9}, {3.470511464094315*^9, 3.470511503628962*^9}, {
   3.4705116225397778`*^9, 3.470511681362752*^9}, {3.4705866895731163`*^9, 
   3.470586707438596*^9}, {3.470586762704256*^9, 3.470586884984288*^9}, {
   3.470586976761204*^9, 3.4705870756336803`*^9}, {3.470587187843832*^9, 
   3.4705872004254293`*^9}, {3.470665533641921*^9, 3.470665827695216*^9}, {
   3.4724012084561872`*^9, 3.472401209674053*^9}, {3.472410371338832*^9, 
   3.472410421748806*^9}, {3.512321631091229*^9, 3.512321646485825*^9}, {
   3.5123335807047367`*^9, 3.512333584338703*^9}, 3.5123492960506153`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "THIS", " ", "BLOCK", " ", "DEFINES", " ", "THE", " ", "RAMACHANDRAN", " ",
     "POTNETIAL"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"\[Lambda]Rama", "=", "2.0"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"phiw", "=", 
     RowBox[{"{", 
      RowBox[{
      "0.15", ",", "0.25", ",", "0.65", ",", "1.0", ",", "1.0", ",", "1.0"}], 
      "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"psiw", "=", 
     RowBox[{"{", 
      RowBox[{
      "0.65", ",", "0.45", ",", "0.25", ",", "1.0", ",", "1.0", ",", "1.0"}], 
      "}"}]}], ";"}], "\[IndentingNewLine]", " ", 
   RowBox[{
    RowBox[{"w", "=", 
     RowBox[{"{", 
      RowBox[{
      "1.3149", ",", "1.32016", ",", "1.0264", ",", "0.0", ",", "2.0", ",", 
       "2.0"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Sigma", "=", 
     RowBox[{"{", 
      RowBox[{
      "15.398", ",", "49.0521", ",", "49.0954", ",", "0.0", ",", "419.0", ",",
        "15.398"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"phi0", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1.74"}], ",", 
       RowBox[{"-", "1.265"}], ",", "1.041", ",", "0.0", ",", 
       RowBox[{"-", "0.895"}], ",", 
       RowBox[{"-", "2.25"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"psi0", "=", 
     RowBox[{"{", 
      RowBox[{"2.138", ",", 
       RowBox[{"-", "0.318"}], ",", "0.78", ",", "0.0", ",", 
       RowBox[{"-", "0.820"}], ",", "2.16"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"psiwPr", "=", 
     RowBox[{"{", 
      RowBox[{
      "1.0", ",", "0.15", ",", "0.15", ",", "1.0", ",", "2.0", ",", "2.0"}], 
      "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"phiwPr", "=", 
     RowBox[{"{", 
      RowBox[{
      "1.0", ",", "1.0", ",", "1.0", ",", "1.0", ",", "1.0", ",", "1.0"}], 
      "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"wPr", "=", 
     RowBox[{"{", 
      RowBox[{
      "0.0", ",", "2.17", ",", "2.15", ",", "0.0", ",", "0.0", ",", "0.0"}], 
      "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SigmaPr", "=", 
     RowBox[{"{", 
      RowBox[{
      "0.0", ",", "105.52", ",", "109.09", ",", "0.0", ",", "0.0", ",", 
       "0.0"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"phi0Pr", "=", 
     RowBox[{"{", 
      RowBox[{"0.0", ",", 
       RowBox[{"-", "1.153"}], ",", 
       RowBox[{"-", "0.95"}], ",", "0.0", ",", "0.0", ",", "0.0"}], "}"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"psi0Pr", "=", 
     RowBox[{"{", 
      RowBox[{"0.0", ",", "2.4", ",", 
       RowBox[{"-", "0.218"}], ",", "0.0", ",", "0.0", ",", "0.0"}], "}"}]}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"aps", "[", 
     RowBox[{"i_", ",", "j_"}], "]"}], ":=", 
    RowBox[{"Switch", "[", 
     RowBox[{
     "j", ",", "1", ",", "1.0", ",", "2", ",", "1.0", ",", "3", ",", "1.0", 
      ",", "4", ",", "0.0", ",", "5", ",", 
      RowBox[{"ssweight5", "[", 
       RowBox[{"[", "i", "]"}], "]"}], ",", "6", ",", 
      RowBox[{"ssweight6", "[", 
       RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ArcTan2", "[", 
     RowBox[{"y_", ",", "x_"}], "]"}], ":=", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"x", "\[Equal]", "0"}], ",", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"y", ">", "0"}], ",", 
        FractionBox["\[Pi]", "2"], ",", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"y", "<", "0"}], ",", 
          RowBox[{"-", 
           FractionBox["\[Pi]", "2"]}], ",", "\"\<undefine\>\""}], "]"}]}], 
       "]"}], ",", 
      RowBox[{
       RowBox[{"ArcTan", "[", 
        RowBox[{"y", "/", "x"}], "]"}], "+", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"x", "<", "0"}], ",", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"y", "\[GreaterEqual]", "0"}], ",", "\[Pi]", ",", 
           RowBox[{"-", "\[Pi]"}]}], "]"}], ",", "0"}], "]"}]}]}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"angle", "[", 
     RowBox[{"r1_", ",", "r2_", ",", "r3_", ",", "r4_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"c", "=", 
         RowBox[{"r2", "-", "r1"}]}], ",", " ", 
        RowBox[{"b", "=", 
         RowBox[{"r3", "-", "r2"}]}], ",", 
        RowBox[{"a", "=", 
         RowBox[{"r4", "-", "r3"}]}]}], "}"}], ",", 
      RowBox[{"Return", "[", 
       RowBox[{"ArcTan2", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"MyNorm", "[", "b", "]"}], " ", 
          RowBox[{"c", ".", 
           RowBox[{"Cross", "[", 
            RowBox[{"b", ",", "a"}], "]"}]}]}], ",", 
         RowBox[{
          RowBox[{"Cross", "[", 
           RowBox[{"c", ",", "b"}], "]"}], ".", 
          RowBox[{"Cross", "[", 
           RowBox[{"b", ",", "a"}], "]"}]}]}], "]"}], "]"}]}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Phi]", "[", "i_", "]"}], ":=", 
    RowBox[{"angle", "[", 
     RowBox[{
      SubscriptBox["r", 
       RowBox[{"Cp", ",", 
        RowBox[{"i", "-", "1"}]}]], ",", 
      SubscriptBox["r", 
       RowBox[{"N", ",", "i"}]], ",", 
      SubscriptBox["r", 
       RowBox[{"Ca", ",", "i"}]], ",", 
      SubscriptBox["r", 
       RowBox[{"Cp", ",", "i"}]]}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Psi]", "[", "i_", "]"}], ":=", 
    RowBox[{"angle", "[", 
     RowBox[{
      SubscriptBox["r", 
       RowBox[{"N", ",", "i"}]], ",", 
      SubscriptBox["r", 
       RowBox[{"Ca", ",", "i"}]], ",", 
      SubscriptBox["r", 
       RowBox[{"Cp", ",", "i"}]], ",", 
      SubscriptBox["r", 
       RowBox[{"N", ",", 
        RowBox[{"i", "+", "1"}]}]]}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"VRamaI", "[", "i_", "]"}], ":=", 
    RowBox[{
     UnderoverscriptBox["\[Sum]", 
      RowBox[{"j", "=", "1"}], "6"], 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"w", "[", 
          RowBox[{"[", "j", "]"}], "]"}], "\[NotEqual]", "0.0"}], " ", "&&", 
        " ", 
        RowBox[{
         RowBox[{"aps", "[", 
          RowBox[{"i", ",", "j"}], "]"}], "\[NotEqual]", "0.0"}]}], ",", 
       RowBox[{
        RowBox[{"w", "[", 
         RowBox[{"[", "j", "]"}], "]"}], 
        RowBox[{"Exp", "[", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"Sigma", "[", 
            RowBox[{"[", "j", "]"}], "]"}]}], 
          RowBox[{"(", " ", 
           RowBox[{
            RowBox[{
             RowBox[{"phiw", "[", 
              RowBox[{"[", "j", "]"}], "]"}], " ", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Cos", "[", 
                 RowBox[{
                  RowBox[{"\[Phi]", "[", "i", "]"}], "-", 
                  RowBox[{"phi0", "[", 
                   RowBox[{"[", "j", "]"}], "]"}]}], "]"}], "-", "1.0"}], 
               ")"}], "2"]}], "+", 
            RowBox[{
             RowBox[{"psiw", "[", 
              RowBox[{"[", "j", "]"}], "]"}], " ", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Cos", "[", 
                 RowBox[{
                  RowBox[{"\[Psi]", "[", "i", "]"}], "-", 
                  RowBox[{"psi0", "[", 
                   RowBox[{"[", "j", "]"}], "]"}]}], "]"}], "-", "1.0"}], 
               ")"}], "2"]}]}], ")"}]}], "]"}]}], ",", "0.0"}], "]"}]}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"VRamaIPr", "[", "i_", "]"}], ":=", 
    RowBox[{
     UnderoverscriptBox["\[Sum]", 
      RowBox[{"j", "=", "1"}], "6"], 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"wPr", "[", 
          RowBox[{"[", "j", "]"}], "]"}], "\[NotEqual]", "0.0"}], " ", "&&", 
        " ", 
        RowBox[{
         RowBox[{"aps", "[", 
          RowBox[{"i", ",", "j"}], "]"}], "\[NotEqual]", "0.0"}]}], ",", 
       RowBox[{
        RowBox[{"wPr", "[", 
         RowBox[{"[", "j", "]"}], "]"}], 
        RowBox[{"Exp", "[", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"SigmaPr", "[", 
            RowBox[{"[", "j", "]"}], "]"}]}], 
          RowBox[{"(", " ", 
           RowBox[{
            RowBox[{
             RowBox[{"phiwPr", "[", 
              RowBox[{"[", "j", "]"}], "]"}], " ", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Cos", "[", 
                 RowBox[{
                  RowBox[{"\[Phi]", "[", "i", "]"}], "-", 
                  RowBox[{"phi0Pr", "[", 
                   RowBox[{"[", "j", "]"}], "]"}]}], "]"}], "-", "1.0"}], 
               ")"}], "2"]}], "+", 
            RowBox[{
             RowBox[{"psiwPr", "[", 
              RowBox[{"[", "j", "]"}], "]"}], " ", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Cos", "[", 
                 RowBox[{
                  RowBox[{"\[Psi]", "[", "i", "]"}], "-", 
                  RowBox[{"psi0Pr", "[", 
                   RowBox[{"[", "j", "]"}], "]"}]}], "]"}], "-", "1.0"}], 
               ")"}], "2"]}]}], ")"}]}], "]"}]}], ",", "0.0"}], "]"}]}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Vramaij", "[", 
     RowBox[{"i_", ",", "j_"}], "]"}], " ", ":=", " ", 
    RowBox[{
     RowBox[{"-", "\[Lambda]Rama"}], " ", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"se", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "\[Equal]", "8"}], " ", "||", " ", 
        RowBox[{"i", "\[Equal]", "1"}], " ", "||", " ", 
        RowBox[{"i", "\[Equal]", "M"}], " ", "||", " ", 
        RowBox[{
         RowBox[{"aps", "[", 
          RowBox[{"i", ",", "j"}], "]"}], "\[Equal]", "0.0"}]}], ",", "0.0", 
       ",", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"se", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "\[Equal]", "15"}], " ", ",", 
         RowBox[{
          RowBox[{"wPr", "[", 
           RowBox[{"[", "j", "]"}], "]"}], 
          RowBox[{"Exp", "[", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"SigmaPr", "[", 
              RowBox[{"[", "j", "]"}], "]"}]}], 
            RowBox[{"(", " ", 
             RowBox[{
              RowBox[{
               RowBox[{"phiwPr", "[", 
                RowBox[{"[", "j", "]"}], "]"}], " ", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"Cos", "[", 
                   RowBox[{
                    RowBox[{"\[Phi]", "[", "i", "]"}], "-", 
                    RowBox[{"phi0Pr", "[", 
                    RowBox[{"[", "j", "]"}], "]"}]}], "]"}], "-", "1.0"}], 
                 ")"}], "2"]}], "+", 
              RowBox[{
               RowBox[{"psiwPr", "[", 
                RowBox[{"[", "j", "]"}], "]"}], " ", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"Cos", "[", 
                   RowBox[{
                    RowBox[{"\[Psi]", "[", "i", "]"}], "-", 
                    RowBox[{"psi0Pr", "[", 
                    RowBox[{"[", "j", "]"}], "]"}]}], "]"}], "-", "1.0"}], 
                 ")"}], "2"]}]}], ")"}]}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"w", "[", 
           RowBox[{"[", "j", "]"}], "]"}], 
          RowBox[{"Exp", "[", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"Sigma", "[", 
              RowBox[{"[", "j", "]"}], "]"}]}], 
            RowBox[{"(", " ", 
             RowBox[{
              RowBox[{
               RowBox[{"phiw", "[", 
                RowBox[{"[", "j", "]"}], "]"}], " ", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"Cos", "[", 
                   RowBox[{
                    RowBox[{"\[Phi]", "[", "i", "]"}], "-", 
                    RowBox[{"phi0", "[", 
                    RowBox[{"[", "j", "]"}], "]"}]}], "]"}], "-", "1.0"}], 
                 ")"}], "2"]}], "+", 
              RowBox[{
               RowBox[{"psiw", "[", 
                RowBox[{"[", "j", "]"}], "]"}], " ", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"Cos", "[", 
                   RowBox[{
                    RowBox[{"\[Psi]", "[", "i", "]"}], "-", 
                    RowBox[{"psi0", "[", 
                    RowBox[{"[", "j", "]"}], "]"}]}], "]"}], "-", "1.0"}], 
                 ")"}], "2"]}]}], ")"}]}], "]"}]}]}], "]"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"Vrama", " ", ":=", " ", 
    RowBox[{
     RowBox[{"-", "\[Lambda]Rama"}], 
     RowBox[{
      UnderoverscriptBox["\[Sum]", 
       RowBox[{"i", "=", "2"}], 
       RowBox[{"M", "-", "1"}]], 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"se", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "\[Equal]", "15"}], ",", 
        RowBox[{"VRamaIPr", "[", "i", "]"}], ",", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"se", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "\[Equal]", "8"}], ",", "0.0", 
          ",", 
          RowBox[{"VRamaI", "[", "i", "]"}]}], "]"}]}], 
       "]"}]}]}]}]}]}]], "Input",
 CellOpen->False,
 CellChangeTimes->CompressedData["
1:eJwdzH8s1AEABfA7dSwdOl3uzNJSW5u27lAtI3Z114y5rtudEDHO5deia3GN
cRRt3W1ohZ1zrLP1y49WpC50rlYznZDIVBzSrk6UNGGn7/v+8fbZ297e7pQc
cZoThUIJIQJVIWY7c9LG047baDsIv9yP9oFDUQxfOHfgvR90L/E5BA9GvAiG
z3Ln+ZDPZUfBn70cEaySZkmhOSAgCdLfxqVB4VpsBpxyKrkAi+hqUln84iXy
v6zlCiztNt6GzYwPTdBbd/IxVKXHkA5SszvJvcGjD75KoAzAdVUK6Urx9Efo
5towAc8LKmZhR637V6jhVTC9CPvlEd7wNz1uH7y6i+oPAzWvOaT/grhwmzlc
AI3bNyKgvihSCEVLJgksHz2eCK3ZCwUwOXq9kvyN96mCPUG5tyCntqgW1tX/
0UFD/mIbbHzz2Qipq/o+mN11xwLtLn9JWdTLw3CS9W4E+slqxuETZyupIpem
ZRHml1Xr4A0l1QAjPURNsCDP0QqdmzsfwuGYtnY4Uc02QaE0cRA6TmhHYJdI
ukDuriuWoNma6YDsM/00NqFL8vIe6LUg8YfdMyYuVB77RNpetxJGduF8NDwq
k0ghV1qcAFuNKjl0DIVmwp5ALwV8+WtLHuRMBpZA+hJfDY3pokpoaS0kNbG+
VUPFNKMGCvQdOhg219sIJaXlazBB7bkBk6OWY70JV9208XBdpi+HA46d1yDL
95QGzqbKK2DOWPdTaGjgP4fOacytGYRi/l46DH8g1tgIGalB9VCilStdp2w8
9VlpIXT3a7vpSWgeGiW9e69lE5MwVqykwblHmyUw1JIlhRmS4CT4Q3VYBiNX
BFZ48ZzFDk/bRcNH9n/n2WZSx+B/GeHo8Q==
  "]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "THIS", " ", "BLOCK", " ", "DEFINES", " ", "THE", " ", "WATER", " ", 
     "POTENTIAL"}], ",", " ", 
    RowBox[{
    "HELIX", " ", "POTENTIAL", " ", "AND", " ", "BURIAL", " ", 
     "POTENTIAL"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"WATER", " ", "POTENTIAL"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"waterkappa", " ", "=", "5.0"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"waterkappasigma", " ", "=", " ", "7.0"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"\[Rho]0", " ", "=", " ", "2.6"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"contactcutoff", " ", "=", " ", "13"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"rmin", "=", 
     RowBox[{"{", 
      RowBox[{"4.5", ",", "6.5"}], "}"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"rmax", "=", 
     RowBox[{"{", 
      RowBox[{"6.5", ",", "9.5"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"A", "=", 
     RowBox[{"ToExpression", "[", 
      RowBox[{"StringSplit", "[", 
       RowBox[{"ReadList", "[", 
        RowBox[{"\"\<gamma.dat\>\"", ",", "String"}], "]"}], "]"}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"gamma", " ", "=", " ", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"A", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"210", "k"}], "+", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"j", "\[GreaterEqual]", "i"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"i", "-", "1"}], ")"}], 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"2", " ", "20"}], " ", "-", "i"}], ")"}], "/", 
               "2"}]}], " ", "+", "j"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"j", "-", "1"}], ")"}], 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"2", " ", "20"}], " ", "-", "j"}], ")"}], "/", 
               "2"}]}], " ", "+", "i"}]}], "]"}]}], "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "0", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "20"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", "20"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"rw", "[", 
     RowBox[{"i_", ",", "j_"}], "]"}], ":=", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"se", "[", 
        RowBox[{"[", "i", "]"}], "]"}], "\[Equal]", "8"}], ",", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"se", "[", 
          RowBox[{"[", "j", "]"}], "]"}], "\[Equal]", "8"}], ",", 
        RowBox[{"MyNorm", "[", 
         RowBox[{
          SubscriptBox["r", 
           RowBox[{"Ca", ",", "i"}]], "-", 
          SubscriptBox["r", 
           RowBox[{"Ca", ",", "j"}]]}], "]"}], ",", 
        RowBox[{"MyNorm", "[", 
         RowBox[{
          SubscriptBox["r", 
           RowBox[{"Ca", ",", "i"}]], "-", 
          SubscriptBox["r", 
           RowBox[{"Cb", ",", "j"}]]}], "]"}]}], "]"}], ",", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"se", "[", 
          RowBox[{"[", "j", "]"}], "]"}], "\[Equal]", "8"}], ",", 
        RowBox[{"MyNorm", "[", 
         RowBox[{
          SubscriptBox["r", 
           RowBox[{"Cb", ",", "i"}]], "-", 
          SubscriptBox["r", 
           RowBox[{"Ca", ",", "j"}]]}], "]"}], ",", 
        RowBox[{"MyNorm", "[", 
         RowBox[{
          SubscriptBox["r", 
           RowBox[{"Cb", ",", "i"}]], "-", 
          SubscriptBox["r", 
           RowBox[{"Cb", ",", "j"}]]}], "]"}]}], "]"}]}], "]"}]}], " ", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"theta", "[", 
     RowBox[{"i_", ",", "j_", ",", "iwell_"}], "]"}], ":=", 
    RowBox[{"0.25", " ", 
     RowBox[{"(", 
      RowBox[{"1", "+", 
       RowBox[{"Tanh", "[", 
        RowBox[{"waterkappa", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"rw", "[", 
            RowBox[{"i", ",", "j"}], "]"}], "-", 
           RowBox[{"rmin", "[", 
            RowBox[{"[", "iwell", "]"}], "]"}]}], ")"}]}], "]"}]}], ")"}], 
     RowBox[{"(", 
      RowBox[{"1", "+", 
       RowBox[{"Tanh", "[", 
        RowBox[{"waterkappa", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"rmax", "[", 
            RowBox[{"[", "iwell", "]"}], "]"}], "-", 
           RowBox[{"rw", "[", 
            RowBox[{"i", ",", "j"}], "]"}]}], ")"}]}], "]"}]}], ")"}]}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Rho]", "[", "i_", "]"}], ":=", 
    RowBox[{
     UnderoverscriptBox["\[Sum]", 
      RowBox[{"j", "=", "1"}], "M"], 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Abs", "[", 
         RowBox[{"i", "-", "j"}], "]"}], ">", "1"}], ",", 
       RowBox[{"theta", "[", 
        RowBox[{"i", ",", "j", ",", "1"}], "]"}], ",", "0"}], "]"}]}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"sigma", "[", 
     RowBox[{"i_", ",", "j_"}], "]"}], ":=", 
    RowBox[{"0.25", " ", 
     RowBox[{"(", 
      RowBox[{"1", "-", 
       RowBox[{"Tanh", "[", 
        RowBox[{"waterkappasigma", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"\[Rho]", "[", "i", "]"}], "-", "\[Rho]0"}], ")"}]}], 
        "]"}]}], ")"}], 
     RowBox[{"(", 
      RowBox[{"1", "-", 
       RowBox[{"Tanh", "[", 
        RowBox[{"waterkappasigma", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"\[Rho]", "[", "j", "]"}], "-", "\[Rho]0"}], ")"}]}], 
        "]"}]}], ")"}]}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Vwater", ":=", 
     RowBox[{"-", 
      RowBox[{
       UnderoverscriptBox["\[Sum]", 
        RowBox[{"i", "=", "1"}], 
        RowBox[{"M", "-", "contactcutoff"}]], 
       RowBox[{
        UnderoverscriptBox["\[Sum]", 
         RowBox[{"j", "=", 
          RowBox[{"i", "+", "contactcutoff"}]}], "M"], 
        RowBox[{
         RowBox[{"theta", "[", 
          RowBox[{"i", ",", "j", ",", "2"}], "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"gamma", "[", 
             RowBox[{"[", 
              RowBox[{"2", ",", 
               RowBox[{"se", "[", 
                RowBox[{"[", "i", "]"}], "]"}], ",", 
               RowBox[{"se", "[", 
                RowBox[{"[", "j", "]"}], "]"}], ",", "1"}], "]"}], "]"}], " ", 
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{"sigma", "[", 
               RowBox[{"i", ",", "j"}], "]"}]}], ")"}]}], "+", 
           RowBox[{
            RowBox[{"gamma", "[", 
             RowBox[{"[", 
              RowBox[{"2", ",", 
               RowBox[{"se", "[", 
                RowBox[{"[", "i", "]"}], "]"}], ",", 
               RowBox[{"se", "[", 
                RowBox[{"[", "j", "]"}], "]"}], ",", "2"}], "]"}], "]"}], " ", 
            RowBox[{"sigma", "[", 
             RowBox[{"i", ",", "j"}], "]"}]}]}], ")"}]}]}]}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Vwaterij", "[", 
      RowBox[{"i_", ",", "j_"}], "]"}], ":=", 
     RowBox[{"-", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Abs", "[", 
          RowBox[{"i", "-", "j"}], "]"}], "\[GreaterEqual]", 
         "contactcutoff"}], ",", 
        RowBox[{
         RowBox[{"theta", "[", 
          RowBox[{"i", ",", "j", ",", "2"}], "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"gamma", "[", 
             RowBox[{"[", 
              RowBox[{"2", ",", 
               RowBox[{"se", "[", 
                RowBox[{"[", "i", "]"}], "]"}], ",", 
               RowBox[{"se", "[", 
                RowBox[{"[", "j", "]"}], "]"}], ",", "1"}], "]"}], "]"}], " ", 
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{"sigma", "[", 
               RowBox[{"i", ",", "j"}], "]"}]}], ")"}]}], "+", 
           RowBox[{
            RowBox[{"gamma", "[", 
             RowBox[{"[", 
              RowBox[{"2", ",", 
               RowBox[{"se", "[", 
                RowBox[{"[", "i", "]"}], "]"}], ",", 
               RowBox[{"se", "[", 
                RowBox[{"[", "j", "]"}], "]"}], ",", "2"}], "]"}], "]"}], " ", 
            RowBox[{"sigma", "[", 
             RowBox[{"i", ",", "j"}], "]"}]}]}], ")"}]}], ",", "0"}], 
       "]"}]}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"BURIAL", " ", "POTENTIAL"}], " ", "*)"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{"burialkappa", "=", "4.0"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"romin", " ", "=", 
     RowBox[{"{", 
      RowBox[{"0.0", ",", "3.0", ",", "6.0"}], "}"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"romax", " ", "=", 
     RowBox[{"{", 
      RowBox[{"3.0", ",", "6.0", ",", "9.0"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"A", "=", 
     RowBox[{"ReadList", "[", 
      RowBox[{"\"\<burial_gamma.dat\>\"", ",", "Real"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"burialgamma", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"A", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"3", 
           RowBox[{"(", 
            RowBox[{"i", "-", "1"}], ")"}]}], "+", "j"}], "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "20"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", "3"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"S", "[", 
     RowBox[{"i_", ",", "\[Mu]_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"Tanh", "[", 
      RowBox[{"burialkappa", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\[Rho]", "[", "i", "]"}], "-", 
         RowBox[{"romin", "[", 
          RowBox[{"[", "\[Mu]", "]"}], "]"}]}], ")"}]}], "]"}], "+", 
     RowBox[{"Tanh", "[", 
      RowBox[{"burialkappa", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"romax", "[", 
          RowBox[{"[", "\[Mu]", "]"}], "]"}], "-", 
         RowBox[{"\[Rho]", "[", "i", "]"}]}], ")"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"Vburial", ":=", 
    RowBox[{
     RowBox[{"-", "0.5"}], 
     RowBox[{
      UnderoverscriptBox["\[Sum]", 
       RowBox[{"i", "=", "1"}], "M"], 
      RowBox[{
       UnderoverscriptBox["\[Sum]", 
        RowBox[{"\[Mu]", "=", "1"}], "3"], " ", 
       RowBox[{
        RowBox[{"burialgamma", "[", 
         RowBox[{"[", 
          RowBox[{
           RowBox[{"se", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", "\[Mu]"}], "]"}], "]"}], 
        RowBox[{"S", "[", 
         RowBox[{"i", ",", "\[Mu]"}], "]"}]}]}]}]}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"HELIX", " ", "POTENTIAL"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Lambda]Helix", "=", "1.5"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"helixgammap", "=", "2.0"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"helixgammaw", "=", 
     RowBox[{"-", "1.0"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"helixkappa", "=", "7.0"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"helixkappasigma", "=", "7.0"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"helixtreshold", "=", "3.0"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"helixidiff", "=", "4"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"helixcutoff", "=", "15.0"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"h4prob", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "0.77"}], ",", 
       RowBox[{"-", "0.68"}], ",", 
       RowBox[{"-", "0.07"}], ",", 
       RowBox[{"-", "0.15"}], ",", 
       RowBox[{"-", "0.23"}], ",", 
       RowBox[{"-", "0.33"}], ",", 
       RowBox[{"-", "0.27"}], ",", " ", "0.0", ",", 
       RowBox[{"-", "0.06"}], ",", 
       RowBox[{"-", "0.23"}], ",", 
       RowBox[{"-", "0.62"}], ",", 
       RowBox[{"-", "0.65"}], ",", 
       RowBox[{"-", "0.50"}], ",", 
       RowBox[{"-", "0.41"}], ",", " ", "3.0", ",", 
       RowBox[{"-", "0.35"}], ",", 
       RowBox[{"-", "0.11"}], ",", 
       RowBox[{"-", "0.45"}], ",", 
       RowBox[{"-", "0.17"}], ",", 
       RowBox[{"-", "0.14"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Theta]pair", "[", 
     RowBox[{"i_", ",", "j_"}], "]"}], ":=", 
    RowBox[{"Exp", "[", 
     RowBox[{
      RowBox[{"-", 
       FractionBox[
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"MyNorm", "[", 
            RowBox[{
             SubscriptBox["r", 
              RowBox[{"O", ",", "i"}]], "-", 
             SubscriptBox["r", 
              RowBox[{"N", ",", "j"}]]}], "]"}], "-", "rNOzero"}], ")"}], 
         "2"], 
        RowBox[{"2.0", " ", 
         SuperscriptBox["\[Sigma]NO", "2"]}]]}], "-", 
      FractionBox[
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"MyNorm", "[", 
           RowBox[{
            SubscriptBox["r", 
             RowBox[{"O", ",", "i"}]], "-", 
            SubscriptBox["r", 
             RowBox[{"H", ",", "j"}]]}], "]"}], "-", "rHOzero"}], ")"}], "2"], 
       RowBox[{"2.0", " ", 
        SuperscriptBox["\[Sigma]HO", "2"]}]]}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"thetaHelix", "[", 
     RowBox[{"i_", ",", "j_", ",", "iwell_"}], "]"}], ":=", 
    RowBox[{"0.25", " ", 
     RowBox[{"(", 
      RowBox[{"1", "+", 
       RowBox[{"Tanh", "[", 
        RowBox[{"helixkappa", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"rw", "[", 
            RowBox[{"i", ",", "j"}], "]"}], "-", 
           RowBox[{"rmin", "[", 
            RowBox[{"[", "iwell", "]"}], "]"}]}], ")"}]}], "]"}]}], ")"}], 
     RowBox[{"(", 
      RowBox[{"1", "+", 
       RowBox[{"Tanh", "[", 
        RowBox[{"helixkappa", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"rmax", "[", 
            RowBox[{"[", "iwell", "]"}], "]"}], "-", 
           RowBox[{"rw", "[", 
            RowBox[{"i", ",", "j"}], "]"}]}], ")"}]}], "]"}]}], ")"}]}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Rho]Helix", "[", "i_", "]"}], ":=", 
    RowBox[{
     UnderoverscriptBox["\[Sum]", 
      RowBox[{"j", "=", "1"}], "M"], 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Abs", "[", 
         RowBox[{"i", "-", "j"}], "]"}], ">", "1"}], ",", 
       RowBox[{"thetaHelix", "[", 
        RowBox[{"i", ",", "j", ",", "1"}], "]"}], ",", "0"}], "]"}]}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"sigmaHelix", "[", 
     RowBox[{"i_", ",", "j_"}], "]"}], ":=", 
    RowBox[{"0.25", " ", 
     RowBox[{"(", 
      RowBox[{"1", "-", 
       RowBox[{"Tanh", "[", 
        RowBox[{"helixkappasigma", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"\[Rho]Helix", "[", "i", "]"}], "-", "helixtreshold"}], 
          ")"}]}], "]"}]}], ")"}], 
     RowBox[{"(", 
      RowBox[{"1", "-", 
       RowBox[{"Tanh", "[", 
        RowBox[{"helixkappasigma", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"\[Rho]Helix", "[", "j", "]"}], "-", "helixtreshold"}], 
          ")"}]}], "]"}]}], ")"}]}]}], "\[IndentingNewLine]", 
   RowBox[{"VHelix", ":=", 
    RowBox[{"-", 
     RowBox[{
      UnderoverscriptBox["\[Sum]", 
       RowBox[{"i", "=", "1"}], 
       RowBox[{"M", "-", "helixidiff", "-", "1"}]], 
      RowBox[{"\[Lambda]Helix", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"helixgammap", " ", 
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"sigmaHelix", "[", 
             RowBox[{"i", ",", 
              RowBox[{"i", "+", "4"}]}], "]"}]}], ")"}]}], "+", " ", 
         RowBox[{"helixgammaw", " ", 
          RowBox[{"sigmaHelix", "[", 
           RowBox[{"i", ",", 
            RowBox[{"i", "+", "4"}]}], "]"}]}]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"h4prob", "[", 
          RowBox[{"[", 
           RowBox[{"se", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], "+", 
         RowBox[{"h4prob", "[", 
          RowBox[{"[", 
           RowBox[{"se", "[", 
            RowBox[{"[", 
             RowBox[{"i", "+", "4"}], "]"}], "]"}], "]"}], "]"}]}], ")"}], 
       " ", 
       RowBox[{"\[Theta]pair", "[", 
        RowBox[{"i", ",", 
         RowBox[{"i", "+", "4"}]}], "]"}]}]}]}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"VHelixi", "[", "i_", "]"}], ":=", 
    RowBox[{"-", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"i", ">", 
        RowBox[{"M", "-", "helixidiff"}]}], ",", "0.0", ",", 
       RowBox[{"\[Lambda]Helix", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"helixgammap", " ", 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"sigmaHelix", "[", 
              RowBox[{"i", ",", 
               RowBox[{"i", "+", "4"}]}], "]"}]}], ")"}]}], "+", " ", 
          RowBox[{"helixgammaw", " ", 
           RowBox[{"sigmaHelix", "[", 
            RowBox[{"i", ",", 
             RowBox[{"i", "+", "4"}]}], "]"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"h4prob", "[", 
           RowBox[{"[", 
            RowBox[{"se", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], "+", 
          RowBox[{"h4prob", "[", 
           RowBox[{"[", 
            RowBox[{"se", "[", 
             RowBox[{"[", 
              RowBox[{"i", "+", "4"}], "]"}], "]"}], "]"}], "]"}]}], ")"}], 
        " ", 
        RowBox[{"\[Theta]pair", "[", 
         RowBox[{"i", ",", 
          RowBox[{"i", "+", "4"}]}], "]"}]}]}], "]"}]}]}]}]}]], "Input",
 CellOpen->False,
 CellChangeTimes->{{3.4912367820456*^9, 3.4912368171236*^9}, {
   3.4912369024076*^9, 3.4912369101745996`*^9}, {3.4912369558136*^9, 
   3.4912370787656*^9}, {3.4912371149556*^9, 3.4912371272746*^9}, {
   3.4912387389346*^9, 3.4912387450866003`*^9}, {3.4912387930916*^9, 
   3.4912388112595997`*^9}, {3.4912388414736*^9, 3.4912388661916*^9}, {
   3.4912389047506*^9, 3.4912389141336*^9}, {3.4912390996046*^9, 
   3.4912391338176003`*^9}, {3.4912391741436*^9, 3.4912391795186*^9}, {
   3.4912404447326*^9, 3.4912404519666*^9}, {3.4912405329056*^9, 
   3.4912405336176*^9}, {3.4912405806156*^9, 3.4912406427956*^9}, {
   3.4912406728886003`*^9, 3.4912407571126003`*^9}, {3.491403767951*^9, 
   3.49140381875*^9}, {3.491403856148*^9, 3.491403921064*^9}, {
   3.4914042334709997`*^9, 3.491404254223*^9}, {3.4914043921029997`*^9, 
   3.491404394158*^9}, {3.4914075806*^9, 3.491407580881*^9}, {
   3.491407747216*^9, 3.4914077838129997`*^9}, {3.491411718149*^9, 
   3.491411733428*^9}, {3.491412204328*^9, 3.491412298362*^9}, {
   3.491412382873*^9, 3.491412487744*^9}, {3.491412532894*^9, 
   3.491412542645*^9}, {3.4914129028570004`*^9, 3.49141296115*^9}, {
   3.491414420347*^9, 3.491414442722*^9}, {3.4914144803599997`*^9, 
   3.491414496704*^9}, {3.4914145513310003`*^9, 3.491414666727*^9}, {
   3.491414700868*^9, 3.491414874782*^9}, {3.491430772488*^9, 
   3.491430778663*^9}, {3.491430818593*^9, 3.491430908502*^9}, {
   3.491430963159*^9, 3.491430968212*^9}, {3.491431055601*^9, 
   3.491431056152*^9}, {3.491431097566*^9, 3.4914312532939997`*^9}, {
   3.491431305645*^9, 3.49143131901*^9}, {3.491431424668*^9, 
   3.4914314427*^9}, {3.491431645451*^9, 3.491431689572*^9}, {
   3.491431729738*^9, 3.4914317581280003`*^9}, {3.4914318069040003`*^9, 
   3.491432018637*^9}, {3.491435150863*^9, 3.491435151727*^9}, {
   3.491435614043*^9, 3.491435614741*^9}, {3.491505941273*^9, 
   3.4915059721140003`*^9}, {3.4915074560880003`*^9, 3.49150753391*^9}, 
   3.49152942466028*^9, {3.4915302969262805`*^9, 3.4915302997042804`*^9}, {
   3.4915303324072804`*^9, 3.4915303326242805`*^9}, 3.4915317476862803`*^9, {
   3.4961593656041183`*^9, 3.496159431985414*^9}, {3.496159463935855*^9, 
   3.496159567355567*^9}, {3.496159936336125*^9, 3.496160001744379*^9}, {
   3.496160057518712*^9, 3.496160080317877*^9}, {3.496160346018867*^9, 
   3.496160380145644*^9}, {3.496160671530918*^9, 3.49616067559326*^9}, {
   3.496160713815338*^9, 3.496160768902717*^9}, {3.496160806069759*^9, 
   3.4961608181974583`*^9}, 3.496168649590753*^9, {3.496168704145046*^9, 
   3.4961687277469673`*^9}, {3.4961689029546824`*^9, 3.496168964599119*^9}, {
   3.496169050387465*^9, 3.496169060426627*^9}, {3.496169097128862*^9, 
   3.496169127336895*^9}, {3.496169296898683*^9, 3.496169304947937*^9}, {
   3.511724198753471*^9, 3.511724199209133*^9}, 3.5117242298679457`*^9, 
   3.511724264288126*^9, {3.512315837151211*^9, 3.512315889330798*^9}, {
   3.5123217310053864`*^9, 3.512321734984325*^9}, {3.512321775810339*^9, 
   3.512321800598653*^9}}],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "THIS", " ", "BLOCK", " ", "DEFINES", " ", "THE", " ", "RAMACHANDRAN", " ",
     "POTENTIAL"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"aps", "[", 
     RowBox[{"i_", ",", "j_"}], "]"}], ":=", 
    RowBox[{"Switch", "[", 
     RowBox[{
     "j", ",", "1", ",", "1.0", ",", "2", ",", "1.0", ",", "3", ",", "1.0", 
      ",", "4", ",", "0.0", ",", "5", ",", 
      RowBox[{"ssweight5", "[", 
       RowBox[{"[", "i", "]"}], "]"}], ",", "6", ",", 
      RowBox[{"ssweight6", "[", 
       RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ArcTan2", "[", 
     RowBox[{"y_", ",", "x_"}], "]"}], ":=", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"x", "\[Equal]", "0"}], ",", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"y", ">", "0"}], ",", 
        FractionBox["\[Pi]", "2"], ",", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"y", "<", "0"}], ",", 
          RowBox[{"-", 
           FractionBox["\[Pi]", "2"]}], ",", "\"\<undefine\>\""}], "]"}]}], 
       "]"}], ",", 
      RowBox[{
       RowBox[{"ArcTan", "[", 
        RowBox[{"y", "/", "x"}], "]"}], "+", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"x", "<", "0"}], ",", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"y", "\[GreaterEqual]", "0"}], ",", "\[Pi]", ",", 
           RowBox[{"-", "\[Pi]"}]}], "]"}], ",", "0"}], "]"}]}]}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"angle", "[", 
     RowBox[{"r1_", ",", "r2_", ",", "r3_", ",", "r4_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"c", "=", 
         RowBox[{"r2", "-", "r1"}]}], ",", " ", 
        RowBox[{"b", "=", 
         RowBox[{"r3", "-", "r2"}]}], ",", 
        RowBox[{"a", "=", 
         RowBox[{"r4", "-", "r3"}]}]}], "}"}], ",", 
      RowBox[{"Return", "[", 
       RowBox[{"ArcTan2", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"MyNorm", "[", "b", "]"}], " ", 
          RowBox[{"c", ".", 
           RowBox[{"Cross", "[", 
            RowBox[{"b", ",", "a"}], "]"}]}]}], ",", 
         RowBox[{
          RowBox[{"Cross", "[", 
           RowBox[{"c", ",", "b"}], "]"}], ".", 
          RowBox[{"Cross", "[", 
           RowBox[{"b", ",", "a"}], "]"}]}]}], "]"}], "]"}]}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Phi]", "[", "i_", "]"}], ":=", 
    RowBox[{"angle", "[", 
     RowBox[{
      SubscriptBox["r", 
       RowBox[{"Cp", ",", 
        RowBox[{"i", "-", "1"}]}]], ",", 
      SubscriptBox["r", 
       RowBox[{"N", ",", "i"}]], ",", 
      SubscriptBox["r", 
       RowBox[{"Ca", ",", "i"}]], ",", 
      SubscriptBox["r", 
       RowBox[{"Cp", ",", "i"}]]}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Psi]", "[", "i_", "]"}], ":=", 
    RowBox[{"angle", "[", 
     RowBox[{
      SubscriptBox["r", 
       RowBox[{"N", ",", "i"}]], ",", 
      SubscriptBox["r", 
       RowBox[{"Ca", ",", "i"}]], ",", 
      SubscriptBox["r", 
       RowBox[{"Cp", ",", "i"}]], ",", 
      SubscriptBox["r", 
       RowBox[{"N", ",", 
        RowBox[{"i", "+", "1"}]}]]}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"VRamaI", "[", "i_", "]"}], ":=", 
    RowBox[{
     UnderoverscriptBox["\[Sum]", 
      RowBox[{"j", "=", "1"}], "6"], 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"w", "[", 
          RowBox[{"[", "j", "]"}], "]"}], "\[NotEqual]", "0.0"}], " ", "&&", 
        " ", 
        RowBox[{
         RowBox[{"aps", "[", 
          RowBox[{"i", ",", "j"}], "]"}], "\[NotEqual]", "0.0"}]}], ",", 
       RowBox[{
        RowBox[{"w", "[", 
         RowBox[{"[", "j", "]"}], "]"}], 
        RowBox[{"Exp", "[", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"Sigma", "[", 
            RowBox[{"[", "j", "]"}], "]"}]}], 
          RowBox[{"(", " ", 
           RowBox[{
            RowBox[{
             RowBox[{"phiw", "[", 
              RowBox[{"[", "j", "]"}], "]"}], " ", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Cos", "[", 
                 RowBox[{
                  RowBox[{"\[Phi]", "[", "i", "]"}], "-", 
                  RowBox[{"phi0", "[", 
                   RowBox[{"[", "j", "]"}], "]"}]}], "]"}], "-", "1.0"}], 
               ")"}], "2"]}], "+", 
            RowBox[{
             RowBox[{"psiw", "[", 
              RowBox[{"[", "j", "]"}], "]"}], " ", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Cos", "[", 
                 RowBox[{
                  RowBox[{"\[Psi]", "[", "i", "]"}], "-", 
                  RowBox[{"psi0", "[", 
                   RowBox[{"[", "j", "]"}], "]"}]}], "]"}], "-", "1.0"}], 
               ")"}], "2"]}]}], ")"}]}], "]"}]}], ",", "0.0"}], "]"}]}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"VRamaIPr", "[", "i_", "]"}], ":=", 
    RowBox[{
     UnderoverscriptBox["\[Sum]", 
      RowBox[{"j", "=", "1"}], "6"], 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"wPr", "[", 
          RowBox[{"[", "j", "]"}], "]"}], "\[NotEqual]", "0.0"}], " ", "&&", 
        " ", 
        RowBox[{
         RowBox[{"aps", "[", 
          RowBox[{"i", ",", "j"}], "]"}], "\[NotEqual]", "0.0"}]}], ",", 
       RowBox[{
        RowBox[{"wPr", "[", 
         RowBox[{"[", "j", "]"}], "]"}], 
        RowBox[{"Exp", "[", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"SigmaPr", "[", 
            RowBox[{"[", "j", "]"}], "]"}]}], 
          RowBox[{"(", " ", 
           RowBox[{
            RowBox[{
             RowBox[{"phiwPr", "[", 
              RowBox[{"[", "j", "]"}], "]"}], " ", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Cos", "[", 
                 RowBox[{
                  RowBox[{"\[Phi]", "[", "i", "]"}], "-", 
                  RowBox[{"phi0Pr", "[", 
                   RowBox[{"[", "j", "]"}], "]"}]}], "]"}], "-", "1.0"}], 
               ")"}], "2"]}], "+", 
            RowBox[{
             RowBox[{"psiwPr", "[", 
              RowBox[{"[", "j", "]"}], "]"}], " ", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Cos", "[", 
                 RowBox[{
                  RowBox[{"\[Psi]", "[", "i", "]"}], "-", 
                  RowBox[{"psi0Pr", "[", 
                   RowBox[{"[", "j", "]"}], "]"}]}], "]"}], "-", "1.0"}], 
               ")"}], "2"]}]}], ")"}]}], "]"}]}], ",", "0.0"}], "]"}]}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Vramaij", "[", 
     RowBox[{"i_", ",", "j_"}], "]"}], " ", ":=", " ", 
    RowBox[{
     RowBox[{"-", "\[Lambda]Rama"}], " ", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"se", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "\[Equal]", "8"}], " ", "||", " ", 
        RowBox[{"i", "\[Equal]", "1"}], " ", "||", " ", 
        RowBox[{"i", "\[Equal]", "M"}], " ", "||", " ", 
        RowBox[{
         RowBox[{"aps", "[", 
          RowBox[{"i", ",", "j"}], "]"}], "\[Equal]", "0.0"}]}], ",", "0.0", 
       ",", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"se", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "\[Equal]", "15"}], " ", ",", 
         RowBox[{
          RowBox[{"wPr", "[", 
           RowBox[{"[", "j", "]"}], "]"}], 
          RowBox[{"Exp", "[", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"SigmaPr", "[", 
              RowBox[{"[", "j", "]"}], "]"}]}], 
            RowBox[{"(", " ", 
             RowBox[{
              RowBox[{
               RowBox[{"phiwPr", "[", 
                RowBox[{"[", "j", "]"}], "]"}], " ", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"Cos", "[", 
                   RowBox[{
                    RowBox[{"\[Phi]", "[", "i", "]"}], "-", 
                    RowBox[{"phi0Pr", "[", 
                    RowBox[{"[", "j", "]"}], "]"}]}], "]"}], "-", "1.0"}], 
                 ")"}], "2"]}], "+", 
              RowBox[{
               RowBox[{"psiwPr", "[", 
                RowBox[{"[", "j", "]"}], "]"}], " ", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"Cos", "[", 
                   RowBox[{
                    RowBox[{"\[Psi]", "[", "i", "]"}], "-", 
                    RowBox[{"psi0Pr", "[", 
                    RowBox[{"[", "j", "]"}], "]"}]}], "]"}], "-", "1.0"}], 
                 ")"}], "2"]}]}], ")"}]}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"w", "[", 
           RowBox[{"[", "j", "]"}], "]"}], 
          RowBox[{"Exp", "[", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"Sigma", "[", 
              RowBox[{"[", "j", "]"}], "]"}]}], 
            RowBox[{"(", " ", 
             RowBox[{
              RowBox[{
               RowBox[{"phiw", "[", 
                RowBox[{"[", "j", "]"}], "]"}], " ", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"Cos", "[", 
                   RowBox[{
                    RowBox[{"\[Phi]", "[", "i", "]"}], "-", 
                    RowBox[{"phi0", "[", 
                    RowBox[{"[", "j", "]"}], "]"}]}], "]"}], "-", "1.0"}], 
                 ")"}], "2"]}], "+", 
              RowBox[{
               RowBox[{"psiw", "[", 
                RowBox[{"[", "j", "]"}], "]"}], " ", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"Cos", "[", 
                   RowBox[{
                    RowBox[{"\[Psi]", "[", "i", "]"}], "-", 
                    RowBox[{"psi0", "[", 
                    RowBox[{"[", "j", "]"}], "]"}]}], "]"}], "-", "1.0"}], 
                 ")"}], "2"]}]}], ")"}]}], "]"}]}]}], "]"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"Vrama", " ", ":=", " ", 
    RowBox[{
     RowBox[{"-", "\[Lambda]Rama"}], 
     RowBox[{
      UnderoverscriptBox["\[Sum]", 
       RowBox[{"i", "=", "2"}], 
       RowBox[{"M", "-", "1"}]], 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"se", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "\[Equal]", "15"}], ",", 
        RowBox[{"VRamaIPr", "[", "i", "]"}], ",", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"se", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "\[Equal]", "8"}], ",", "0.0", 
          ",", 
          RowBox[{"VRamaI", "[", "i", "]"}]}], "]"}]}], 
       "]"}]}]}]}]}]}]], "Input",
 CellOpen->False,
 CellChangeTimes->{{3.5118051191327744`*^9, 3.511805119425357*^9}, {
  3.512316114456573*^9, 3.512316124828285*^9}, {3.51232202244118*^9, 
  3.512322028577326*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "THIS", " ", "BLOCK", " ", "DEFINES", " ", "THE", " ", "SOLVENT", " ", 
    "SEPARATED", " ", "BARRIER", " ", "POTENTIAL"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"kssb", "=", "1.0"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"kappassb", "=", "5.0"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"rssbmin", "=", "3.0"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"rssbmax", "=", "8.0"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"minsep", "=", "13"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"cbcorrection", "=", "1"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"residueradii", "=", 
     RowBox[{"{", 
      RowBox[{
      "0.00", ",", "2.04", ",", "0.57", ",", "0.57", ",", "0.36", ",", "1.11",
        ",", "1.17", ",", 
       RowBox[{"-", "1.52"}], ",", "0.87", ",", "0.67", ",", "0.79", ",", 
       "1.47", ",", "1.03", ",", "1.00", ",", 
       RowBox[{"-", "0.10"}], ",", "0.26", ",", "0.37", ",", "1.21", ",", 
       "1.15", ",", "0.39"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
      RowBox[{
      "DEFINE", " ", "THE", " ", "SEPARATION", " ", "AS", " ", "THE", " ", 
       "CB"}], "-", 
      RowBox[{
      "CB", " ", "DISTANCE", " ", "UNLESS", " ", "ONE", " ", "OR", " ", 
       "BOTH", " ", "OF", " ", "THE", " ", "RESIDUES", " ", "ARE", " ", 
       "GLYCINES"}]}], ",", " ", 
     RowBox[{
     "IN", " ", "WHICH", " ", "CASE", " ", "THE", " ", "CA", " ", 
      "COORDINATES", " ", "ARE", " ", "USED"}]}], " ", "*)"}], "\n", 
   RowBox[{
    RowBox[{"rssb", "[", 
     RowBox[{"i_", ",", "j_"}], "]"}], ":=", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"se", "[", 
        RowBox[{"[", "i", "]"}], "]"}], "\[Equal]", "8"}], ",", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"se", "[", 
          RowBox[{"[", "j", "]"}], "]"}], "\[Equal]", "8"}], ",", 
        RowBox[{"MyNorm", "[", 
         RowBox[{
          SubscriptBox["r", 
           RowBox[{"Ca", ",", "i"}]], "-", 
          SubscriptBox["r", 
           RowBox[{"Ca", ",", "j"}]]}], "]"}], ",", 
        RowBox[{"MyNorm", "[", 
         RowBox[{
          SubscriptBox["r", 
           RowBox[{"Ca", ",", "i"}]], "-", 
          SubscriptBox["r", 
           RowBox[{"Cb", ",", "j"}]]}], "]"}]}], "]"}], ",", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"se", "[", 
          RowBox[{"[", "j", "]"}], "]"}], "\[Equal]", "8"}], ",", 
        RowBox[{"MyNorm", "[", 
         RowBox[{
          SubscriptBox["r", 
           RowBox[{"Cb", ",", "i"}]], "-", 
          SubscriptBox["r", 
           RowBox[{"Ca", ",", "j"}]]}], "]"}], ",", 
        RowBox[{"MyNorm", "[", 
         RowBox[{
          SubscriptBox["r", 
           RowBox[{"Cb", ",", "i"}]], "-", 
          SubscriptBox["r", 
           RowBox[{"Cb", ",", "j"}]]}], "]"}]}], "]"}]}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "DEFINE", " ", "SHIFTED", " ", "rssbmin", " ", "AND", " ", "rssbmax", 
      " ", "WHICH", " ", "ARE", " ", "USED", " ", "IN", " ", "THE", " ", 
      "CASE", " ", "THAT", " ", "cbcorrection"}], "\[Equal]", "1"}], " ", 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"rssbminshifted", "[", 
     RowBox[{"i_", ",", "j_"}], "]"}], ":=", 
    RowBox[{"rssbmin", "+", 
     RowBox[{"residueradii", "[", 
      RowBox[{"[", 
       RowBox[{"se", "[", 
        RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], "+", 
     RowBox[{"residueradii", "[", 
      RowBox[{"[", 
       RowBox[{"se", "[", 
        RowBox[{"[", "j", "]"}], "]"}], "]"}], "]"}]}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"rssbmaxshifted", "[", 
     RowBox[{"i_", ",", "j_"}], "]"}], ":=", 
    RowBox[{"rssbmax", "+", 
     RowBox[{"residueradii", "[", 
      RowBox[{"[", 
       RowBox[{"se", "[", 
        RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], "+", 
     RowBox[{"residueradii", "[", 
      RowBox[{"[", 
       RowBox[{"se", "[", 
        RowBox[{"[", "j", "]"}], "]"}], "]"}], "]"}]}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"DEFINE", " ", "CUTOFF", " ", "DISTANCE"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"rssbmaxcutoff", "[", 
      RowBox[{"i_", ",", "j_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"cbcorrection", "\[Equal]", "1"}], ",", 
        RowBox[{"rssbmaxshifted", "[", 
         RowBox[{"i", ",", "j"}], "]"}], ",", "rssbmax"}], "]"}], "+", 
      RowBox[{"(", 
       RowBox[{"10.0", "/", "kappassb"}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "CALCULATE", " ", "THE", " ", "SOLVENT", " ", "SEPARATED", " ", "BARRIER",
      " ", "ENERGY", " ", "FOR", " ", "A", " ", "PAIR", " ", "OF", " ", 
     "RESIDUES"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Vssbij", "[", 
      RowBox[{"i_", ",", "j_"}], "]"}], ":=", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Abs", "[", 
          RowBox[{"i", "-", "j"}], "]"}], "<", "minsep"}], " ", "||", " ", 
        RowBox[{
         RowBox[{"rssb", "[", 
          RowBox[{"i", ",", "j"}], "]"}], ">", 
         RowBox[{"rssbmaxcutoff", "[", 
          RowBox[{"i", ",", "j"}], "]"}]}]}], ",", "0.0", ",", 
       RowBox[{"kssb", "*", "0.5", "*", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Tanh", "[", 
           RowBox[{"kappassb", "*", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"rssb", "[", 
               RowBox[{"i", ",", "j"}], "]"}], "-", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"cbcorrection", "\[Equal]", "1"}], ",", 
                RowBox[{"rssbminshifted", "[", 
                 RowBox[{"i", ",", "j"}], "]"}], ",", "rssbmin"}], "]"}]}], 
             ")"}]}], "]"}], "+", 
          RowBox[{"Tanh", "[", 
           RowBox[{"kappassb", "*", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"cbcorrection", "\[Equal]", "1"}], ",", 
                RowBox[{"rssbmaxshifted", "[", 
                 RowBox[{"i", ",", "j"}], "]"}], ",", "rssbmax"}], "]"}], "-", 
              RowBox[{"rssb", "[", 
               RowBox[{"i", ",", "j"}], "]"}]}], ")"}]}], "]"}]}], ")"}]}]}], 
      "]"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Vssbij", "[", 
     RowBox[{"i_", ",", "j_"}], "]"}], ":=", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Abs", "[", 
        RowBox[{"i", "-", "j"}], "]"}], "<", "minsep"}], ",", "0.0", ",", 
      RowBox[{"kssb", "*", "0.5", "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Tanh", "[", 
          RowBox[{"kappassb", "*", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"rssb", "[", 
              RowBox[{"i", ",", "j"}], "]"}], "-", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"cbcorrection", "\[Equal]", "1"}], ",", 
               RowBox[{"rssbminshifted", "[", 
                RowBox[{"i", ",", "j"}], "]"}], ",", "rssbmin"}], "]"}]}], 
            ")"}]}], "]"}], "+", 
         RowBox[{"Tanh", "[", 
          RowBox[{"kappassb", "*", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"cbcorrection", "\[Equal]", "1"}], ",", 
               RowBox[{"rssbmaxshifted", "[", 
                RowBox[{"i", ",", "j"}], "]"}], ",", "rssbmax"}], "]"}], "-", 
             
             RowBox[{"rssb", "[", 
              RowBox[{"i", ",", "j"}], "]"}]}], ")"}]}], "]"}]}], ")"}]}]}], 
     "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "CALCULATE", " ", "THE", " ", "TOTAL", " ", "SOLVENT", " ", "SEPARATED", 
     " ", "BARRIER", " ", "ENERGY"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"Vssb", ":=", 
    RowBox[{
     UnderoverscriptBox["\[Sum]", 
      RowBox[{"i", "=", "1"}], 
      RowBox[{"M", "-", "1"}]], 
     RowBox[{"(", 
      RowBox[{
       UnderoverscriptBox["\[Sum]", 
        RowBox[{"j", "=", 
         RowBox[{"i", "+", "1"}]}], "M"], 
       RowBox[{"Vssbij", "[", 
        RowBox[{"i", ",", "j"}], "]"}]}], ")"}]}]}]}]}]], "Input",
 CellChangeTimes->{{3.512334374316305*^9, 3.512334561973007*^9}, {
   3.5123345975303783`*^9, 3.5123346394852047`*^9}, {3.5123346800437937`*^9, 
   3.512334702297639*^9}, {3.512334804848846*^9, 3.512334858189114*^9}, {
   3.512334929735024*^9, 3.5123349548524017`*^9}, 3.5123350158082323`*^9, {
   3.5123350808639183`*^9, 3.5123351543303223`*^9}, {3.512335427131501*^9, 
   3.5123354896958303`*^9}, {3.512340910822135*^9, 3.512341063069209*^9}, {
   3.5123411958281116`*^9, 3.512341360456814*^9}, {3.512341419962578*^9, 
   3.512341433075323*^9}, {3.512341469787331*^9, 3.5123414897850657`*^9}, {
   3.512341530113044*^9, 3.5123415324164457`*^9}, {3.512341562473892*^9, 
   3.5123416153786077`*^9}, {3.512341653632106*^9, 3.512341669363619*^9}, {
   3.512341716832548*^9, 3.5123418833052273`*^9}, {3.512341936361721*^9, 
   3.51234201869131*^9}, {3.512342051993537*^9, 3.512342157437056*^9}, {
   3.5123423094506598`*^9, 3.512342339274049*^9}, {3.512342382254984*^9, 
   3.512342382523411*^9}, {3.512342712247609*^9, 3.512342717333022*^9}, {
   3.51234291312582*^9, 3.5123429661412907`*^9}, {3.512343125923366*^9, 
   3.512343126144085*^9}, {3.512343159541482*^9, 3.512343180409527*^9}, {
   3.512343210983222*^9, 3.5123432541630774`*^9}, {3.5123457598095713`*^9, 
   3.512345764591309*^9}, 3.5123458020234737`*^9, {3.512345864588251*^9, 
   3.5123458668123217`*^9}, {3.512345903134356*^9, 3.512346001229871*^9}, {
   3.512349801985283*^9, 3.5123499951308947`*^9}, {3.512350126229039*^9, 
   3.5123501301930113`*^9}, {3.512350443793626*^9, 3.512350482408517*^9}, {
   3.512350879308119*^9, 3.512350888961907*^9}, {3.5123510850982924`*^9, 
   3.512351085280636*^9}, {3.512351539256563*^9, 3.5123515653785667`*^9}, {
   3.512351676650198*^9, 3.512351710406589*^9}, {3.512351768445006*^9, 
   3.512351778216229*^9}, {3.512353090641622*^9, 3.512353165722602*^9}, {
   3.5123532502716637`*^9, 3.512353284722406*^9}, {3.512353369908868*^9, 
   3.5123533784254847`*^9}, {3.5123534122009687`*^9, 
   3.5123534432903223`*^9}, {3.5123557768439913`*^9, 3.512355866261181*^9}, {
   3.512761250748369*^9, 3.512761258843855*^9}, {3.5127680658554688`*^9, 
   3.512768070057308*^9}, {3.512768248823433*^9, 3.512768252580122*^9}, {
   3.51276829937626*^9, 3.5127683530882053`*^9}, {3.5127686629539824`*^9, 
   3.512768672407872*^9}, {3.512920714797585*^9, 3.5129207441776*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"THIS", " ", "BLOCK", " ", "DEFINES", " ", "THE", " ", "AMH"}], 
    "-", 
    RowBox[{"GO", " ", "POTENTIAL"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"LOAD", " ", "NATIVE", " ", 
    RowBox[{"DISTANCES", ":", " ", 
     RowBox[{
      RowBox[{
      "THE", " ", "INPUT", " ", "FILE", " ", "CAN", " ", "BE", " ", 
       "GENERATED", " ", "USING", " ", 
       RowBox[{"GetAMHGoDistances", ".", "py"}], " ", "with", " ", "the"}], 
      " ", "-", 
      RowBox[{"s", " ", "option"}]}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
  
  RowBox[{
   RowBox[{
    RowBox[{"rnativeijk", "=", 
     RowBox[{"Import", "[", 
      RowBox[{"\"\<nativedistances_A.data\>\"", ",", "\"\<Table\>\""}], 
      "]"}]}], ";"}], " ", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"rnative", "[", 
      RowBox[{"i_", ",", "j_", ",", "k_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"rnativeijk", "[", 
       RowBox[{"[", "i", "]"}], "]"}], "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"4", 
         RowBox[{"(", 
          RowBox[{"j", "-", "1"}], ")"}]}], "+", "k"}], "]"}], "]"}]}], ";"}],
    "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"minSep", "=", "3"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"kamhgo", "=", "1.0"}], ";"}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{"DEFINE", " ", "PARAMETERS"}], " ", "*)"}], "\n", 
   RowBox[{
    RowBox[{"pamhgo", "=", "3"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"nativedistancecutoff", "=", "8.0"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"amhgogamma", "[", 
     RowBox[{"i_", ",", "j_"}], "]"}], ":=", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Abs", "[", 
        RowBox[{"i", "-", "j"}], "]"}], "<", "3"}], ",", "0.0", ",", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Abs", "[", 
          RowBox[{"i", "-", "j"}], "]"}], "<", "5"}], ",", "0.125", ",", 
        "0.5"}], "]"}]}], "]"}]}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "MAKE", " ", "SURE", " ", "THAT", " ", "THIS", " ", "IS", " ", "WHAT", 
      " ", "YOU", " ", "ARE", " ", "USING", " ", "IN", " ", "amh"}], "-", 
     RowBox[{"go", ".", "gamma"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"amhgosigma", "[", 
     RowBox[{"i_", ",", "j_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"Abs", "[", 
      RowBox[{"i", "-", "j"}], "]"}], "^", 
     RowBox[{"(", "0.15", ")"}]}]}], " ", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"rcacaamhgo", "[", 
     RowBox[{"i_", ",", "j_"}], "]"}], ":=", 
    RowBox[{"MyNorm", "[", 
     RowBox[{
      SubscriptBox["r", 
       RowBox[{"Ca", ",", "i"}]], "-", 
      SubscriptBox["r", 
       RowBox[{"Ca", ",", "j"}]]}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"rcacbamhgo", "[", 
     RowBox[{"i_", ",", "j_"}], "]"}], ":=", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"se", "[", 
        RowBox[{"[", "j", "]"}], "]"}], "\[Equal]", "8"}], ",", "\[Infinity]",
       ",", 
      RowBox[{"MyNorm", "[", 
       RowBox[{
        SubscriptBox["r", 
         RowBox[{"Ca", ",", "i"}]], "-", 
        SubscriptBox["r", 
         RowBox[{"Cb", ",", "j"}]]}], "]"}]}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"rcbcaamhgo", "[", 
     RowBox[{"i_", ",", "j_"}], "]"}], ":=", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"se", "[", 
        RowBox[{"[", "i", "]"}], "]"}], "\[Equal]", "8"}], ",", "\[Infinity]",
       ",", 
      RowBox[{"MyNorm", "[", 
       RowBox[{
        SubscriptBox["r", 
         RowBox[{"Cb", ",", "i"}]], "-", 
        SubscriptBox["r", 
         RowBox[{"Ca", ",", "j"}]]}], "]"}]}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"rcbcbamhgo", "[", 
     RowBox[{"i_", ",", "j_"}], "]"}], ":=", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"se", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "\[Equal]", "8"}], " ", "||", " ", 
       RowBox[{
        RowBox[{"se", "[", 
         RowBox[{"[", "j", "]"}], "]"}], "\[Equal]", "8"}]}], ",", 
      "\[Infinity]", ",", 
      RowBox[{"MyNorm", "[", 
       RowBox[{
        SubscriptBox["r", 
         RowBox[{"Cb", ",", "i"}]], "-", 
        SubscriptBox["r", 
         RowBox[{"Cb", ",", "j"}]]}], "]"}]}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ramhgoijk", "[", 
      RowBox[{"i_", ",", "j_", ",", "k_"}], "]"}], ":=", 
     RowBox[{"Switch", "[", 
      RowBox[{"k", ",", "1", ",", 
       RowBox[{"rcacaamhgo", "[", 
        RowBox[{"i", ",", "j"}], "]"}], ",", "2", ",", 
       RowBox[{"rcacbamhgo", "[", 
        RowBox[{"i", ",", "j"}], "]"}], ",", "3", ",", 
       RowBox[{"rcbcaamhgo", "[", 
        RowBox[{"i", ",", "j"}], "]"}], ",", "4", ",", 
       RowBox[{"rcbcbamhgo", "[", 
        RowBox[{"i", ",", "j"}], "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"dr", "[", 
      RowBox[{"i_", ",", "j_", ",", "k_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"ramhgoijk", "[", 
       RowBox[{"i", ",", "j", ",", "k"}], "]"}], "-", 
      RowBox[{"rnative", "[", 
       RowBox[{"i", ",", "j", ",", "k"}], "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Vamhgoijk", "[", 
     RowBox[{"i_", ",", "j_", ",", "k_"}], "]"}], ":=", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"dr", "[", 
          RowBox[{"i", ",", "j", ",", "k"}], "]"}], "^", "2"}], ">", 
        RowBox[{"27.6", "*", 
         RowBox[{
          RowBox[{"amhgosigma", "[", 
           RowBox[{"i", ",", "j"}], "]"}], "^", "2"}]}]}], " ", "||", " ", 
       RowBox[{
        RowBox[{"rnative", "[", 
         RowBox[{"i", ",", "j", ",", "k"}], "]"}], ">", 
        "nativedistancecutoff"}], " ", "||", " ", 
       RowBox[{
        RowBox[{"Abs", "[", 
         RowBox[{"i", "-", "j"}], "]"}], "<", "minSep"}]}], ",", "0.0", ",", 
      RowBox[{
       RowBox[{"-", "kamhgo"}], "*", 
       RowBox[{"amhgogamma", "[", 
        RowBox[{"i", ",", "j"}], "]"}], "*", 
       RowBox[{"Exp", "[", 
        RowBox[{
         RowBox[{"-", 
          RowBox[{
           RowBox[{"dr", "[", 
            RowBox[{"i", ",", "j", ",", "k"}], "]"}], "^", "2"}]}], "/", 
         RowBox[{"(", 
          RowBox[{"2", "*", 
           RowBox[{
            RowBox[{"amhgosigma", "[", 
             RowBox[{"i", ",", "j"}], "]"}], "^", "2"}]}], ")"}]}], "]"}]}]}],
      "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Vamhgoca", "[", 
     RowBox[{"i_", ",", "j_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"Vamhgoijk", "[", 
      RowBox[{"i", ",", "j", ",", "1"}], "]"}], "+", 
     RowBox[{"Vamhgoijk", "[", 
      RowBox[{"i", ",", "j", ",", "2"}], "]"}]}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Vamhgocb", "[", 
     RowBox[{"i_", ",", "j_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"Vamhgoijk", "[", 
      RowBox[{"i", ",", "j", ",", "3"}], "]"}], "+", 
     RowBox[{"Vamhgoijk", "[", 
      RowBox[{"i", ",", "j", ",", "4"}], "]"}]}]}], "\[IndentingNewLine]", 
   RowBox[{"Vamhgo", ":=", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "0.5"}], "*", 
      RowBox[{
       UnderoverscriptBox["\[Sum]", 
        RowBox[{"i", "=", "1"}], "M"], 
       RowBox[{
        RowBox[{"Abs", "[", 
         RowBox[{
          UnderoverscriptBox["\[Sum]", 
           RowBox[{"j", "=", "1"}], "M"], 
          RowBox[{"Vamhgoca", "[", 
           RowBox[{"i", ",", "j"}], "]"}]}], "]"}], "^", "pamhgo"}]}]}], "-", 
     
     RowBox[{"0.5", "*", 
      RowBox[{
       UnderoverscriptBox["\[Sum]", 
        RowBox[{"i", "=", "1"}], "M"], 
       RowBox[{
        RowBox[{"Abs", "[", 
         RowBox[{
          UnderoverscriptBox["\[Sum]", 
           RowBox[{"j", "=", "1"}], "M"], 
          RowBox[{"Vamhgocb", "[", 
           RowBox[{"i", ",", "j"}], "]"}]}], "]"}], "^", "pamhgo"}]}]}]}]}], 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.5127834280716753`*^9, 3.512783449970538*^9}, 
   3.512783483981803*^9, {3.5127835638653097`*^9, 3.512783621757844*^9}, {
   3.512783767315929*^9, 3.512783781624098*^9}, {3.512784423143238*^9, 
   3.512784429741341*^9}, {3.5127845477953053`*^9, 3.512784557778577*^9}, {
   3.5127845889754763`*^9, 3.512784644748103*^9}, {3.512784716966358*^9, 
   3.512784735295278*^9}, 3.5127848166684847`*^9, {3.512784939533637*^9, 
   3.512784954766465*^9}, {3.5127851055654793`*^9, 3.512785139033927*^9}, {
   3.512785696217544*^9, 3.512785717042426*^9}, {3.512785979885357*^9, 
   3.5127859938340273`*^9}, {3.5127860859413147`*^9, 3.51278611882526*^9}, {
   3.512786243845785*^9, 3.512786244616432*^9}, {3.512786287779727*^9, 
   3.512786288290999*^9}, 3.5127863354357758`*^9, 3.5127865542540083`*^9, {
   3.512786615463518*^9, 3.512786622357679*^9}, {3.512786668919016*^9, 
   3.512786727482285*^9}, {3.512786806754056*^9, 3.5127868322051373`*^9}, {
   3.512786922044744*^9, 3.5127869507059927`*^9}, 3.5127871856592493`*^9, {
   3.5127874542790947`*^9, 3.512787457618371*^9}, {3.512788337520791*^9, 
   3.512788466286641*^9}, {3.512788527843295*^9, 3.512788529846381*^9}, {
   3.5127885625281363`*^9, 3.5127886133285913`*^9}, {3.512788659048429*^9, 
   3.512788688306876*^9}, {3.5127887193849373`*^9, 3.512788720111474*^9}, {
   3.512788774925132*^9, 3.51278881118931*^9}, {3.512788860195463*^9, 
   3.512788907908037*^9}, {3.512912309860483*^9, 3.512912322603016*^9}, {
   3.512916609660343*^9, 3.512916638123743*^9}, {3.5129166737850018`*^9, 
   3.5129168265317097`*^9}, {3.512917036624991*^9, 3.512917087550788*^9}, {
   3.512920753884132*^9, 3.5129208245159063`*^9}, {3.512920886677244*^9, 
   3.5129208919288673`*^9}, {3.51292093667829*^9, 3.512920972928206*^9}, {
   3.5129210384678593`*^9, 3.512921067652079*^9}, {3.512921106099114*^9, 
   3.512921131913453*^9}, {3.512921672454811*^9, 3.5129216896357107`*^9}, {
   3.512921805896039*^9, 3.512921810655373*^9}, {3.512921885244454*^9, 
   3.5129218883037024`*^9}, {3.512921967930595*^9, 3.5129219693583*^9}, {
   3.512922021425391*^9, 3.5129220258098373`*^9}, {3.5129249603275557`*^9, 
   3.5129250802669897`*^9}, {3.512925297128887*^9, 3.512925316550137*^9}, {
   3.512925351063332*^9, 3.5129254357839603`*^9}, {3.512925523940778*^9, 
   3.512925545987041*^9}, {3.51292586598794*^9, 3.51292586929941*^9}, {
   3.512925913786984*^9, 3.5129259438550587`*^9}, {3.512925996279181*^9, 
   3.512926005443447*^9}, {3.512926082504704*^9, 3.512926118021494*^9}, {
   3.512926171438538*^9, 3.51292619728224*^9}, {3.512926322026973*^9, 
   3.512926324838036*^9}, {3.512926748155814*^9, 3.5129267590553493`*^9}, {
   3.512927976768454*^9, 3.5129279862213593`*^9}, {3.51292804971054*^9, 
   3.5129280790349092`*^9}, {3.512933188512272*^9, 3.512933207204545*^9}, {
   3.512933354060191*^9, 3.5129333542209787`*^9}, {3.512933580257387*^9, 
   3.512933581257339*^9}, {3.512936033756816*^9, 3.51293635695278*^9}, {
   3.512936395866111*^9, 3.512936561448762*^9}, {3.5129371447324266`*^9, 
   3.512937157941387*^9}, {3.512937267301261*^9, 3.51293735594*^9}, {
   3.512937573343522*^9, 3.512937585762814*^9}, {3.51293762337728*^9, 
   3.5129376236305017`*^9}, {3.5129376552452583`*^9, 3.512937659648745*^9}, 
   3.5129390038645*^9, {3.5129390505539083`*^9, 3.5129390555708723`*^9}, {
   3.512939086492906*^9, 3.512939109746567*^9}, {3.512939185615861*^9, 
   3.512939257694776*^9}, {3.512939371706649*^9, 3.5129394037335*^9}, {
   3.512939456674449*^9, 3.512939459542713*^9}, {3.5129395075411463`*^9, 
   3.512939519661355*^9}, {3.5129395516655283`*^9, 3.512939650000963*^9}, {
   3.512939858730277*^9, 3.512939859108571*^9}, {3.51294022364287*^9, 
   3.512940298727282*^9}, {3.512940478887858*^9, 3.512940480007552*^9}, {
   3.512941060675259*^9, 3.512941085332076*^9}, {3.512941408197279*^9, 
   3.512941453065196*^9}, {3.512941556566399*^9, 3.5129415573415422`*^9}, {
   3.5129418489579277`*^9, 3.512941849129842*^9}, {3.512941899902018*^9, 
   3.512941900073368*^9}, {3.512942288621201*^9, 3.512942304840971*^9}, {
   3.5129476543837976`*^9, 3.512947654601367*^9}, {3.512947936754839*^9, 
   3.512947936982238*^9}, {3.512948170379945*^9, 3.5129481705988503`*^9}, {
   3.513019146719233*^9, 3.513019146914679*^9}, {3.513023247746817*^9, 
   3.51302327578684*^9}, {3.513369031169059*^9, 3.513369039680031*^9}, {
   3.5135317913876677`*^9, 3.513531791514947*^9}, {3.513531849691679*^9, 
   3.513531849769435*^9}, {3.51353228138027*^9, 3.513532321571122*^9}, {
   3.51353301723657*^9, 3.513533066440051*^9}, {3.513540649669231*^9, 
   3.513540683623698*^9}, {3.513541298200078*^9, 3.513541300009598*^9}, {
   3.513541345132114*^9, 3.513541388812215*^9}, {3.513541510031004*^9, 
   3.513541511888959*^9}, {3.5135417244388323`*^9, 3.513541727688305*^9}, {
   3.5135420631551867`*^9, 3.513542161996929*^9}, {3.513542253721485*^9, 
   3.5135423421737633`*^9}, {3.513542406833084*^9, 3.513542426161009*^9}, {
   3.51354246689123*^9, 3.513542468131795*^9}, {3.5135429073287563`*^9, 
   3.513542912477518*^9}, {3.513543175234632*^9, 3.5135431753174067`*^9}, {
   3.513545422669837*^9, 3.5135454421307383`*^9}, {3.51354549756924*^9, 
   3.513545497719509*^9}, 3.513709721210884*^9, {3.513709812239777*^9, 
   3.513709827647686*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "THIS", " ", "BLOCK", " ", "INITIALIZES", " ", "THE", " ", "VARIABLE", " ",
     "VTotal", " ", "WHICH", " ", "IS", " ", "USED", " ", "IN", " ", "THE", 
    " ", "SUBSEQUENT", " ", "BLOCK", " ", "THAT", " ", "EVALUATES", " ", 
    "THE", " ", "FORCES"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"VTotal", " ", "=", 
    RowBox[{"2", " ", "Vamhgo"}]}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "THIS", " ", "ASSIGNMENT", " ", "CARRIES", " ", "WITH", " ", "IT", " ", 
     "ALL", " ", "THE", " ", "DETAILS", " ", "OF", " ", "THE", " ", 
     "FUNCTION"}], ",", " ", 
    RowBox[{
     RowBox[{"I", ".", "E", ".", " ", "IT"}], " ", "IS", " ", "NOT", " ", 
     "JUST", " ", "ASSIGNING", " ", "A", " ", "NUMBER", " ", "TO", " ", 
     RowBox[{"VTotal", ".", " ", "IN"}], " ", "THIS", " ", "WAY"}], ",", " ", 
    
    RowBox[{
    "IT", " ", "CAN", " ", "BE", " ", "USED", " ", "BELOW", " ", "AS", " ", 
     "INPUT", " ", "FOR", " ", "CALCULATING", " ", "THE", " ", "FORCES", " ", 
     "AND", " ", "THAT", " ", "BLOCK", " ", 
     RowBox[{"DOESN", "'"}], "T", " ", "HAVE", " ", "TO", " ", "BE", " ", 
     "CHANGED", " ", "WHEN", " ", "CHANGING", " ", "THE", " ", "POTENTIAL", 
     " ", "THAT", " ", "YOU", " ", "ARE", " ", "TESTING"}]}], " ", "*)"}], 
  " "}]], "Input",
 CellChangeTimes->{{3.4706685671253777`*^9, 3.470668568923956*^9}, 
   3.470669140687944*^9, {3.472568135764303*^9, 3.472568136077662*^9}, {
   3.49153042070728*^9, 3.49153043000228*^9}, 3.5062799804243402`*^9, {
   3.5117206113578653`*^9, 3.5117206143005743`*^9}, {3.511720931183508*^9, 
   3.511720945895186*^9}, {3.511721091663517*^9, 3.511721093624007*^9}, 
   3.511730339573325*^9, 3.5118034247967377`*^9, {3.5123310006221437`*^9, 
   3.512331009104251*^9}, {3.512331066833764*^9, 3.51233109174583*^9}, {
   3.5123336302879763`*^9, 3.512333743640379*^9}, {3.5123432922590218`*^9, 
   3.512343294794918*^9}, {3.512345020526559*^9, 3.512345042630878*^9}, {
   3.5129251139698277`*^9, 3.512925116279237*^9}, {3.51354544579733*^9, 
   3.513545470430064*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"THIS", " ", "BLOCK", " ", "USES", " ", 
    RowBox[{"MATHEMATICA", "'"}], "S", " ", "CAPABILITIES", " ", "TO", " ", 
    "ANALYTICALLY", " ", "DIFFERENTIATE", " ", "THE", " ", "POTENTIAL", " ", 
    "FUNCTION", " ", "TO", " ", "GIVE", " ", "FORCES"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"ProgressIndicator", "[", 
    RowBox[{
     RowBox[{"Dynamic", "[", "ipr", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "M"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
   RowBox[{"FCA", "=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"V0", ",", "V"}], "}"}], ",", 
      RowBox[{
       RowBox[{"ipr", "=", "0"}], ";", 
       RowBox[{"V0", "=", 
        RowBox[{
         RowBox[{"VTotal", "/.", 
          RowBox[{"Ruless", "[", "2", "]"}]}], "/.", 
         RowBox[{"Ruless", "[", "3", "]"}]}]}], ";", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"ipr", "=", "i"}], ";", 
          RowBox[{"V", "=", 
           RowBox[{"V0", "/.", 
            RowBox[{"Rules", "[", 
             RowBox[{"1", ",", "i"}], "]"}]}]}], ";", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"D", "[", 
               RowBox[{"V", ",", " ", 
                SubscriptBox["x", 
                 RowBox[{"Ca", ",", "i"}]]}], "]"}], "/.", 
              RowBox[{"Rulee", "[", 
               RowBox[{"1", ",", "i"}], "]"}]}], ")"}], ",", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"D", "[", 
               RowBox[{"V", ",", " ", 
                SubscriptBox["y", 
                 RowBox[{"Ca", ",", "i"}]]}], "]"}], "/.", 
              RowBox[{"Rulee", "[", 
               RowBox[{"1", ",", "i"}], "]"}]}], ")"}], ",", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"D", "[", 
               RowBox[{"V", ",", " ", 
                SubscriptBox["z", 
                 RowBox[{"Ca", ",", "i"}]]}], "]"}], "/.", 
              RowBox[{"Rulee", "[", 
               RowBox[{"1", ",", "i"}], "]"}]}], ")"}]}], "}"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "M"}], "}"}]}], "]"}]}]}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"FCB", "=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"V0", ",", "V"}], "}"}], ",", 
      RowBox[{
       RowBox[{"ipr", "=", "0"}], ";", 
       RowBox[{"V0", "=", 
        RowBox[{
         RowBox[{"VTotal", "/.", 
          RowBox[{"Ruless", "[", "1", "]"}]}], "/.", 
         RowBox[{"Ruless", "[", "3", "]"}]}]}], ";", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"ipr", "=", "i"}], ";", 
          RowBox[{"V", "=", 
           RowBox[{"V0", "/.", 
            RowBox[{"Rules", "[", 
             RowBox[{"2", ",", "i"}], "]"}]}]}], ";", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"D", "[", 
               RowBox[{"V", ",", " ", 
                SubscriptBox["x", 
                 RowBox[{"Cb", ",", "i"}]]}], "]"}], "/.", 
              RowBox[{"Rulee", "[", 
               RowBox[{"2", ",", "i"}], "]"}]}], ")"}], ",", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"D", "[", 
               RowBox[{"V", ",", " ", 
                SubscriptBox["y", 
                 RowBox[{"Cb", ",", "i"}]]}], "]"}], "/.", 
              RowBox[{"Rulee", "[", 
               RowBox[{"2", ",", "i"}], "]"}]}], ")"}], ",", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"D", "[", 
               RowBox[{"V", ",", " ", 
                SubscriptBox["z", 
                 RowBox[{"Cb", ",", "i"}]]}], "]"}], "/.", 
              RowBox[{"Rulee", "[", 
               RowBox[{"2", ",", "i"}], "]"}]}], ")"}]}], "}"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "M"}], "}"}]}], "]"}]}]}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"FO", "=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"V0", ",", "V"}], "}"}], ",", 
      RowBox[{
       RowBox[{"ipr", "=", "0"}], ";", 
       RowBox[{"V0", "=", 
        RowBox[{
         RowBox[{"VTotal", "/.", 
          RowBox[{"Ruless", "[", "1", "]"}]}], "/.", 
         RowBox[{"Ruless", "[", "2", "]"}]}]}], ";", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"ipr", "=", "i"}], ";", 
          RowBox[{"V", "=", 
           RowBox[{"V0", "/.", 
            RowBox[{"Rules", "[", 
             RowBox[{"3", ",", "i"}], "]"}]}]}], ";", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"D", "[", 
               RowBox[{"V", ",", " ", 
                SubscriptBox["x", 
                 RowBox[{"O", ",", "i"}]]}], "]"}], "/.", 
              RowBox[{"Rulee", "[", 
               RowBox[{"3", ",", "i"}], "]"}]}], ")"}], ",", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"D", "[", 
               RowBox[{"V", ",", " ", 
                SubscriptBox["y", 
                 RowBox[{"O", ",", "i"}]]}], "]"}], "/.", 
              RowBox[{"Rulee", "[", 
               RowBox[{"3", ",", "i"}], "]"}]}], ")"}], ",", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"D", "[", 
               RowBox[{"V", ",", " ", 
                SubscriptBox["z", 
                 RowBox[{"O", ",", "i"}]]}], "]"}], "/.", 
              RowBox[{"Rulee", "[", 
               RowBox[{"3", ",", "i"}], "]"}]}], ")"}]}], "}"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "M"}], "}"}]}], "]"}]}]}], 
     "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.471701217544476*^9, 3.471701246546933*^9}, {
   3.472406747727654*^9, 3.47240675002771*^9}, {3.472574328849304*^9, 
   3.472574329475623*^9}, 3.4725743767652073`*^9, {3.472574432137315*^9, 
   3.472574434319613*^9}, {3.472574739790389*^9, 3.472574750794717*^9}, {
   3.472574799687457*^9, 3.472574800128894*^9}, {3.47257485955485*^9, 
   3.4725748713780193`*^9}, {3.512331096871563*^9, 3.51233115208499*^9}, {
   3.512349578871891*^9, 3.512349580132258*^9}, {3.512353658151764*^9, 
   3.512353659727635*^9}}],

Cell[BoxData[
 ProgressIndicatorBox[Dynamic[$CellContext`ipr], {0, 26}]], "Output",
 CellChangeTimes->{3.512926645175634*^9, 3.512927400451806*^9, 
  3.5130191786048603`*^9, 3.513542825623665*^9, 3.5135454491013002`*^9, 
  3.513709776317152*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.`", ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.`", ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.`", ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.`", ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.`", ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.`", ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.`", ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.`", ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.`", ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.`", ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.`", ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.`", ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.`", ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.`", ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.`", ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.`", ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.`", ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.`", ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.`", ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.`", ",", "0.`"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.512926645175634*^9, 3.512927400451806*^9, 
  3.5130191786048603`*^9, 3.513542825623665*^9, 3.5135454491013002`*^9, 
  3.513709777700067*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.`", ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.`", ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.`", ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.`", ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.`", ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.`", ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.`", ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.`", ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.`", ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.`", ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.`", ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.`", ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.`", ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.`", ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.`", ",", "0.`"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.512926645175634*^9, 3.512927400451806*^9, 
  3.5130191786048603`*^9, 3.513542825623665*^9, 3.5135454491013002`*^9, 
  3.5137097789249287`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.`", ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.`", ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.`", ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.`", ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.`", ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.`", ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.`", ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.`", ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.`", ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.`", ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.`", ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.`", ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.`", ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.`", ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.`", ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.`", ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.`", ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.`", ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.`", ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.`", ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.`", ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.`", ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.`", ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.`", ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.`", ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.`", ",", "0.`"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.512926645175634*^9, 3.512927400451806*^9, 
  3.5130191786048603`*^9, 3.513542825623665*^9, 3.5135454491013002`*^9, 
  3.513709779777793*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "THIS", " ", "CALCULATES", " ", "FORCES", " ", "FROM", " ", "POTENTIALS", 
     " ", "USING", " ", "A", " ", "NUMERICAL", " ", "DIFFERENTIATION", " ", 
     "SCHEME"}], " ", "-", " ", 
    RowBox[{
    "IT", " ", "IS", " ", "NOT", " ", "THE", " ", "RECOMMENDED", " ", 
     "METHOD"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"h", "=", "0.0001"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"rdh", "[", 
     RowBox[{"r_", ",", "h_", ",", "i_", ",", "j_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "rr", "}"}], ",", 
      RowBox[{
       RowBox[{"rr", "=", "r"}], ";", 
       RowBox[{
        RowBox[{"rr", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "j"}], "]"}], "]"}], "+=", "h"}], ";", 
       RowBox[{"Return", "[", "rr", "]"}]}]}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"i", "=", "5"}], ";", 
    RowBox[{"j", "=", "2"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Vwaterhij", "[", 
     RowBox[{"h_", ",", "ii_", ",", "jj_", ",", "kk_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"rcah", "=", "rca"}], ",", 
        RowBox[{"rcbh", "=", "rcb"}], ",", 
        RowBox[{"roh", "=", "ro"}], ",", "ruleh"}], "}"}], ",", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"kk", "\[Equal]", "1"}], ",", 
         RowBox[{"rcah", "=", 
          RowBox[{"rdh", "[", 
           RowBox[{"rca", ",", "h", ",", "ii", ",", "jj"}], "]"}]}], ",", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"kk", "\[Equal]", "2"}], ",", 
           RowBox[{"rcbh", "=", 
            RowBox[{"rdh", "[", 
             RowBox[{"rcb", ",", "h", ",", "ii", ",", "jj"}], "]"}]}], ",", 
           RowBox[{"roh", "=", 
            RowBox[{"rdh", "[", 
             RowBox[{"ro", ",", "h", ",", "ii", ",", "jj"}], "]"}]}]}], 
          "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"ruleh", "=", 
        RowBox[{"Flatten", "[", 
         RowBox[{"Append", "[", 
          RowBox[{
           RowBox[{"Append", "[", 
            RowBox[{
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  SubscriptBox["r", 
                   RowBox[{"Ca", ",", "i"}]], "[", 
                  RowBox[{"[", "j", "]"}], "]"}], "\[Rule]", 
                 RowBox[{"rcah", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", ",", "j"}], "]"}], "]"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", "1", ",", "M"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"j", ",", "1", ",", "3"}], "}"}]}], "]"}], ",", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  SubscriptBox["r", 
                   RowBox[{"Cb", ",", "i"}]], "[", 
                  RowBox[{"[", "j", "]"}], "]"}], "\[Rule]", 
                 RowBox[{"rcbh", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", ",", "j"}], "]"}], "]"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", "1", ",", "M"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"j", ",", "1", ",", "3"}], "}"}]}], "]"}]}], "]"}], 
           ",", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                SubscriptBox["r", 
                 RowBox[{"O", ",", "i"}]], "[", 
                RowBox[{"[", "j", "]"}], "]"}], "\[Rule]", 
               RowBox[{"roh", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "j"}], "]"}], "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", "M"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"j", ",", "1", ",", "3"}], "}"}]}], "]"}]}], "]"}], 
         "]"}]}], ";", 
       RowBox[{"Return", "[", 
        RowBox[{"Vwater", "/.", "ruleh"}], "]"}]}]}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"ProgressIndicator", "[", 
    RowBox[{
     RowBox[{"Dynamic", "[", "kt", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "3"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
   RowBox[{"ProgressIndicator", "[", 
    RowBox[{
     RowBox[{"Dynamic", "[", "it", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "M"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
   RowBox[{"ProgressIndicator", "[", 
    RowBox[{
     RowBox[{"Dynamic", "[", "jt", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "3"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
   RowBox[{"FF", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"0.5", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Vwaterhij", "[", 
           RowBox[{"h", ",", "it", ",", "jt", ",", "kt"}], "]"}], "-", 
          RowBox[{"Vwaterhij", "[", 
           RowBox[{
            RowBox[{"-", "h"}], ",", "it", ",", "jt", ",", "kt"}], "]"}]}], 
         ")"}], "/", "h"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"kt", ",", "1", ",", "3"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"it", ",", "1", ",", "M"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"jt", ",", "1", ",", "3"}], "}"}]}], "]"}]}], 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.5062785899733057`*^9, 3.506278831999267*^9}, {
  3.5062788718752813`*^9, 3.506279041983946*^9}, {3.5062791047284107`*^9, 
  3.5062793944440813`*^9}, {3.50627942466101*^9, 3.50627947534096*^9}, {
  3.50627950604035*^9, 3.5062795625999727`*^9}, {3.5062796037022867`*^9, 
  3.506279793908305*^9}, {3.50627982401138*^9, 3.5062799104062243`*^9}, {
  3.506280017732071*^9, 3.5062800212929363`*^9}, {3.5062800998437862`*^9, 
  3.506280271146153*^9}, {3.506282150400591*^9, 3.5062821577074633`*^9}, {
  3.506343452089678*^9, 3.506343459765299*^9}, {3.512323114881507*^9, 
  3.512323142960685*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "TEST", " ", "IF", " ", "FORCES", " ", "CALCULATED", " ", "BY", " ", 
    "MATHEMATICA", " ", "AGREE", " ", "WITH", " ", "FORCES", " ", "INPUT", 
    " ", "FROM", " ", "LAMMPS"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Max", "[", 
    RowBox[{"Abs", "[", 
     RowBox[{"Flatten", "[", 
      RowBox[{"FCA", "+", "fca"}], "]"}], "]"}], "]"}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "THE", " ", "REASON", " ", "WHY", " ", "IT", " ", "IS", " ", "PLUS", " ",
       "INSTEAD", " ", "OF", " ", "MINUS", " ", "IS", " ", "BECAUSE", " ", 
      "WHAT", " ", "MATHEMATICA", " ", "CALCULATES", " ", "IS", " ", 
      "ACTUALLY"}], "..."}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"Max", "[", 
    RowBox[{"Abs", "[", 
     RowBox[{"Flatten", "[", 
      RowBox[{"FCB", "+", "fcb"}], "]"}], "]"}], "]"}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"dV", "/", "dX"}], " ", "AND", " ", "THE", " ", "FORCE", " ", 
      "IS", " ", "ACTUALLY", " ", "F"}], "=", 
     RowBox[{
      RowBox[{"-", "dV"}], "/", "dX"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   
   RowBox[{"Max", "[", 
    RowBox[{"Abs", "[", 
     RowBox[{"Flatten", "[", 
      RowBox[{"FO", "+", "fo"}], "]"}], "]"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.5117206881029053`*^9, 3.5117206995741243`*^9}, {
  3.512316013182979*^9, 3.512316014174736*^9}, {3.512331686034169*^9, 
  3.512331742949005*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "THIS", " ", "IS", " ", "AN", " ", "EXAMPLE", " ", "OF", " ", "HOW", " ", 
    "TO", " ", "GET", " ", "THE", " ", "NUMERICAL", " ", "TOTAL", " ", "FOR", 
    " ", "A", " ", "PARTICULAR", " ", "POTENTIAL"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"2", " ", "*", "Vamhgo"}], "/.", "rule"}], "/.", "rule", " ", 
   RowBox[{"(*", " ", 
    RowBox[{
    "THE", " ", "2", " ", "HERE", " ", "IS", " ", "SET", " ", "TO", " ", 
     "MATCH", " ", "THE", " ", "\"\<[EPSILON]\>\"", " ", "VALUE", " ", "IN", 
     " ", "LAMMPS"}], " ", "*)"}]}]}]], "Input",
 CellChangeTimes->{{3.5123160223112993`*^9, 3.512316072711299*^9}, {
  3.512333763072858*^9, 3.512333784509334*^9}, {3.5123434025408363`*^9, 
  3.5123434035251617`*^9}, {3.5123449229128637`*^9, 3.5123449278072243`*^9}, {
  3.512351074117487*^9, 3.5123510741929903`*^9}, {3.512351327148741*^9, 
  3.512351328312166*^9}, {3.5123513596639147`*^9, 3.512351361284752*^9}, {
  3.512351488344685*^9, 3.5123514919008904`*^9}, {3.512354590125286*^9, 
  3.512354590480981*^9}, {3.512761564094194*^9, 3.512761564951641*^9}, {
  3.512925129763092*^9, 3.5129251309705553`*^9}}],

Cell[BoxData[
 RowBox[{"-", "1017.492187499942`"}]], "Output",
 CellChangeTimes->{
  3.512925131398477*^9, 3.512926207466957*^9, 3.512926336451729*^9, {
   3.512926653911696*^9, 3.512926664559507*^9}, 3.512926766282247*^9, 
   3.51292763648991*^9, 3.512927991363587*^9, {3.5129329276701508`*^9, 
   3.512932949339422*^9}, 3.5129330050909777`*^9, {3.512933194232483*^9, 
   3.512933218672188*^9}, 3.512933372836646*^9, 3.51293908115009*^9, 
   3.512939803532214*^9, 3.5129398642066393`*^9, 3.5129402836570873`*^9, 
   3.512940485740037*^9, {3.512941068543447*^9, 3.512941092716151*^9}, 
   3.512941563236416*^9, 3.512941872775342*^9, 3.512941904739791*^9, 
   3.512942293286613*^9, 3.512947455326808*^9, {3.512947640156352*^9, 
   3.5129476591929502`*^9}, 3.51294794064501*^9, 3.512948038942526*^9, 
   3.512948175687625*^9, 3.513019082340271*^9, 3.5130191513790483`*^9, 
   3.513023283438846*^9, 3.5133689932212753`*^9, 3.51353167358022*^9, 
   3.513531798010551*^9, 3.5135318552837133`*^9, {3.513532294545507*^9, 
   3.513532327680807*^9}, 3.513540692024377*^9, 3.513541306593033*^9, 
   3.513541363949274*^9, 3.513541407469784*^9, 3.513541518825338*^9, 
   3.513541733755251*^9, 3.513542474546967*^9, 3.513543181129487*^9, 
   3.513709784448352*^9, 3.513709816842909*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "SHOW", " ", "DIFFERENCES", " ", "IN", " ", "CALCULATED", " ", "VERSUS", 
    " ", "LAMMPS", " ", "FORCES"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"FCA", "+", "fca"}], "\[IndentingNewLine]", 
   RowBox[{"FCB", "+", "fcb"}], "\[IndentingNewLine]", 
   RowBox[{"FO", "+", "fo"}]}]}]], "Input",
 CellChangeTimes->{{3.512759229606512*^9, 3.512759267400701*^9}}]
},
WindowSize->{1920, 1003},
WindowMargins->{{0, Automatic}, {0, 0}},
FrontEndVersion->"8.0 for Linux x86 (64-bit) (November 7, 2010)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[545, 20, 3805, 83, 534, "Text"],
Cell[4353, 105, 19866, 507, 1152, "Input"],
Cell[24222, 614, 12730, 326, 601, "Input"],
Cell[36955, 942, 12679, 324, 601, "Input"],
Cell[49637, 1268, 720, 16, 50, "Input"],
Cell[50360, 1286, 2191, 62, 19, "Input",
 CellOpen->False],
Cell[CellGroupData[{
Cell[52576, 1352, 1981, 40, 88, "Input"],
Cell[54560, 1394, 3836, 97, 145, "Output"],
Cell[58399, 1493, 3396, 86, 126, "Output"],
Cell[61798, 1581, 2069, 55, 69, "Output"]
}, Open  ]],
Cell[63882, 1639, 13786, 321, 772, "Input"],
Cell[77671, 1962, 11869, 350, 424, "Input"],
Cell[89543, 2314, 37178, 984, 19, "Input",
 CellOpen->False],
Cell[126724, 3300, 7579, 216, 19, "Input",
 CellOpen->False],
Cell[134306, 3518, 14550, 406, 19, "Input",
 CellOpen->False],
Cell[148859, 3926, 20869, 567, 19, "Input",
 CellOpen->False],
Cell[169731, 4495, 11073, 313, 19, "Input",
 CellOpen->False],
Cell[180807, 4810, 10836, 265, 586, "Input"],
Cell[191646, 5077, 13374, 309, 483, "Input"],
Cell[205023, 5388, 2133, 40, 107, "Input"],
Cell[CellGroupData[{
Cell[207181, 5432, 6331, 168, 164, "Input"],
Cell[213515, 5602, 245, 4, 33, "Output"],
Cell[213763, 5608, 2129, 57, 69, "Output"],
Cell[215895, 5667, 2101, 57, 69, "Output"],
Cell[217999, 5726, 2165, 57, 69, "Output"]
}, Open  ]],
Cell[220179, 5786, 6142, 156, 259, "Input"],
Cell[226324, 5944, 1497, 37, 88, "Input"],
Cell[CellGroupData[{
Cell[227846, 5985, 1207, 23, 50, "Input"],
Cell[229056, 6010, 1273, 19, 30, "Output"]
}, Open  ]],
Cell[230344, 6032, 440, 10, 88, "Input"]
}
]
*)

(* End of internal cache information *)
